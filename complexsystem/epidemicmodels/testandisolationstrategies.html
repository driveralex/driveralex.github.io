<!DOCTYPE html><html lang="en"><head><link rel="preconnect" href="https://fonts.gstatic.com/" crossorigin=""><link rel="preload" as="style" onload='this.rel="stylesheet"' href="https://fonts.googleapis.com/css2?family=Source Sans Pro&amp;family=Rubik&amp;family=B612 Mono&amp;display=swap"><meta name="viewport" content="width=device-width,initial-scale=1"><link rel="icon" href="/favicon.svg" type="image/svg+xml"><link rel="apple-touch-icon" href="/pwa-192x192.png"><link rel="mask-icon" href="/safari-pinned-tab.svg" color="#00aba9"><link rel="preload" href="/fonts/KaTeX_Main-Regular.woff2" as="style" onload='this.rel="stylesheet"'><link rel="preload" href="/fonts/KaTeX_Math-Italic.woff2" as="style" onload='this.rel="stylesheet"'><style>body{counter-reset:katexEqnNo mmlEqnNo}.container[data-v-2c572964]{width:100%}.mainSection[data-v-2c572964]{display:flex;flex-direction:row;justify-content:space-between;align-items:center;width:100%;color:#fff;font-weight:600;cursor:pointer;text-align:start;z-index:10}.mainSection .mainText[data-v-2c572964]{margin:1rem;cursor:pointer}.mainSection .mainArrow[data-v-2c572964]{margin:1rem}.mainSection .closesub[data-v-2c572964]{transform:rotate(0);transition:transform ease-in-out .3s}.mainSection[data-v-2c572964]:hover{background-color:#303233}html:not(.dark) .mainSection[data-v-2c572964]{color:#000}html:not(.dark) .mainSection[data-v-2c572964]:hover{background-color:#bbc3c9}.normal[data-v-2c572964]{border-left:#242526 .25rem solid}.normal[data-v-2c572964]:hover{border-left:#303233 .25rem solid}html:not(.dark) .normal[data-v-2c572964]{border-left:#adb6be .25rem solid}html:not(.dark) .normal[data-v-2c572964]:hover{border-left:#bbc3c9 .25rem solid}.lasum[data-v-2c572964]{flex-direction:column;color:#fff;margin-left:1rem;flex-wrap:wrap;text-align:start;padding:.8rem}.lasum[data-v-2c572964]:hover{background-color:#303233}html:not(.dark) .lasum[data-v-2c572964]{color:#000}html:not(.dark) .lasum[data-v-2c572964]:hover{background-color:#bbc3c9}.closesubs[data-v-2c572964]{display:none}.normalSub[data-v-2c572964]{color:#d3d3d3}html:not(.dark) .normalSub[data-v-2c572964]{color:#353b3d}.normalSubs[data-v-2c572964]{border-left:solid 1px #fff}html:not(.dark) .normalSubs[data-v-2c572964]{border-left:solid #353b3d 1px}[data-simplebar]{position:relative;flex-direction:column;flex-wrap:wrap;justify-content:flex-start;align-content:flex-start;align-items:flex-start}.navcontainer[data-v-e90f6d58]{display:flex;flex-direction:column;width:100%;background:#242526;align-items:center}html:not(.dark) .navcontainer[data-v-e90f6d58]{background:#adb6be}.tree[data-v-e90f6d58]{display:flex;flex-direction:column;width:100%;overflow-y:auto;overflow-x:hidden}.footnav[data-v-e90f6d58]{display:flex;flex-direction:row;justify-content:center;align-items:center;padding:1rem;color:#fff;border-top:1px solid #808486}html:not(.dark) .footnav[data-v-e90f6d58]{color:#000;border-top:1px solid #5a5c5e}.icon-footer[data-v-e90f6d58]{padding:0 .3rem;height:auto;width:auto}.headnav[data-v-e90f6d58]{display:flex;flex-direction:row;align-items:center;margin:1rem;width:100%;justify-content:space-around;font-weight:900;font-size:1.3rem}.headnav .mainIcon[data-v-e90f6d58]{height:auto;width:auto;color:#039be5}.allContent[data-v-36b54919]{max-width:80%}@media (max-width:1024px){.allContent[data-v-36b54919]{max-width:100%}}@keyframes translateOut-36b54919{90%{display:none}to{transform:translate(-100%);opacity:0}}.navhidden[data-v-36b54919]{display:none}@media (max-width:1024px){.navhidden[data-v-36b54919]{display:flex;max-width:80vw;position:absolute;top:50px;opacity:1;z-index:1;animation:translateOut-36b54919 .5s ease-in-out forwards}}main[data-v-36b54919]{display:flex;flex-direction:column;height:max-content}.mynavTree[data-v-36b54919]{align-self:stretch;max-height:100vh;max-width:20%;font-family:Rubik}@media (max-width:1024px){.mynavTree[data-v-36b54919]{display:none}}.routeVue[data-v-36b54919]{display:flex;height:100vh;overflow-y:auto;padding:2rem 3rem;width:130vw;font-family:Source Sans Pro}@media (max-width:1024px){.routeVue[data-v-36b54919]{padding:.4rem .6rem}}.topPage[data-v-36b54919]{display:flex;flex-direction:row;height:max-content;justify-content:center;align-items:stretch;box-sizing:border-box}@media (max-width:1024px){.topPage[data-v-36b54919]{flex-direction:column;max-height:100vh}}.headerfull[data-v-36b54919]{background:#242526;display:none}@media (max-width:1024px){.headerfull[data-v-36b54919]{display:flex;flex-direction:row;padding:1rem;align-items:center;justify-content:flex-start}}.headerfull .mainIcon[data-v-36b54919]{margin-left:2rem;height:auto;width:auto;color:#039be5}.headerfull h1[data-v-36b54919]{margin-left:2rem;font-weight:700;font-size:1.3rem}.headerfull span[data-v-36b54919]{display:flex;align-items:center;justify-content:center}.themeToggle[data-v-36b54919]{display:block;position:absolute;top:0;right:0;margin:1rem;z-index:10}*,:after,:before{-webkit-box-sizing:border-box;box-sizing:border-box;border-width:0;border-style:solid;border-color:#e5e7eb}*{--tw-ring-inset:var(--tw-empty, );--tw-ring-offset-width:0px;--tw-ring-offset-color:#fff;--tw-ring-color:rgba(59, 130, 246, .5);--tw-ring-offset-shadow:0 0 #0000;--tw-ring-shadow:0 0 #0000;--tw-shadow:0 0 #0000}:root{-moz-tab-size:4;-o-tab-size:4;tab-size:4}a{color:inherit;text-decoration:inherit}body{margin:0;font-family:inherit;line-height:inherit}button{font-family:inherit;font-size:100%;line-height:1.15;margin:0;text-transform:none;background-color:transparent;background-image:none;padding:0;line-height:inherit;color:inherit}button{-webkit-appearance:button}button{cursor:pointer}html{-webkit-text-size-adjust:100%;font-family:ui-sans-serif,system-ui,-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,Noto Sans,sans-serif,"Apple Color Emoji","Segoe UI Emoji",Segoe UI Symbol,"Noto Color Emoji";line-height:1.5}h1,h3,p{margin:0}h1,h3{font-size:inherit;font-weight:inherit}.prose{color:inherit;max-width:65ch;font-size:1rem;line-height:1.75}.prose strong{color:inherit;font-weight:600}.prose h1{color:inherit;font-weight:800;font-size:2.25em;margin-top:0;margin-bottom:.8888889em;line-height:1.1111111}.prose h3{color:inherit;font-weight:600;font-size:1.25em;margin-top:1.6em;margin-bottom:.6em;line-height:1.6}.prose code{color:inherit;font-weight:600;font-size:.875em}.prose code:before{content:"`"}.prose code:after{content:"`"}.prose pre{color:#e5e7eb;background-color:#1f2937;overflow-x:auto;font-size:.875em;line-height:1.7142857;margin-top:1.7142857em;margin-bottom:1.7142857em;border-radius:.375rem;padding:.8571429em 1.1428571em}.prose pre code{background-color:transparent;border-width:0;border-radius:0;padding:0;font-weight:400;color:inherit;font-size:inherit;font-family:inherit;line-height:inherit}.prose pre code:before{content:none}.prose pre code:after{content:none}.prose p{margin-top:1.25em;margin-bottom:1.25em}.prose img{margin-top:2em;margin-bottom:2em}.prose h3+*{margin-top:0}.prose>:first-child{margin-top:0}.prose>:last-child{margin-bottom:0}.prose-sm{font-size:.875rem;line-height:1.7142857}.prose-sm p{margin-top:1.1428571em;margin-bottom:1.1428571em}.prose-sm h1{font-size:2.1428571em;margin-top:0;margin-bottom:.8em;line-height:1.2}.prose-sm h3{font-size:1.2857143em;margin-top:1.5555556em;margin-bottom:.4444444em;line-height:1.5555556}.prose-sm img{margin-top:1.7142857em;margin-bottom:1.7142857em}.prose-sm code{font-size:.8571429em}.prose-sm pre{font-size:.8571429em;line-height:1.6666667;margin-top:1.6666667em;margin-bottom:1.6666667em;border-radius:.25rem;padding:.6666667em 1em}.prose-sm h3+*{margin-top:0}.prose-sm>:first-child{margin-top:0}.prose-sm>:last-child{margin-bottom:0}:root{--prism-scheme:light;--prism-foreground:#6e6e6e;--prism-background:#f4f4f4;--prism-comment:#a8a8a8;--prism-string:#555555;--prism-literal:#333333;--prism-keyword:#000000;--prism-function:#4f4f4f;--prism-deleted:#333333;--prism-class:#333333;--prism-builtin:#757575;--prism-property:#333333;--prism-namespace:#4f4f4f;--prism-punctuation:#ababab;--prism-decorator:var(--prism-class);--prism-operator:var(--prism-punctuation);--prism-number:var(--prism-literal);--prism-boolean:var(--prism-literal);--prism-variable:var(--prism-literal);--prism-constant:var(--prism-literal);--prism-symbol:var(--prism-literal);--prism-interpolation:var(--prism-literal);--prism-selector:var(--prism-keyword);--prism-keyword-control:var(--prism-keyword);--prism-regex:var(--prism-string);--prism-json-property:var(--prism-property);--prism-inline-background:var(--prism-background);--prism-comment-style:italic;--prism-url-decoration:underline;--prism-line-number:#a5a5a5;--prism-line-number-gutter:#333333;--prism-line-highlight-background:#eeeeee;--prism-selection-background:#aaaaaa;--prism-marker-color:var(--prism-foreground);--prism-marker-opacity:.4;--prism-marker-font-size:.8em;--prism-font-size:1em;--prism-line-height:1.5em;--prism-font-family:monospace;--prism-inline-font-size:var(--prism-font-size);--prism-block-font-size:var(--prism-font-size);--prism-tab-size:2;--prism-block-padding-x:1em;--prism-block-padding-y:1em;--prism-block-margin-x:0;--prism-block-margin-y:.5em;--prism-block-radius:.3em;--prism-inline-padding-x:.3em;--prism-inline-padding-y:.1em;--prism-inline-radius:.3em}code[class*=language-],pre[class*=language-]{font-size:var(--prism-font-size);font-family:var(--prism-font-family);direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:var(--prism-line-height);-moz-tab-size:var(--prism-tab-size);-o-tab-size:var(--prism-tab-size);tab-size:var(--prism-tab-size);-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;color:var(--prism-foreground)!important}pre[class*=language-]{font-size:var(--prism-block-font-size);padding:var(--prism-block-padding-y) var(--prism-block-padding-x);margin:var(--prism-block-margin-y) var(--prism-block-margin-x);border-radius:var(--prism-block-radius);overflow:auto;background:var(--prism-background)}code[class*=language-] ::-moz-selection,code[class*=language-] ::selection,code[class*=language-]::-moz-selection,code[class*=language-]::selection,pre[class*=language-] ::-moz-selection,pre[class*=language-] ::selection,pre[class*=language-]::-moz-selection,pre[class*=language-]::selection{background:var(--prism-selection-background)}.token.comment{color:var(--prism-comment);font-style:var(--prism-comment-style);color:#6272a4}.token.string{color:var(--prism-string)}.token.punctuation{color:var(--prism-punctuation);color:#f8f8f2}.token.operator{color:var(--prism-operator)}.token.boolean{color:var(--prism-boolean)}.token.number{color:var(--prism-number)}.token.keyword{color:var(--prism-keyword);color:#8be9fd}.prose{--prism-font-family:"Input Mono",monospace;max-width:100%}.prose img{width:100%}html:not(.dark) .prose{--prism-foreground:#fbfbfb;--prism-background:#fbfbfb;--prism-comment:#f0ada0;--prism-string:#b56959;--prism-literal:#2f8a89;--prism-number:#296aa3;--prism-keyword:#1c6b48;--prism-function:#6c7834;--prism-boolean:#1c6b48;--prism-constant:#a65e2b;--prism-deleted:#a14f55;--prism-class:#2993a3;--prism-builtin:#ab5959;--prism-property:#b58451;--prism-namespace:#b05a78;--prism-punctuation:#8e8f8b;--prism-decorator:#bd8f8f;--prism-regex:#ab5e3f;--prism-json-property:#698c96}pre[class*=language-]>code{position:relative;display:block}code[class*=language-],pre[class*=language-]{color:#f8f8f2;background:0 0;text-shadow:0 1px rgba(0,0,0,.3);font-family:Consolas,Monaco,Andale Mono,Ubuntu Mono,monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none}pre[class*=language-]{padding:1em;margin:.5em 0;overflow:auto;border-radius:.3em}pre[class*=language-]{background:#282a36}.token.boolean,.token.number{color:#bd93f9}.token.string{color:#50fa7b}.token.operator{color:#f8f8f2}#app,body,html{height:100%;margin:0;padding:0}.btn:disabled{--tw-bg-opacity:1;background-color:rgba(75,85,99,var(--tw-bg-opacity));cursor:default;opacity:.5}.btn{border-radius:.25rem;display:inline-block;padding:.25rem 1rem}img{padding:0 1rem}.container{width:100%}@media (min-width:640px){.container{max-width:640px}}@media (min-width:768px){.container{max-width:768px}}@media (min-width:1024px){.container{max-width:1024px}}@media (min-width:1280px){.container{max-width:1280px}}@media (min-width:1536px){.container{max-width:1536px}}.m-auto{margin:auto}.mx-auto{margin-left:auto;margin-right:auto}.text-left{text-align:left}.text-center{text-align:center}.text-gray-700{--tw-text-opacity:1;color:rgba(55,65,81,var(--tw-text-opacity))}.align-middle{vertical-align:middle}.nextButton[data-v-5e18b108]{display:flex;background:#202020;flex-direction:row;justify-content:space-between;width:100%;border-radius:.4rem;align-items:center;cursor:pointer;padding-top:1em;padding-bottom:1em;border:solid 2px #202020;font-weight:400;min-width:300px;transition:all ease-in-out .25s}.nextButton.true[data-v-5e18b108]{margin-left:.5em}@media (max-width:1024px){.nextButton.true[data-v-5e18b108]{margin:.4rem 0;text-align:left}}.nextButton h3[data-v-5e18b108]{color:#fff;font-weight:600;transition:color ease-in-out .25s}.nextButton .arrow[data-v-5e18b108]{color:#fff;transition:all ease-in-out .25s}.nextButton[data-v-5e18b108]:hover{border:solid 2px #039be5;font:#039be5;transition:all ease-in-out .25s}.nextButton:hover h3[data-v-5e18b108]{color:#039be5;transition:color ease-in-out .25s}.nextButton:hover .arrow[data-v-5e18b108]{color:#039be5;transition:all ease-in-out .25s}html:not(.dark) .nextButton[data-v-5e18b108]{background:#bec7cf;box-shadow:0 10px 20px #0000001a;border:solid 2px #bec7cf}html:not(.dark) .nextButton h3[data-v-5e18b108]{color:#000}html:not(.dark) .nextButton .arrow[data-v-5e18b108]{color:#000}html:not(.dark) .nextButton[data-v-5e18b108]:hover{border:solid 2px #039be5;font:#039be5}html:not(.dark) .nextButton:hover h3[data-v-5e18b108]{color:#039be5}html:not(.dark) .nextButton:hover .arrow[data-v-5e18b108]{color:#039be5}label[data-v-5e18b108]{cursor:pointer;color:#bbc2ca;font-size:.8em}html:not(.dark) label[data-v-5e18b108]{color:#484b4e}.nextText[data-v-5e18b108]{display:flex;flex-direction:column;align-items:flex-start}.prevText[data-v-5e18b108]{display:flex;flex-direction:column;align-items:flex-end}.prevButton[data-v-5e18b108]{display:flex;cursor:pointer;flex-direction:row;background:#202020;justify-content:space-between;width:100%;border-radius:.3rem;align-items:center;padding-top:1em;padding-bottom:1em;border:solid 2px #202020;transition:all ease-in-out .25s}.prevButton.true[data-v-5e18b108]{margin-right:.5em}@media (max-width:1024px){.prevButton.true[data-v-5e18b108]{margin:.4rem 0;text-align:right}}.prevButton h3[data-v-5e18b108]{color:#fff;font-weight:600;transition:color ease-in-out .25s}.prevButton .arrow[data-v-5e18b108]{color:#fff;transition:all ease-in-out .25s}.prevButton[data-v-5e18b108]:hover{border:solid 2px #039be5;font:#039be5;transition:all ease-in-out .25s}.prevButton:hover .arrow[data-v-5e18b108],.prevButton:hover h3[data-v-5e18b108]{color:#039be5;transition:all ease-in-out .25s}html:not(.dark) .prevButton[data-v-5e18b108]{background:#bec7cf;box-shadow:0 10px 20px #0000001a;border:solid 2px #bec7cf}html:not(.dark) .prevButton h3[data-v-5e18b108]{color:#000}html:not(.dark) .prevButton .arrow[data-v-5e18b108]{color:#000}html:not(.dark) .prevButton[data-v-5e18b108]:hover{border:solid 2px #039be5;font:#039be5}html:not(.dark) .prevButton:hover h3[data-v-5e18b108]{color:#039be5}html:not(.dark) .prevButton:hover .arrow[data-v-5e18b108]{color:#039be5}.buttonsSection[data-v-7aa07aa5]{display:flex;flex-direction:row-reverse;text-align:center;justify-content:center;padding-top:1rem;padding-bottom:1rem;width:100%;align-items:center}@media (max-width:1024px){.buttonsSection[data-v-7aa07aa5]{flex-direction:column-reverse;padding-top:.2rem;padding-bottom:.2rem}}</style><link rel="preload" href="/katex.min.css" as="style"><script src="/markdown-it.min.js"></script><!-- Global site tag (gtag.js) - Google Analytics --><script async="" src="https://www.googletagmanager.com/gtag/js?id=G-V1N5Q8L1GV"></script><script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-V1N5Q8L1GV")</script><!-- https://cdn.jsdelivr.net/npm/markdown-it-texmath/texmath.min.js  --><meta name="msapplication-TileColor" content="#00aba9"><meta name="theme-color" content="#ffffff"><script>!function(){var e=window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches,t=localStorage.getItem("vueuse-color-scheme")||"auto";("dark"===t||e&&"light"!==t)&&document.documentElement.classList.toggle("dark",!0)}()</script><script type="module" async="" crossorigin="" src="/assets/app.2b61ab5a.js"></script><link rel="modulepreload" href="/assets/vendor.81acebaf.js"><link rel="preload" href="/assets/app.c3121e54.css" as="style"><link rel="manifest" href="/manifest.webmanifest"><link rel="modulepreload" crossorigin="" href="/assets/index.4573e573.js"><link rel="modulepreload" crossorigin="" href="/assets/ButtonSection.35b389eb.js"><link rel="preload" href="/assets/ButtonSection.5de0d717.css" as="style"><title>Driveralex</title><meta name="description" content="Just driveralex website"><meta name="head:count" content="1"><link rel="preload" as="font" crossorigin="anonymous" href="fonts/KaTeX_AMS-Regular.woff2"><link rel="preload" as="font" crossorigin="anonymous" href="fonts/KaTeX_Caligraphic-Bold.woff2"><link rel="preload" as="font" crossorigin="anonymous" href="fonts/KaTeX_Caligraphic-Regular.woff2"><link rel="preload" as="font" crossorigin="anonymous" href="fonts/KaTeX_Fraktur-Bold.woff2"><link rel="preload" as="font" crossorigin="anonymous" href="fonts/KaTeX_Fraktur-Regular.woff2"><link rel="preload" as="font" crossorigin="anonymous" href="fonts/KaTeX_Main-Bold.woff2"><link rel="preload" as="font" crossorigin="anonymous" href="fonts/KaTeX_Main-BoldItalic.woff2"><link rel="preload" as="font" crossorigin="anonymous" href="fonts/KaTeX_Main-Italic.woff2"><link rel="preload" as="font" crossorigin="anonymous" href="fonts/KaTeX_Main-Regular.woff2"><link rel="preload" as="font" crossorigin="anonymous" href="fonts/KaTeX_Math-BoldItalic.woff2"><link rel="preload" as="font" crossorigin="anonymous" href="fonts/KaTeX_Math-Italic.woff2"><link rel="preload" as="font" crossorigin="anonymous" href="fonts/KaTeX_SansSerif-Bold.woff2"><link rel="preload" as="font" crossorigin="anonymous" href="fonts/KaTeX_SansSerif-Italic.woff2"><link rel="preload" as="font" crossorigin="anonymous" href="fonts/KaTeX_SansSerif-Regular.woff2"><link rel="preload" as="font" crossorigin="anonymous" href="fonts/KaTeX_Script-Regular.woff2"><link rel="preload" as="font" crossorigin="anonymous" href="fonts/KaTeX_Size1-Regular.woff2"><link rel="preload" as="font" crossorigin="anonymous" href="fonts/KaTeX_Size2-Regular.woff2"><link rel="preload" as="font" crossorigin="anonymous" href="fonts/KaTeX_Size3-Regular.woff2"><link rel="preload" as="font" crossorigin="anonymous" href="fonts/KaTeX_Size4-Regular.woff2"><link rel="preload" as="font" crossorigin="anonymous" href="fonts/KaTeX_Typewriter-Regular.woff2"></head><body><div id="app" data-server-rendered="true"><main class="text-gray-700 dark:text-gray-200" data-v-36b54919=""><div class="topPage" data-v-36b54919=""><button class="themeToggle" data-v-36b54919=""><svg width="1.2em" height="1.2em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32" style="display:none" class="align-middle"><path d="M13.502 5.414a15.075 15.075 0 0 0 11.594 18.194a11.113 11.113 0 0 1-7.975 3.39c-.138 0-.278.005-.418 0a11.094 11.094 0 0 1-3.2-21.584M14.98 3a1.002 1.002 0 0 0-.175.016a13.096 13.096 0 0 0 1.825 25.981c.164.006.328 0 .49 0a13.072 13.072 0 0 0 10.703-5.555a1.01 1.01 0 0 0-.783-1.565A13.08 13.08 0 0 1 15.89 4.38A1.015 1.015 0 0 0 14.98 3z" fill="currentColor"></path></svg><svg width="1.2em" height="1.2em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32" style="" class="align-middle"><path d="M16 12.005a4 4 0 1 1-4 4a4.005 4.005 0 0 1 4-4m0-2a6 6 0 1 0 6 6a6 6 0 0 0-6-6z" fill="currentColor"></path><path d="M5.394 6.813l1.414-1.415l3.506 3.506L8.9 10.318z" fill="currentColor"></path><path d="M2 15.005h5v2H2z" fill="currentColor"></path><path d="M5.394 25.197L8.9 21.691l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 25.005h2v5h-2z" fill="currentColor"></path><path d="M21.687 23.106l1.414-1.415l3.506 3.506l-1.414 1.414z" fill="currentColor"></path><path d="M25 15.005h5v2h-5z" fill="currentColor"></path><path d="M21.687 8.904l3.506-3.506l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 2.005h2v5h-2z" fill="currentColor"></path></svg></button><div class="navcontainer mynavTree" data-v-36b54919="" data-v-e90f6d58=""><div class="headnav" data-v-e90f6d58=""><svg width="1.2em" height="1.2em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32" class="mainIcon" data-v-e90f6d58=""><circle cx="21" cy="26" r="2" fill="currentColor"></circle><circle cx="21" cy="6" r="2" fill="currentColor"></circle><circle cx="4" cy="16" r="2" fill="currentColor"></circle><path d="M28 12a3.996 3.996 0 0 0-3.858 3h-4.284a3.966 3.966 0 0 0-5.491-2.643l-3.177-3.97A3.963 3.963 0 0 0 12 6a4 4 0 1 0-4 4a3.96 3.96 0 0 0 1.634-.357l3.176 3.97a3.924 3.924 0 0 0 0 4.774l-3.176 3.97A3.96 3.96 0 0 0 8 22a4 4 0 1 0 4 4a3.962 3.962 0 0 0-.81-2.387l3.176-3.97A3.966 3.966 0 0 0 19.858 17h4.284A3.993 3.993 0 1 0 28 12zM6 6a2 2 0 1 1 2 2a2.002 2.002 0 0 1-2-2zm2 22a2 2 0 1 1 2-2a2.002 2.002 0 0 1-2 2zm8-10a2 2 0 1 1 2-2a2.002 2.002 0 0 1-2 2zm12 0a2 2 0 1 1 2-2a2.002 2.002 0 0 1-2 2z" fill="currentColor"></path></svg><p data-v-e90f6d58="">Complex systems</p><svg width="1.2em" height="1.2em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32" style="display:none" data-v-e90f6d58=""><path d="M29 27.586l-7.552-7.552a11.018 11.018 0 1 0-1.414 1.414L27.586 29zM4 13a9 9 0 1 1 9 9a9.01 9.01 0 0 1-9-9z" fill="currentColor"></path></svg></div><div data-simplebar="" data-simplebar-auto-hide="false" class="tree" data-v-e90f6d58=""><div class="container" data-v-e90f6d58="" data-v-2c572964=""><div class="normal mainSection" data-v-2c572964=""><p class="mainText" data-v-2c572964="">Introduction</p><!----></div><!--[--><!--]--></div><div class="container" data-v-e90f6d58="" data-v-2c572964=""><div class="normal mainSection" data-v-2c572964=""><p class="mainText" data-v-2c572964="">Getting Started</p><svg width="1.2em" height="1.2em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 24 24" class="mainArrow closesub" data-v-2c572964=""><g fill="none"><path d="M8 4l8 8l-8 8" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path></g></svg></div><!--[--><div class="normalSubs closesubs lasum" data-v-2c572964=""><a href="/complexSystem/getting-started/representations-of-graph-and-first-metrics" class="asub normalSub" data-v-2c572964="">Representations of graph and first metrics</a></div><div class="normalSubs closesubs lasum" data-v-2c572964=""><a href="/complexSystem/getting-started/breadth-first-search-algorithm-and-applications" class="asub normalSub" data-v-2c572964="">Breadth-first search algorithm and applications</a></div><div class="normalSubs closesubs lasum" data-v-2c572964=""><a href="/complexSystem/getting-started/igraph-package" class="asub normalSub" data-v-2c572964="">Igraph package</a></div><!--]--></div><div class="container" data-v-e90f6d58="" data-v-2c572964=""><div class="normal mainSection" data-v-2c572964=""><p class="mainText" data-v-2c572964="">Random graph models</p><svg width="1.2em" height="1.2em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 24 24" class="mainArrow closesub" data-v-2c572964=""><g fill="none"><path d="M8 4l8 8l-8 8" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path></g></svg></div><!--[--><div class="normalSubs closesubs lasum" data-v-2c572964=""><a href="/complexSystem/random-graph-models/erdos-renyi-model" class="asub normalSub" data-v-2c572964="">Erdos-Renyi model</a></div><div class="normalSubs closesubs lasum" data-v-2c572964=""><a href="/complexSystem/random-graph-models/watts-strogatz-model-small-world-network" class="asub normalSub" data-v-2c572964="">Watts-Strogatz model : Small world network</a></div><div class="normalSubs closesubs lasum" data-v-2c572964=""><a href="/complexSystem/random-graph-models/graph-scale-free" class="asub normalSub" data-v-2c572964="">Graph scale free</a></div><div class="normalSubs closesubs lasum" data-v-2c572964=""><a href="/complexSystem/random-graph-models/histograms-of-the-degree-distribution" class="asub normalSub" data-v-2c572964="">Histograms of the degree distribution</a></div><div class="normalSubs closesubs lasum" data-v-2c572964=""><a href="/complexSystem/random-graph-models/scale-free-power-law-degree-distribution" class="asub normalSub" data-v-2c572964="">Scale free, power law degree distribution</a></div><div class="normalSubs closesubs lasum" data-v-2c572964=""><a href="/complexSystem/random-graph-models/erdos-renyi-average-length-as-function-of-p" class="asub normalSub" data-v-2c572964="">Erdos-Renyi, average length as function of p</a></div><div class="normalSubs closesubs lasum" data-v-2c572964=""><a href="/complexSystem/random-graph-models/erdos-renyi-clustering-coefficient-as-functions-of-p" class="asub normalSub" data-v-2c572964="">Erdos-Renyi, clustering coefficient as functions of p</a></div><!--]--></div><div class="container" data-v-e90f6d58="" data-v-2c572964=""><div class="normal mainSection" data-v-2c572964=""><p class="mainText" data-v-2c572964="">Voter model</p><svg width="1.2em" height="1.2em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 24 24" class="mainArrow closesub" data-v-2c572964=""><g fill="none"><path d="M8 4l8 8l-8 8" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path></g></svg></div><!--[--><div class="normalSubs closesubs lasum" data-v-2c572964=""><a href="/complexSystem/voterModel/Representation" class="asub normalSub" data-v-2c572964="">Representation</a></div><div class="normalSubs closesubs lasum" data-v-2c572964=""><a href="/complexSystem/voterModel/influenceingScenarios" class="asub normalSub" data-v-2c572964="">Influenceing scenarios</a></div><!--]--></div><div class="container" data-v-e90f6d58="" data-v-2c572964=""><div class="normal mainSection" data-v-2c572964=""><p class="mainText" data-v-2c572964="">Epidemic models</p><svg width="1.2em" height="1.2em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 24 24" class="mainArrow closesub" data-v-2c572964=""><g fill="none"><path d="M8 4l8 8l-8 8" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path></g></svg></div><!--[--><div class="normalSubs closesubs lasum" data-v-2c572964=""><a href="/complexSystem/epidemicModels/implementation" class="asub normalSub" data-v-2c572964="">Implementation</a></div><div class="normalSubs closesubs lasum" data-v-2c572964=""><a href="/complexSystem/epidemicModels/effectOfConfinePeople" class="asub normalSub" data-v-2c572964="">Effect of confine people</a></div><div class="normalSubs closesubs lasum" data-v-2c572964=""><a aria-current="page" href="/complexSystem/epidemicModels/testAndIsolationStrategies" class="router-link-active router-link-exact-active asub normalSub" data-v-2c572964="">Test and isolation strategies</a></div><!--]--></div></div><div class="footnav" data-v-e90f6d58=""><p data-v-e90f6d58="">Crafted with</p><svg width="1.2em" height="1.2em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 256 221" class="icon-footer" data-v-e90f6d58=""><path d="M204.8 0H256L128 220.8L0 0h97.92L128 51.2L157.44 0h47.36z" fill="#41B883"></path><path d="M0 0l128 220.8L256 0h-51.2L128 132.48L50.56 0H0z" fill="#41B883"></path><path d="M50.56 0L128 133.12L204.8 0h-47.36L128 51.2L97.92 0H50.56z" fill="#35495E"></path></svg><p data-v-e90f6d58="">and</p><svg width="1.2em" height="1.2em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 128 128" class="icon-footer" data-v-e90f6d58=""><path d="M93.99 8.97c-21.91 0-29.96 22.39-29.96 22.39s-7.94-22.39-30-22.39c-16.58 0-35.48 13.14-28.5 43.01c6.98 29.87 58.56 67.08 58.56 67.08s51.39-37.21 58.38-67.08c6.98-29.87-10.56-43.01-28.48-43.01z" fill="#f44336"></path><g fill="#c33"><path d="M30.65 11.2c17.2 0 25.74 18.49 28.5 25.98c.39 1.07 1.88 1.1 2.33.06L64 31.35C60.45 20.01 50.69 8.97 34.03 8.97c-6.9 0-14.19 2.28-19.86 7.09c5.01-3.29 10.88-4.86 16.48-4.86z"></path><path d="M93.99 8.97c-5.29 0-10.11 1.15-13.87 3.47c2.64-1.02 5.91-1.24 9.15-1.24c16.21 0 30.72 12.29 24.17 40.7c-5.62 24.39-38.46 53.98-48.49 65.27c-.64.72-.86 1.88-.86 1.88s51.39-37.21 58.38-67.08c6.98-29.86-10.53-43-28.48-43z"></path></g><path d="M17.04 24.82c3.75-4.68 10.45-8.55 16.13-4.09c3.07 2.41 1.73 7.35-1.02 9.43c-4 3.04-7.48 4.87-9.92 9.63c-1.46 2.86-2.34 5.99-2.79 9.18c-.18 1.26-1.83 1.57-2.45.46c-4.22-7.48-5.42-17.78.05-24.61z" fill="#ff8a80"></path><path d="M77.16 34.66c-1.76 0-3-1.7-2.36-3.34c1.19-3.02 2.73-5.94 4.58-8.54c2.74-3.84 7.95-6.08 11.25-3.75c3.38 2.38 2.94 7.14.57 9.44c-5.09 4.93-11.51 6.19-14.04 6.19z" fill="#ff8a80"></path></svg></div></div><div class="headerfull" data-v-36b54919=""><span data-v-36b54919=""><svg width="1.2em" height="1.2em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 15 15" data-v-36b54919=""><g fill="none"><path fill-rule="evenodd" clip-rule="evenodd" d="M1.5 3a.5.5 0 0 0 0 1h12a.5.5 0 0 0 0-1h-12zM1 7.5a.5.5 0 0 1 .5-.5h12a.5.5 0 0 1 0 1h-12a.5.5 0 0 1-.5-.5zm0 4a.5.5 0 0 1 .5-.5h12a.5.5 0 0 1 0 1h-12a.5.5 0 0 1-.5-.5z" fill="currentColor"></path></g></svg></span><svg width="1.2em" height="1.2em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32" class="mainIcon" data-v-36b54919=""><circle cx="21" cy="26" r="2" fill="currentColor"></circle><circle cx="21" cy="6" r="2" fill="currentColor"></circle><circle cx="4" cy="16" r="2" fill="currentColor"></circle><path d="M28 12a3.996 3.996 0 0 0-3.858 3h-4.284a3.966 3.966 0 0 0-5.491-2.643l-3.177-3.97A3.963 3.963 0 0 0 12 6a4 4 0 1 0-4 4a3.96 3.96 0 0 0 1.634-.357l3.176 3.97a3.924 3.924 0 0 0 0 4.774l-3.176 3.97A3.96 3.96 0 0 0 8 22a4 4 0 1 0 4 4a3.962 3.962 0 0 0-.81-2.387l3.176-3.97A3.966 3.966 0 0 0 19.858 17h4.284A3.993 3.993 0 1 0 28 12zM6 6a2 2 0 1 1 2 2a2.002 2.002 0 0 1-2-2zm2 22a2 2 0 1 1 2-2a2.002 2.002 0 0 1-2 2zm8-10a2 2 0 1 1 2-2a2.002 2.002 0 0 1-2 2zm12 0a2 2 0 1 1 2-2a2.002 2.002 0 0 1-2 2z" fill="currentColor"></path></svg><h1 data-v-36b54919="">Complex systems</h1><svg width="1.2em" height="1.2em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32" style="display:none" data-v-36b54919=""><path d="M29 27.586l-7.552-7.552a11.018 11.018 0 1 0-1.414 1.414L27.586 29zM4 13a9 9 0 1 1 9 9a9.01 9.01 0 0 1-9-9z" fill="currentColor"></path></svg></div><div class="navcontainer navhidden" data-v-36b54919="" data-v-e90f6d58=""><!----><div data-simplebar="" data-simplebar-auto-hide="false" class="tree" data-v-e90f6d58=""><div class="container" data-v-e90f6d58="" data-v-2c572964=""><div class="normal mainSection" data-v-2c572964=""><p class="mainText" data-v-2c572964="">Introduction</p><!----></div><!--[--><!--]--></div><div class="container" data-v-e90f6d58="" data-v-2c572964=""><div class="normal mainSection" data-v-2c572964=""><p class="mainText" data-v-2c572964="">Getting Started</p><svg width="1.2em" height="1.2em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 24 24" class="mainArrow closesub" data-v-2c572964=""><g fill="none"><path d="M8 4l8 8l-8 8" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path></g></svg></div><!--[--><div class="normalSubs closesubs lasum" data-v-2c572964=""><a href="/complexSystem/getting-started/representations-of-graph-and-first-metrics" class="asub normalSub" data-v-2c572964="">Representations of graph and first metrics</a></div><div class="normalSubs closesubs lasum" data-v-2c572964=""><a href="/complexSystem/getting-started/breadth-first-search-algorithm-and-applications" class="asub normalSub" data-v-2c572964="">Breadth-first search algorithm and applications</a></div><div class="normalSubs closesubs lasum" data-v-2c572964=""><a href="/complexSystem/getting-started/igraph-package" class="asub normalSub" data-v-2c572964="">Igraph package</a></div><!--]--></div><div class="container" data-v-e90f6d58="" data-v-2c572964=""><div class="normal mainSection" data-v-2c572964=""><p class="mainText" data-v-2c572964="">Random graph models</p><svg width="1.2em" height="1.2em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 24 24" class="mainArrow closesub" data-v-2c572964=""><g fill="none"><path d="M8 4l8 8l-8 8" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path></g></svg></div><!--[--><div class="normalSubs closesubs lasum" data-v-2c572964=""><a href="/complexSystem/random-graph-models/erdos-renyi-model" class="asub normalSub" data-v-2c572964="">Erdos-Renyi model</a></div><div class="normalSubs closesubs lasum" data-v-2c572964=""><a href="/complexSystem/random-graph-models/watts-strogatz-model-small-world-network" class="asub normalSub" data-v-2c572964="">Watts-Strogatz model : Small world network</a></div><div class="normalSubs closesubs lasum" data-v-2c572964=""><a href="/complexSystem/random-graph-models/graph-scale-free" class="asub normalSub" data-v-2c572964="">Graph scale free</a></div><div class="normalSubs closesubs lasum" data-v-2c572964=""><a href="/complexSystem/random-graph-models/histograms-of-the-degree-distribution" class="asub normalSub" data-v-2c572964="">Histograms of the degree distribution</a></div><div class="normalSubs closesubs lasum" data-v-2c572964=""><a href="/complexSystem/random-graph-models/scale-free-power-law-degree-distribution" class="asub normalSub" data-v-2c572964="">Scale free, power law degree distribution</a></div><div class="normalSubs closesubs lasum" data-v-2c572964=""><a href="/complexSystem/random-graph-models/erdos-renyi-average-length-as-function-of-p" class="asub normalSub" data-v-2c572964="">Erdos-Renyi, average length as function of p</a></div><div class="normalSubs closesubs lasum" data-v-2c572964=""><a href="/complexSystem/random-graph-models/erdos-renyi-clustering-coefficient-as-functions-of-p" class="asub normalSub" data-v-2c572964="">Erdos-Renyi, clustering coefficient as functions of p</a></div><!--]--></div><div class="container" data-v-e90f6d58="" data-v-2c572964=""><div class="normal mainSection" data-v-2c572964=""><p class="mainText" data-v-2c572964="">Voter model</p><svg width="1.2em" height="1.2em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 24 24" class="mainArrow closesub" data-v-2c572964=""><g fill="none"><path d="M8 4l8 8l-8 8" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path></g></svg></div><!--[--><div class="normalSubs closesubs lasum" data-v-2c572964=""><a href="/complexSystem/voterModel/Representation" class="asub normalSub" data-v-2c572964="">Representation</a></div><div class="normalSubs closesubs lasum" data-v-2c572964=""><a href="/complexSystem/voterModel/influenceingScenarios" class="asub normalSub" data-v-2c572964="">Influenceing scenarios</a></div><!--]--></div><div class="container" data-v-e90f6d58="" data-v-2c572964=""><div class="normal mainSection" data-v-2c572964=""><p class="mainText" data-v-2c572964="">Epidemic models</p><svg width="1.2em" height="1.2em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 24 24" class="mainArrow closesub" data-v-2c572964=""><g fill="none"><path d="M8 4l8 8l-8 8" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path></g></svg></div><!--[--><div class="normalSubs closesubs lasum" data-v-2c572964=""><a href="/complexSystem/epidemicModels/implementation" class="asub normalSub" data-v-2c572964="">Implementation</a></div><div class="normalSubs closesubs lasum" data-v-2c572964=""><a href="/complexSystem/epidemicModels/effectOfConfinePeople" class="asub normalSub" data-v-2c572964="">Effect of confine people</a></div><div class="normalSubs closesubs lasum" data-v-2c572964=""><a aria-current="page" href="/complexSystem/epidemicModels/testAndIsolationStrategies" class="router-link-active router-link-exact-active asub normalSub" data-v-2c572964="">Test and isolation strategies</a></div><!--]--></div></div><div class="footnav" data-v-e90f6d58=""><p data-v-e90f6d58="">Crafted with</p><svg width="1.2em" height="1.2em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 256 221" class="icon-footer" data-v-e90f6d58=""><path d="M204.8 0H256L128 220.8L0 0h97.92L128 51.2L157.44 0h47.36z" fill="#41B883"></path><path d="M0 0l128 220.8L256 0h-51.2L128 132.48L50.56 0H0z" fill="#41B883"></path><path d="M50.56 0L128 133.12L204.8 0h-47.36L128 51.2L97.92 0H50.56z" fill="#35495E"></path></svg><p data-v-e90f6d58="">and</p><svg width="1.2em" height="1.2em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 128 128" class="icon-footer" data-v-e90f6d58=""><path d="M93.99 8.97c-21.91 0-29.96 22.39-29.96 22.39s-7.94-22.39-30-22.39c-16.58 0-35.48 13.14-28.5 43.01c6.98 29.87 58.56 67.08 58.56 67.08s51.39-37.21 58.38-67.08c6.98-29.87-10.56-43.01-28.48-43.01z" fill="#f44336"></path><g fill="#c33"><path d="M30.65 11.2c17.2 0 25.74 18.49 28.5 25.98c.39 1.07 1.88 1.1 2.33.06L64 31.35C60.45 20.01 50.69 8.97 34.03 8.97c-6.9 0-14.19 2.28-19.86 7.09c5.01-3.29 10.88-4.86 16.48-4.86z"></path><path d="M93.99 8.97c-5.29 0-10.11 1.15-13.87 3.47c2.64-1.02 5.91-1.24 9.15-1.24c16.21 0 30.72 12.29 24.17 40.7c-5.62 24.39-38.46 53.98-48.49 65.27c-.64.72-.86 1.88-.86 1.88s51.39-37.21 58.38-67.08c6.98-29.86-10.53-43-28.48-43z"></path></g><path d="M17.04 24.82c3.75-4.68 10.45-8.55 16.13-4.09c3.07 2.41 1.73 7.35-1.02 9.43c-4 3.04-7.48 4.87-9.92 9.63c-1.46 2.86-2.34 5.99-2.79 9.18c-.18 1.26-1.83 1.57-2.45.46c-4.22-7.48-5.42-17.78.05-24.61z" fill="#ff8a80"></path><path d="M77.16 34.66c-1.76 0-3-1.7-2.36-3.34c1.19-3.02 2.73-5.94 4.58-8.54c2.74-3.84 7.95-6.08 11.25-3.75c3.38 2.38 2.94 7.14.57 9.44c-5.09 4.93-11.51 6.19-14.04 6.19z" fill="#ff8a80"></path></svg></div></div><div class="allContent text-center mx-auto routeVue" data-simplebar="" data-v-36b54919=""><div class="prose prose-sm m-auto text-left"><h1>Test and isolation strategies</h1><h3><strong>Scenario A</strong></h3><p>Now we apply the isolation strategies described in scenario</p><p>We use the following code:</p><pre class="language-r"><code class="language-r">library<span class="token punctuation">(</span>igraph<span class="token punctuation">)</span>

Erdos_Renyi_optimized <span class="token operator">&lt;-</span> <span class="token keyword">function</span><span class="token punctuation">(</span>n<span class="token punctuation">,</span>p<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
  nb_tri <span class="token operator">&lt;-</span> n<span class="token operator">*</span><span class="token punctuation">(</span>n<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">2</span>
  mat <span class="token operator">&lt;-</span> diag<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span>nrow <span class="token operator">=</span> n<span class="token punctuation">,</span> ncol <span class="token operator">=</span> n<span class="token punctuation">)</span>
  vect_rand <span class="token operator">&lt;-</span> runif<span class="token punctuation">(</span>nb_tri <span class="token punctuation">,</span> min <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> max <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">-</span> p
  <span class="token keyword">for</span><span class="token punctuation">(</span>i <span class="token keyword">in</span> <span class="token number">1</span><span class="token operator">:</span>nb_tri<span class="token punctuation">)</span>
  <span class="token punctuation">{</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>vect_rand<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">&gt;</span><span class="token number">0</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
      vect_rand<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">&lt;-</span> <span class="token number">0</span> 
    <span class="token punctuation">}</span>
    <span class="token keyword">else</span>
    <span class="token punctuation">{</span>
      vect_rand<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">&lt;-</span> <span class="token number">1</span> 
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
  mat<span class="token punctuation">[</span>lower.tri<span class="token punctuation">(</span>mat<span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token operator">&lt;-</span> vect_rand
  mat <span class="token operator">&lt;-</span> t<span class="token punctuation">(</span>mat<span class="token punctuation">)</span>
  mat<span class="token punctuation">[</span>lower.tri<span class="token punctuation">(</span>mat<span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token operator">&lt;-</span> vect_rand
  igraph <span class="token operator">&lt;-</span> graph_from_adjacency_matrix<span class="token punctuation">(</span>mat<span class="token punctuation">,</span>mode <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token string">"undirected"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
  igraph
<span class="token punctuation">}</span>

plot_epidemic_curves <span class="token operator">&lt;-</span> <span class="token keyword">function</span><span class="token punctuation">(</span>mat_res<span class="token punctuation">,</span>time<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
  <span class="token comment">#print(mat_res)</span>
  plot<span class="token punctuation">(</span> x <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token number">0</span><span class="token operator">:</span>time<span class="token punctuation">)</span><span class="token punctuation">,</span> y <span class="token operator">=</span> mat_res<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token punctuation">]</span><span class="token punctuation">,</span>xlab<span class="token operator">=</span><span class="token string">"days"</span><span class="token punctuation">,</span>ylab<span class="token operator">=</span><span class="token string">"Percentage of people"</span><span class="token punctuation">,</span>type<span class="token operator">=</span><span class="token string">"b"</span><span class="token punctuation">,</span>col<span class="token operator">=</span><span class="token string">"green"</span><span class="token punctuation">,</span> ylim<span class="token operator">=</span>c<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">,</span>main<span class="token operator">=</span><span class="token string">"Evolution of SIR model epidemic"</span><span class="token punctuation">)</span>
  lines<span class="token punctuation">(</span>x<span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token number">0</span><span class="token operator">:</span>time<span class="token punctuation">)</span><span class="token punctuation">,</span> y <span class="token operator">=</span> mat_res<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token punctuation">]</span><span class="token punctuation">,</span>type<span class="token operator">=</span><span class="token string">"b"</span><span class="token punctuation">,</span>col<span class="token operator">=</span><span class="token string">"blue"</span><span class="token punctuation">)</span>
  lines<span class="token punctuation">(</span>x<span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token number">0</span><span class="token operator">:</span>time<span class="token punctuation">)</span><span class="token punctuation">,</span> y <span class="token operator">=</span> mat_res<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token punctuation">]</span><span class="token punctuation">,</span>type<span class="token operator">=</span><span class="token string">"b"</span><span class="token punctuation">,</span>col<span class="token operator">=</span><span class="token string">"red"</span><span class="token punctuation">)</span>
  legend<span class="token punctuation">(</span> <span class="token punctuation">(</span> time<span class="token operator">-</span><span class="token punctuation">(</span>time<span class="token operator">*</span><span class="token number">0.15</span><span class="token punctuation">)</span> <span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">90</span><span class="token punctuation">,</span> legend<span class="token operator">=</span>c<span class="token punctuation">(</span><span class="token string">"Suceptible"</span><span class="token punctuation">,</span> <span class="token string">"Infected"</span><span class="token punctuation">,</span><span class="token string">"Recovered"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
          col<span class="token operator">=</span>c<span class="token punctuation">(</span><span class="token string">"green"</span><span class="token punctuation">,</span><span class="token string">"blue"</span><span class="token punctuation">,</span><span class="token string">"red"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> lty<span class="token operator">=</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">3</span><span class="token punctuation">,</span> cex<span class="token operator">=</span><span class="token number">0.8</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

epidemic_plot <span class="token operator">&lt;-</span> <span class="token keyword">function</span><span class="token punctuation">(</span>igraph<span class="token punctuation">,</span>mainstr<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
  nb_node <span class="token operator">&lt;-</span> vcount<span class="token punctuation">(</span>igraph<span class="token punctuation">)</span>
  <span class="token keyword">for</span><span class="token punctuation">(</span>i <span class="token keyword">in</span> <span class="token number">1</span><span class="token operator">:</span> nb_node<span class="token punctuation">)</span>
  <span class="token punctuation">{</span>
    node_status <span class="token operator">&lt;-</span> get.vertex.attribute<span class="token punctuation">(</span>igraph<span class="token punctuation">,</span><span class="token string">"epidemic"</span><span class="token punctuation">,</span> i<span class="token punctuation">)</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span> node_status <span class="token operator">==</span> <span class="token string">"i"</span> <span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
      igraph <span class="token operator">&lt;-</span> set.vertex.attribute<span class="token punctuation">(</span>igraph<span class="token punctuation">,</span> <span class="token string">'color'</span><span class="token punctuation">,</span> i<span class="token punctuation">,</span> rgb<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>node_status <span class="token operator">==</span> <span class="token string">"s"</span> <span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
      igraph <span class="token operator">&lt;-</span> set.vertex.attribute<span class="token punctuation">(</span>igraph<span class="token punctuation">,</span> <span class="token string">'color'</span><span class="token punctuation">,</span> i<span class="token punctuation">,</span> rgb<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>node_status <span class="token operator">==</span> <span class="token string">"r"</span> <span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
      igraph <span class="token operator">&lt;-</span> set.vertex.attribute<span class="token punctuation">(</span>igraph<span class="token punctuation">,</span> <span class="token string">'color'</span><span class="token punctuation">,</span> i<span class="token punctuation">,</span> rgb<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">else</span><span class="token punctuation">{</span>
      print<span class="token punctuation">(</span><span class="token string">"BUG PLOT attribute"</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">for</span><span class="token punctuation">(</span>i <span class="token keyword">in</span> <span class="token number">1</span><span class="token operator">:</span> nb_node<span class="token punctuation">)</span>
  <span class="token punctuation">{</span>
    node_status <span class="token operator">&lt;-</span> get.vertex.attribute<span class="token punctuation">(</span>igraph<span class="token punctuation">,</span><span class="token string">"i_time"</span><span class="token punctuation">,</span> i<span class="token punctuation">)</span>

    <span class="token keyword">if</span><span class="token punctuation">(</span> node_status <span class="token operator">&gt;</span> <span class="token number">0</span> <span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
      igraph <span class="token operator">&lt;-</span> set.vertex.attribute<span class="token punctuation">(</span>igraph<span class="token punctuation">,</span> <span class="token string">"label"</span><span class="token punctuation">,</span> i<span class="token punctuation">,</span> node_status  <span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span> node_status <span class="token operator">==</span> <span class="token number">0</span> <span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
      igraph <span class="token operator">&lt;-</span> set.vertex.attribute<span class="token punctuation">(</span>igraph<span class="token punctuation">,</span> <span class="token string">"label"</span><span class="token punctuation">,</span> i<span class="token punctuation">,</span> <span class="token string">"R"</span>  <span class="token punctuation">)</span>
      igraph <span class="token operator">&lt;-</span> set.vertex.attribute<span class="token punctuation">(</span>igraph<span class="token punctuation">,</span> <span class="token string">'color'</span><span class="token punctuation">,</span> i<span class="token punctuation">,</span> rgb<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token keyword">else</span>
    <span class="token punctuation">{</span>
      igraph <span class="token operator">&lt;-</span> set.vertex.attribute<span class="token punctuation">(</span>igraph<span class="token punctuation">,</span> <span class="token string">"label"</span><span class="token punctuation">,</span> i<span class="token punctuation">,</span> <span class="token string">"S"</span>  <span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
  plot<span class="token punctuation">(</span>igraph<span class="token punctuation">,</span> main <span class="token operator">=</span> mainstr <span class="token punctuation">)</span>
<span class="token punctuation">}</span>

is_unique <span class="token operator">&lt;-</span> <span class="token keyword">function</span><span class="token punctuation">(</span>vect<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
  isunique <span class="token operator">&lt;-</span> <span class="token boolean">TRUE</span>
  <span class="token keyword">for</span><span class="token punctuation">(</span>i <span class="token keyword">in</span> <span class="token number">1</span><span class="token operator">:</span> length<span class="token punctuation">(</span>vect<span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token punctuation">{</span>
    iterator <span class="token operator">&lt;-</span> vect<span class="token punctuation">[</span>i<span class="token punctuation">]</span>
    <span class="token keyword">for</span><span class="token punctuation">(</span>j <span class="token keyword">in</span> <span class="token number">1</span><span class="token operator">:</span>length<span class="token punctuation">(</span>vect<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
      <span class="token keyword">if</span><span class="token punctuation">(</span>j <span class="token operator">!=</span> i<span class="token punctuation">)</span>
      <span class="token punctuation">{</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>vect<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">==</span> vect<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
          isunique <span class="token operator">&lt;-</span> <span class="token boolean">FALSE</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
  isunique
<span class="token punctuation">}</span>

<span class="token comment"># The way we ensure uniqueness may be improuved with faster (and nicer) algorithm</span>
ensure_unique <span class="token operator">&lt;-</span> <span class="token keyword">function</span><span class="token punctuation">(</span>vect<span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token keyword">while</span><span class="token punctuation">(</span>is_unique<span class="token punctuation">(</span>vect<span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token boolean">TRUE</span><span class="token punctuation">)</span>
  <span class="token punctuation">{</span>
    <span class="token keyword">for</span><span class="token punctuation">(</span>i <span class="token keyword">in</span> <span class="token number">1</span><span class="token operator">:</span> length<span class="token punctuation">(</span>vect<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
      iterator <span class="token operator">&lt;-</span> vect<span class="token punctuation">[</span>i<span class="token punctuation">]</span>
      <span class="token keyword">for</span><span class="token punctuation">(</span>j <span class="token keyword">in</span> <span class="token number">1</span><span class="token operator">:</span>length<span class="token punctuation">(</span>vect<span class="token punctuation">)</span><span class="token punctuation">)</span>
      <span class="token punctuation">{</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>j <span class="token operator">!=</span> i<span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
          <span class="token keyword">if</span><span class="token punctuation">(</span>iterator <span class="token operator">==</span> vect<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token punctuation">)</span>
          <span class="token punctuation">{</span>
            vect<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">&lt;-</span> floor<span class="token punctuation">(</span>runif<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span>min<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span>max<span class="token operator">=</span>length<span class="token punctuation">(</span>vect<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
  vect
<span class="token punctuation">}</span>

init_epidemic <span class="token operator">&lt;-</span> <span class="token keyword">function</span><span class="token punctuation">(</span>igraph<span class="token punctuation">,</span>n_0<span class="token punctuation">,</span>n_d<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
  nb_node <span class="token operator">&lt;-</span> vcount<span class="token punctuation">(</span>igraph<span class="token punctuation">)</span>
  Infected_vect <span class="token operator">&lt;-</span> floor<span class="token punctuation">(</span>runif<span class="token punctuation">(</span>n_0<span class="token punctuation">,</span>min<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span>max<span class="token operator">=</span>nb_node<span class="token punctuation">)</span><span class="token punctuation">)</span>
  Infected_vect <span class="token operator">&lt;-</span> ensure_unique<span class="token punctuation">(</span>Infected_vect<span class="token punctuation">)</span>

  igraph <span class="token operator">&lt;-</span> set.vertex.attribute<span class="token punctuation">(</span>igraph<span class="token punctuation">,</span><span class="token string">"epidemic"</span><span class="token punctuation">,</span> value<span class="token operator">=</span><span class="token string">"s"</span><span class="token punctuation">)</span>
  igraph <span class="token operator">&lt;-</span> set.vertex.attribute<span class="token punctuation">(</span>igraph<span class="token punctuation">,</span><span class="token string">"i_time"</span><span class="token punctuation">,</span> value <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span> <span class="token punctuation">)</span>
  <span class="token keyword">for</span><span class="token punctuation">(</span> i <span class="token keyword">in</span> <span class="token number">1</span> <span class="token operator">:</span> n_0 <span class="token punctuation">)</span>
  <span class="token punctuation">{</span>
    igraph <span class="token operator">&lt;-</span> set.vertex.attribute<span class="token punctuation">(</span>igraph<span class="token punctuation">,</span><span class="token string">"epidemic"</span><span class="token punctuation">,</span> Infected_vect<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token punctuation">,</span>value<span class="token operator">=</span><span class="token string">"i"</span><span class="token punctuation">)</span>
    igraph <span class="token operator">&lt;-</span> set.vertex.attribute<span class="token punctuation">(</span>igraph<span class="token punctuation">,</span><span class="token string">"i_time"</span><span class="token punctuation">,</span> Infected_vect<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token punctuation">,</span>value<span class="token operator">=</span> n_d <span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
  stat_days<span class="token punctuation">(</span>igraph<span class="token punctuation">)</span>
  igraph
<span class="token punctuation">}</span>

infected_heal <span class="token operator">&lt;-</span> <span class="token keyword">function</span><span class="token punctuation">(</span>igraph<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
  nb_node <span class="token operator">&lt;-</span> vcount<span class="token punctuation">(</span>igraph<span class="token punctuation">)</span>
  <span class="token keyword">for</span><span class="token punctuation">(</span> i <span class="token keyword">in</span> <span class="token number">1</span><span class="token operator">:</span> nb_node<span class="token punctuation">)</span>
  <span class="token punctuation">{</span>
    node_time_status <span class="token operator">&lt;-</span> get.vertex.attribute<span class="token punctuation">(</span>igraph<span class="token punctuation">,</span><span class="token string">"i_time"</span><span class="token punctuation">,</span> i<span class="token punctuation">)</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span> node_time_status <span class="token operator">&gt;</span> <span class="token number">0</span> <span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
      igraph <span class="token operator">&lt;-</span> set.vertex.attribute<span class="token punctuation">(</span>igraph<span class="token punctuation">,</span><span class="token string">"i_time"</span><span class="token punctuation">,</span> i <span class="token punctuation">,</span>value<span class="token operator">=</span> <span class="token punctuation">(</span>node_time_status <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span> node_time_status <span class="token operator">==</span> <span class="token number">1</span> <span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
      <span class="token comment">#cat("Last day of infection ? \n")</span>
      igraph <span class="token operator">&lt;-</span> set.vertex.attribute<span class="token punctuation">(</span>igraph<span class="token punctuation">,</span><span class="token string">"epidemic"</span><span class="token punctuation">,</span> i <span class="token punctuation">,</span>value<span class="token operator">=</span><span class="token string">"r"</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
  igraph
<span class="token punctuation">}</span>

transmission <span class="token operator">&lt;-</span> <span class="token keyword">function</span><span class="token punctuation">(</span>igraph<span class="token punctuation">,</span>p_epidemic<span class="token punctuation">,</span>n_d<span class="token punctuation">,</span>vect_asymptomatic_people<span class="token punctuation">,</span>false_negatives<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
  igraph <span class="token operator">&lt;-</span> infected_heal<span class="token punctuation">(</span>igraph<span class="token punctuation">)</span>
  nb_node <span class="token operator">&lt;-</span> vcount<span class="token punctuation">(</span>igraph<span class="token punctuation">)</span>

  adj_mat <span class="token operator">&lt;-</span> as_adjacency_matrix<span class="token punctuation">(</span>igraph<span class="token punctuation">,</span> type <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token string">"both"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

  vect_i <span class="token operator">&lt;-</span> vector<span class="token punctuation">(</span>mode <span class="token operator">=</span> <span class="token string">"numeric"</span><span class="token punctuation">,</span>nb_node<span class="token punctuation">)</span>
  vect_i_opo <span class="token operator">&lt;-</span> vector<span class="token punctuation">(</span>mode <span class="token operator">=</span> <span class="token string">"numeric"</span><span class="token punctuation">,</span>nb_node<span class="token punctuation">)</span>
  <span class="token keyword">for</span><span class="token punctuation">(</span>i <span class="token keyword">in</span> <span class="token number">1</span><span class="token operator">:</span>nb_node<span class="token punctuation">)</span>
  <span class="token punctuation">{</span>
    node_status <span class="token operator">&lt;-</span> get.vertex.attribute<span class="token punctuation">(</span>igraph<span class="token punctuation">,</span><span class="token string">"epidemic"</span><span class="token punctuation">,</span> i<span class="token punctuation">)</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span> node_status <span class="token operator">==</span> <span class="token string">"i"</span> <span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
      vect_i<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">&lt;-</span> <span class="token number">1</span>
      vect_i_opo<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">&lt;-</span> <span class="token number">0</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">else</span>
    <span class="token punctuation">{</span>
      vect_i<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">&lt;-</span> <span class="token number">0</span>
      vect_i_opo<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">&lt;-</span> <span class="token number">1</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>

  vect_r_op <span class="token operator">&lt;-</span> vector<span class="token punctuation">(</span>mode <span class="token operator">=</span> <span class="token string">"numeric"</span><span class="token punctuation">,</span>nb_node<span class="token punctuation">)</span>
  <span class="token keyword">for</span><span class="token punctuation">(</span>i <span class="token keyword">in</span> <span class="token number">1</span><span class="token operator">:</span>nb_node<span class="token punctuation">)</span>
  <span class="token punctuation">{</span>
    node_status <span class="token operator">&lt;-</span> get.vertex.attribute<span class="token punctuation">(</span>igraph<span class="token punctuation">,</span><span class="token string">"epidemic"</span><span class="token punctuation">,</span> i<span class="token punctuation">)</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span> node_status <span class="token operator">==</span> <span class="token string">"r"</span> <span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
      vect_r_op<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">&lt;-</span> <span class="token number">0</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">else</span>
    <span class="token punctuation">{</span>
      vect_r_op<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">&lt;-</span> <span class="token number">1</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>


  neigbour_infected_vect <span class="token operator">&lt;-</span> adj_mat<span class="token percent-operator operator">%*%</span>vect_i
  try_infect <span class="token operator">&lt;-</span> as.vector<span class="token punctuation">(</span>neigbour_infected_vect<span class="token punctuation">)</span><span class="token operator">*</span>vect_r_op<span class="token operator">*</span>vect_i_opo
  <span class="token keyword">for</span><span class="token punctuation">(</span>i <span class="token keyword">in</span> <span class="token number">1</span><span class="token operator">:</span>nb_node<span class="token punctuation">)</span>
  <span class="token punctuation">{</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>try_infect<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">&gt;</span> <span class="token number">0</span> <span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
      <span class="token keyword">for</span><span class="token punctuation">(</span>j <span class="token keyword">in</span> <span class="token number">1</span><span class="token operator">:</span>try_infect<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token punctuation">)</span>
      <span class="token punctuation">{</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>runif<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span> p_epidemic<span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
          igraph <span class="token operator">&lt;-</span> set.vertex.attribute<span class="token punctuation">(</span>igraph<span class="token punctuation">,</span><span class="token string">"epidemic"</span><span class="token punctuation">,</span> i <span class="token punctuation">,</span>value<span class="token operator">=</span><span class="token string">"i"</span><span class="token punctuation">)</span>
          igraph <span class="token operator">&lt;-</span> set.vertex.attribute<span class="token punctuation">(</span>igraph<span class="token punctuation">,</span><span class="token string">"i_time"</span><span class="token punctuation">,</span> i <span class="token punctuation">,</span>value<span class="token operator">=</span> n_d <span class="token punctuation">)</span>
          <span class="token comment">#cat("We inflect node N",i,"\n")</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">for</span><span class="token punctuation">(</span>i <span class="token keyword">in</span> <span class="token number">1</span><span class="token operator">:</span>nb_node<span class="token punctuation">)</span>
  <span class="token punctuation">{</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>try_infect<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">&gt;</span> <span class="token number">0</span> <span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
      <span class="token keyword">for</span><span class="token punctuation">(</span>j <span class="token keyword">in</span> <span class="token number">1</span><span class="token operator">:</span>try_infect<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token punctuation">)</span>
      <span class="token punctuation">{</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>runif<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span> p_epidemic<span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
          igraph <span class="token operator">&lt;-</span> set.vertex.attribute<span class="token punctuation">(</span>igraph<span class="token punctuation">,</span><span class="token string">"epidemic"</span><span class="token punctuation">,</span> i <span class="token punctuation">,</span>value<span class="token operator">=</span><span class="token string">"i"</span><span class="token punctuation">)</span>
          igraph <span class="token operator">&lt;-</span> set.vertex.attribute<span class="token punctuation">(</span>igraph<span class="token punctuation">,</span><span class="token string">"i_time"</span><span class="token punctuation">,</span> i <span class="token punctuation">,</span>value<span class="token operator">=</span> n_d <span class="token punctuation">)</span>
          <span class="token comment">#cat("We inflect node N",i,"\n")</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
  igraph <span class="token operator">&lt;-</span> positive_test<span class="token punctuation">(</span>igraph<span class="token punctuation">,</span>vect_asymptomatic_people<span class="token punctuation">,</span>false_negatives<span class="token punctuation">)</span>
  igraph
<span class="token punctuation">}</span>

positive_test <span class="token operator">&lt;-</span> <span class="token keyword">function</span><span class="token punctuation">(</span>igraph<span class="token punctuation">,</span>vect_asymptomatic_people<span class="token punctuation">,</span>false_negatives<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
  nb_node <span class="token operator">&lt;-</span> vcount<span class="token punctuation">(</span>igraph<span class="token punctuation">)</span>
  cat<span class="token punctuation">(</span><span class="token string">"Init = "</span><span class="token punctuation">,</span>length<span class="token punctuation">(</span>as_edgelist<span class="token punctuation">(</span>igraph<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">"\n"</span><span class="token punctuation">)</span>
  adj_lst <span class="token operator">&lt;-</span> as_adj_list<span class="token punctuation">(</span>igraph<span class="token punctuation">,</span> mode <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token string">"all"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token keyword">for</span><span class="token punctuation">(</span>i <span class="token keyword">in</span> <span class="token number">1</span><span class="token operator">:</span>nb_node<span class="token punctuation">)</span>
  <span class="token punctuation">{</span>
    itime <span class="token operator">&lt;-</span> get.vertex.attribute<span class="token punctuation">(</span>igraph<span class="token punctuation">,</span><span class="token string">"i_time"</span><span class="token punctuation">,</span> i <span class="token punctuation">)</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span> <span class="token punctuation">(</span>itime <span class="token operator">&lt;=</span> <span class="token number">5</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span>itime <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span>  <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span> runif<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> false_negatives<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span>vect_asymptomatic_people<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">0</span> <span class="token punctuation">)</span> <span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
      igraph <span class="token operator">&lt;-</span> delete.edges<span class="token punctuation">(</span>igraph<span class="token punctuation">,</span>which<span class="token punctuation">(</span>as_edgelist<span class="token punctuation">(</span>igraph<span class="token punctuation">)</span><span class="token operator">==</span>i<span class="token punctuation">,</span>arr.ind<span class="token operator">=</span><span class="token boolean">TRUE</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
  cat<span class="token punctuation">(</span><span class="token string">"AFTER  = "</span><span class="token punctuation">,</span>length<span class="token punctuation">(</span>as_edgelist<span class="token punctuation">(</span>igraph<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">"\n"</span><span class="token punctuation">)</span>
  igraph
<span class="token punctuation">}</span>

asymptomatic_people <span class="token operator">&lt;-</span> <span class="token keyword">function</span><span class="token punctuation">(</span>igraph<span class="token punctuation">,</span>asymptomatic_proba<span class="token punctuation">)</span><span class="token punctuation">{</span>
  nb_node <span class="token operator">&lt;-</span> vcount<span class="token punctuation">(</span>igraph<span class="token punctuation">)</span>
  vect_asymptomatic_people <span class="token operator">&lt;-</span> vector<span class="token punctuation">(</span>mode <span class="token operator">=</span> <span class="token string">"numeric"</span><span class="token punctuation">,</span>nb_node<span class="token punctuation">)</span>
  <span class="token keyword">for</span><span class="token punctuation">(</span> i <span class="token keyword">in</span> <span class="token number">1</span><span class="token operator">:</span>nb_node <span class="token punctuation">)</span>
  <span class="token punctuation">{</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span> runif<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> asymptomatic_proba <span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
      vect_asymptomatic_people<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">&lt;-</span> <span class="token number">0</span>
    <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>
      vect_asymptomatic_people<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">&lt;-</span> <span class="token number">1</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
  vect_asymptomatic_people
<span class="token punctuation">}</span>


stat_days <span class="token operator">&lt;-</span> <span class="token keyword">function</span><span class="token punctuation">(</span>igraph<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
  nb_node <span class="token operator">&lt;-</span> vcount<span class="token punctuation">(</span>igraph<span class="token punctuation">)</span>
  tot_i <span class="token operator">&lt;-</span> <span class="token number">0</span>
  tot_s <span class="token operator">&lt;-</span> <span class="token number">0</span>
  tot_r <span class="token operator">&lt;-</span> <span class="token number">0</span>
  res <span class="token operator">&lt;-</span> vector<span class="token punctuation">(</span>mode <span class="token operator">=</span> <span class="token string">"numeric"</span><span class="token punctuation">)</span>
  <span class="token keyword">for</span><span class="token punctuation">(</span>i <span class="token keyword">in</span> <span class="token number">1</span><span class="token operator">:</span>nb_node<span class="token punctuation">)</span>
  <span class="token punctuation">{</span>
    epi <span class="token operator">&lt;-</span> get.vertex.attribute<span class="token punctuation">(</span>igraph<span class="token punctuation">,</span><span class="token string">"epidemic"</span><span class="token punctuation">,</span> i <span class="token punctuation">)</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>epi <span class="token operator">==</span> <span class="token string">"i"</span> <span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
      tot_i <span class="token operator">&lt;-</span> tot_i <span class="token operator">+</span> <span class="token number">1</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>epi <span class="token operator">==</span> <span class="token string">"s"</span> <span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
      tot_s <span class="token operator">&lt;-</span> tot_s <span class="token operator">+</span> <span class="token number">1</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>epi <span class="token operator">==</span> <span class="token string">"r"</span> <span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
      tot_r <span class="token operator">&lt;-</span> tot_r <span class="token operator">+</span> <span class="token number">1</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
  res<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">&lt;-</span> tot_i
  res<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">&lt;-</span> tot_s
  res<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">&lt;-</span> tot_r
  cat<span class="token punctuation">(</span><span class="token string">"Sucesptible: "</span><span class="token punctuation">,</span>res<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token string">" Infected: "</span><span class="token punctuation">,</span>res<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token string">"Recoverd: "</span><span class="token punctuation">,</span>res<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token string">"\n"</span><span class="token punctuation">)</span>
  res
<span class="token punctuation">}</span>

simulation <span class="token operator">&lt;-</span> <span class="token keyword">function</span><span class="token punctuation">(</span>igraph<span class="token punctuation">,</span>p_epidemic<span class="token punctuation">,</span>n_d<span class="token punctuation">,</span>time<span class="token punctuation">,</span>confinement_high<span class="token punctuation">,</span>confinement_low<span class="token punctuation">,</span>restriction_percentages<span class="token punctuation">,</span>travel_limitation<span class="token punctuation">,</span>false_negatives<span class="token punctuation">,</span>asymptomatic_proba<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
  cat<span class="token punctuation">(</span><span class="token string">"Begin simulation \n"</span><span class="token punctuation">)</span>
  init_graph <span class="token operator">&lt;-</span> igraph
  mat_res <span class="token operator">&lt;-</span> matrix<span class="token punctuation">(</span>ncol <span class="token operator">=</span> time<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">,</span>nrow <span class="token operator">=</span> <span class="token number">3</span> <span class="token punctuation">)</span>
  mat_res<span class="token punctuation">[</span><span class="token punctuation">,</span><span class="token number">1</span> <span class="token punctuation">]</span> <span class="token operator">&lt;-</span> stat_days<span class="token punctuation">(</span>igraph<span class="token punctuation">)</span>
  vect_asymptomatic_people <span class="token operator">&lt;-</span> asymptomatic_people<span class="token punctuation">(</span>igraph<span class="token punctuation">,</span>asymptomatic_proba<span class="token punctuation">)</span>
  <span class="token keyword">if</span><span class="token punctuation">(</span>travel_limitation <span class="token operator">==</span> <span class="token boolean">TRUE</span> <span class="token punctuation">)</span>
  <span class="token punctuation">{</span>
    restrictions <span class="token operator">&lt;-</span> <span class="token boolean">FALSE</span>
    <span class="token keyword">for</span><span class="token punctuation">(</span>i <span class="token keyword">in</span> <span class="token number">1</span><span class="token operator">:</span>time <span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
      strday <span class="token operator">&lt;-</span> c<span class="token punctuation">(</span><span class="token string">"Day N"</span><span class="token punctuation">,</span>toString<span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">)</span>
      cat<span class="token punctuation">(</span>strday<span class="token punctuation">,</span><span class="token string">"\n"</span><span class="token punctuation">)</span>
      igraph <span class="token operator">&lt;-</span> transmission<span class="token punctuation">(</span>igraph<span class="token punctuation">,</span>p_epidemic<span class="token punctuation">,</span>n_d<span class="token punctuation">,</span>vect_asymptomatic_people<span class="token punctuation">,</span>false_negatives<span class="token punctuation">)</span>

      <span class="token keyword">if</span><span class="token punctuation">(</span>restrictions <span class="token operator">==</span> <span class="token boolean">FALSE</span> <span class="token operator">&amp;&amp;</span> confine_required<span class="token punctuation">(</span>igraph<span class="token punctuation">,</span>confinement_high<span class="token punctuation">,</span>confinement_low<span class="token punctuation">,</span>restrictions<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token boolean">TRUE</span>  <span class="token punctuation">)</span>
      <span class="token punctuation">{</span>
        cat<span class="token punctuation">(</span><span class="token string">"Day of limitations implemention\n"</span><span class="token punctuation">)</span>
        igraph <span class="token operator">&lt;-</span> graph_with_restrictions<span class="token punctuation">(</span>igraph<span class="token punctuation">,</span>restriction_percentages<span class="token punctuation">)</span>
        restrictions <span class="token operator">&lt;-</span> <span class="token boolean">TRUE</span>
      <span class="token punctuation">}</span>
      <span class="token keyword">if</span><span class="token punctuation">(</span>restrictions <span class="token operator">==</span> <span class="token boolean">TRUE</span> <span class="token operator">&amp;&amp;</span> confine_required<span class="token punctuation">(</span>igraph<span class="token punctuation">,</span>confinement_high<span class="token punctuation">,</span>confinement_low<span class="token punctuation">,</span>restrictions<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token boolean">FALSE</span>  <span class="token punctuation">)</span>
      <span class="token punctuation">{</span>
        cat<span class="token punctuation">(</span><span class="token string">"Day of UNDO limitations implemention\n"</span><span class="token punctuation">)</span>
        igraph <span class="token operator">&lt;-</span> undo_graph_with_restrictions<span class="token punctuation">(</span>igraph<span class="token punctuation">,</span>init_graph<span class="token punctuation">)</span>
        restrictions <span class="token operator">&lt;-</span> <span class="token boolean">FALSE</span>
      <span class="token punctuation">}</span>
      restrans <span class="token operator">&lt;-</span> stat_days<span class="token punctuation">(</span>igraph<span class="token punctuation">)</span>
      <span class="token comment">#epidemic_plot(igraph,strday)</span>
      mat_res<span class="token punctuation">[</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">]</span> <span class="token operator">&lt;-</span> restrans
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>travel_limitation <span class="token operator">==</span> <span class="token boolean">FALSE</span> <span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">for</span><span class="token punctuation">(</span>i <span class="token keyword">in</span> <span class="token number">1</span><span class="token operator">:</span>time <span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
      strday <span class="token operator">&lt;-</span> c<span class="token punctuation">(</span><span class="token string">"Day N"</span><span class="token punctuation">,</span>toString<span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">)</span>
      cat<span class="token punctuation">(</span>strday<span class="token punctuation">,</span><span class="token string">"\n"</span><span class="token punctuation">)</span>
      igraph <span class="token operator">&lt;-</span> transmission<span class="token punctuation">(</span>igraph<span class="token punctuation">,</span>p_epidemic<span class="token punctuation">,</span>n_d<span class="token punctuation">,</span>vect_asymptomatic_people<span class="token punctuation">,</span>false_negatives<span class="token punctuation">)</span>
      restrans <span class="token operator">&lt;-</span> stat_days<span class="token punctuation">(</span>igraph<span class="token punctuation">)</span>
      <span class="token comment">#epidemic_plot(igraph,strday)</span>
      mat_res<span class="token punctuation">[</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">]</span> <span class="token operator">&lt;-</span> restrans
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
  mat_res
<span class="token punctuation">}</span>

<span class="token comment"># Dire que le graph devrait etre en constante volution ce qui plus repsentatif de la ralit plutot que de revenir a un etat initial fixe..</span>
undo_graph_with_restrictions <span class="token operator">&lt;-</span> <span class="token keyword">function</span><span class="token punctuation">(</span>graph_now<span class="token punctuation">,</span>graph_init<span class="token punctuation">)</span><span class="token punctuation">{</span>
  nb_node <span class="token operator">&lt;-</span> vcount<span class="token punctuation">(</span>graph_now<span class="token punctuation">)</span>
  <span class="token keyword">for</span><span class="token punctuation">(</span> i <span class="token keyword">in</span> <span class="token number">1</span><span class="token operator">:</span> nb_node<span class="token punctuation">)</span>
  <span class="token punctuation">{</span>
    epi <span class="token operator">&lt;-</span> get.vertex.attribute<span class="token punctuation">(</span>graph_now<span class="token punctuation">,</span><span class="token string">"epidemic"</span><span class="token punctuation">,</span> i <span class="token punctuation">)</span>
    itime <span class="token operator">&lt;-</span> get.vertex.attribute<span class="token punctuation">(</span>graph_now<span class="token punctuation">,</span><span class="token string">"i_time"</span><span class="token punctuation">,</span> i <span class="token punctuation">)</span>
    graph_init <span class="token operator">&lt;-</span> set.vertex.attribute<span class="token punctuation">(</span>graph_init<span class="token punctuation">,</span><span class="token string">"epidemic"</span><span class="token punctuation">,</span> i <span class="token punctuation">,</span>value<span class="token operator">=</span>epi<span class="token punctuation">)</span>
    graph_init <span class="token operator">&lt;-</span> set.vertex.attribute<span class="token punctuation">(</span>graph_init<span class="token punctuation">,</span><span class="token string">"i_time"</span><span class="token punctuation">,</span> i <span class="token punctuation">,</span>value<span class="token operator">=</span>itime<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
  graph_init
<span class="token punctuation">}</span>

graph_with_restrictions <span class="token operator">&lt;-</span> <span class="token keyword">function</span><span class="token punctuation">(</span>igraph<span class="token punctuation">,</span>restriction_percentages<span class="token punctuation">)</span><span class="token punctuation">{</span>
  edge_lst <span class="token operator">&lt;-</span> as_edgelist<span class="token punctuation">(</span>igraph<span class="token punctuation">)</span>

  delete_vect <span class="token operator">&lt;-</span> runif<span class="token punctuation">(</span>nrow<span class="token punctuation">(</span>edge_lst<span class="token punctuation">)</span><span class="token punctuation">)</span>
  vect_bind <span class="token operator">&lt;-</span> vector<span class="token punctuation">(</span>mode <span class="token operator">=</span> <span class="token string">"numeric"</span><span class="token punctuation">,</span>nrow<span class="token punctuation">(</span>edge_lst<span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token keyword">for</span><span class="token punctuation">(</span>i <span class="token keyword">in</span> nrow<span class="token punctuation">(</span>edge_lst<span class="token punctuation">)</span><span class="token operator">:</span><span class="token number">1</span> <span class="token punctuation">)</span>
  <span class="token punctuation">{</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span> delete_vect<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">&gt;</span> <span class="token punctuation">(</span>restriction_percentages<span class="token operator">/</span><span class="token number">100</span><span class="token punctuation">)</span>  <span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
      <span class="token comment">#edge_lst[i,3] &lt;- 0</span>
      vect_bind<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">&lt;-</span> <span class="token number">0</span>
    <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>
      vect_bind<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">&lt;-</span> <span class="token number">1</span>
      <span class="token comment">#edge_lst[i,3] &lt;- 1</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
  edge_lst <span class="token operator">&lt;-</span> cbind<span class="token punctuation">(</span>edge_lst<span class="token punctuation">,</span>vect_bind<span class="token punctuation">)</span>
  <span class="token keyword">for</span><span class="token punctuation">(</span>i <span class="token keyword">in</span> nrow<span class="token punctuation">(</span>edge_lst<span class="token punctuation">)</span><span class="token operator">:</span><span class="token number">1</span> <span class="token punctuation">)</span>
  <span class="token punctuation">{</span>
    <span class="token comment">#cat("del? \t",i,"\t",edge_lst[i,3])</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>edge_lst<span class="token punctuation">[</span>i<span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
      <span class="token comment">#cat("We sup\n")</span>
      edge_lst <span class="token operator">&lt;-</span> edge_lst<span class="token punctuation">[</span><span class="token operator">-</span>i<span class="token punctuation">,</span><span class="token punctuation">]</span>
    <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>
      <span class="token comment">#cat("\n")</span>
    <span class="token punctuation">}</span>

  <span class="token punctuation">}</span>
  edge_lst <span class="token operator">&lt;-</span> edge_lst<span class="token punctuation">[</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">3</span><span class="token punctuation">]</span>
  limited_graph <span class="token operator">&lt;-</span> graph_from_edgelist<span class="token punctuation">(</span>edge_lst<span class="token punctuation">,</span> directed <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">)</span>

  <span class="token comment"># cat("LIMITED ROW ",nrow(as_edgelist(limited_graph)),"Nbnode=",vcount(limited_graph) ,"\n")</span>
  <span class="token comment"># cat("UNLIMITED ROW ", nrow(as_edgelist(igraph)),"Nbnode=",vcount(limited_graph),"\n")</span>

  nb_node <span class="token operator">&lt;-</span> vcount<span class="token punctuation">(</span>igraph<span class="token punctuation">)</span>
  <span class="token keyword">for</span><span class="token punctuation">(</span> i <span class="token keyword">in</span> <span class="token number">1</span><span class="token operator">:</span> nb_node<span class="token punctuation">)</span>
  <span class="token punctuation">{</span>
    epi <span class="token operator">&lt;-</span> get.vertex.attribute<span class="token punctuation">(</span>igraph<span class="token punctuation">,</span><span class="token string">"epidemic"</span><span class="token punctuation">,</span> i <span class="token punctuation">)</span>
    itime <span class="token operator">&lt;-</span> get.vertex.attribute<span class="token punctuation">(</span>igraph<span class="token punctuation">,</span><span class="token string">"i_time"</span><span class="token punctuation">,</span> i <span class="token punctuation">)</span>
    limited_graph <span class="token operator">&lt;-</span> set.vertex.attribute<span class="token punctuation">(</span>limited_graph<span class="token punctuation">,</span><span class="token string">"epidemic"</span><span class="token punctuation">,</span> i <span class="token punctuation">,</span>value<span class="token operator">=</span>epi<span class="token punctuation">)</span>
    limited_graph <span class="token operator">&lt;-</span> set.vertex.attribute<span class="token punctuation">(</span>limited_graph<span class="token punctuation">,</span><span class="token string">"i_time"</span><span class="token punctuation">,</span> i <span class="token punctuation">,</span>value<span class="token operator">=</span>itime<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>

  <span class="token comment">#vertex_attr(limited_graph) &lt;- vertex_attr(igraph)</span>
  <span class="token comment"># cat("LIMITED ROW ",nrow(as_edgelist(limited_graph)),"Nbnode=",vcount(limited_graph) ,"\n")</span>
  <span class="token comment"># cat("UNLIMITED ROW ", nrow(as_edgelist(igraph)),"Nbnode=",vcount(limited_graph),"\n")</span>
  <span class="token comment"># print(vertex_attr(limited_graph))</span>
  <span class="token comment"># print("=====================")</span>
  <span class="token comment"># print(vertex_attr(igraph))</span>
  <span class="token comment">#epidemic_plot(igraph,"Unrestrited")</span>
  <span class="token comment">#epidemic_plot(igraph,"Restrited")</span>
  limited_graph
<span class="token punctuation">}</span>

confine_required <span class="token operator">&lt;-</span> <span class="token keyword">function</span><span class="token punctuation">(</span>igraph<span class="token punctuation">,</span>confinement_high<span class="token punctuation">,</span>confinement_low<span class="token punctuation">,</span>restrictions<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
  nb_node <span class="token operator">&lt;-</span> vcount<span class="token punctuation">(</span>igraph<span class="token punctuation">)</span>
  nb_i <span class="token operator">&lt;-</span> <span class="token number">0</span>
  <span class="token keyword">for</span><span class="token punctuation">(</span>i <span class="token keyword">in</span> <span class="token number">1</span><span class="token operator">:</span>nb_node<span class="token punctuation">)</span>
  <span class="token punctuation">{</span>
    node_status <span class="token operator">&lt;-</span> get.vertex.attribute<span class="token punctuation">(</span>igraph<span class="token punctuation">,</span><span class="token string">"epidemic"</span><span class="token punctuation">,</span> i<span class="token punctuation">)</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span> node_status <span class="token operator">==</span> <span class="token string">"i"</span> <span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
      nb_i <span class="token operator">&lt;-</span> nb_i<span class="token operator">+</span><span class="token number">1</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">if</span><span class="token punctuation">(</span>restrictions <span class="token operator">==</span> <span class="token boolean">FALSE</span><span class="token punctuation">)</span>
  <span class="token punctuation">{</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>nb_i <span class="token operator">&gt;</span> confinement_high<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
      restrictions <span class="token operator">&lt;-</span> <span class="token boolean">TRUE</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span> restrictions <span class="token operator">==</span> <span class="token boolean">TRUE</span> <span class="token punctuation">)</span>
  <span class="token punctuation">{</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span> nb_i <span class="token operator">&lt;</span> confinement_low <span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
      restrictions <span class="token operator">&lt;-</span> <span class="token boolean">FALSE</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
  <span class="token comment"># cat("Nb of infected people:",nb_i,"\n")</span>
  <span class="token comment"># cat("Contact limitation ? ",restrictions,"\n")</span>
  restrictions
<span class="token punctuation">}</span>


R0_calc <span class="token operator">&lt;-</span> <span class="token keyword">function</span><span class="token punctuation">(</span>result_mat<span class="token punctuation">,</span>nb_node<span class="token punctuation">,</span> n_d<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
  nb_day <span class="token operator">&lt;-</span> ncol<span class="token punctuation">(</span>result_mat<span class="token punctuation">)</span>
  gam <span class="token operator">&lt;-</span> <span class="token number">1</span><span class="token operator">/</span>n_d
  outmat <span class="token operator">&lt;-</span> matrix<span class="token punctuation">(</span>nrow <span class="token operator">=</span> <span class="token number">6</span><span class="token punctuation">,</span> ncol <span class="token operator">=</span> nb_day<span class="token punctuation">)</span>

  x <span class="token operator">&lt;-</span> result_mat<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token punctuation">]</span><span class="token operator">/</span>nb_node
  s <span class="token operator">&lt;-</span> result_mat<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token punctuation">]</span><span class="token operator">/</span>nb_node
  r <span class="token operator">&lt;-</span> result_mat<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token punctuation">]</span><span class="token operator">/</span>nb_node

  d_x <span class="token operator">&lt;-</span> vector<span class="token punctuation">(</span>mode <span class="token operator">=</span> <span class="token string">"numeric"</span><span class="token punctuation">,</span>nb_day<span class="token punctuation">)</span>
  d_s <span class="token operator">&lt;-</span> vector<span class="token punctuation">(</span>mode <span class="token operator">=</span> <span class="token string">"numeric"</span><span class="token punctuation">,</span>nb_day<span class="token punctuation">)</span>
  d_r <span class="token operator">&lt;-</span> vector<span class="token punctuation">(</span>mode <span class="token operator">=</span> <span class="token string">"numeric"</span><span class="token punctuation">,</span>nb_day<span class="token punctuation">)</span>
  beta <span class="token operator">&lt;-</span> vector<span class="token punctuation">(</span>mode <span class="token operator">=</span> <span class="token string">"numeric"</span><span class="token punctuation">,</span>nb_day<span class="token punctuation">)</span>
  gamma <span class="token operator">&lt;-</span> vector<span class="token punctuation">(</span>mode <span class="token operator">=</span> <span class="token string">"numeric"</span><span class="token punctuation">,</span>nb_day<span class="token punctuation">)</span>
  <span class="token keyword">for</span><span class="token punctuation">(</span>i <span class="token keyword">in</span> <span class="token number">2</span><span class="token operator">:</span>nb_day <span class="token punctuation">)</span>
  <span class="token punctuation">{</span>
    d_x<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">&lt;-</span> x<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">-</span> x<span class="token punctuation">[</span>i<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span>
    d_s<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">&lt;-</span> s<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">-</span> s<span class="token punctuation">[</span>i<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span>
    d_r<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">&lt;-</span> r<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">-</span> r<span class="token punctuation">[</span>i<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">for</span><span class="token punctuation">(</span>i <span class="token keyword">in</span> <span class="token number">2</span><span class="token operator">:</span>nb_day <span class="token punctuation">)</span>
  <span class="token punctuation">{</span>
    beta<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">&lt;-</span> d_s<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">/</span><span class="token punctuation">(</span>s<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">*</span>x<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
  print<span class="token punctuation">(</span>beta<span class="token operator">/</span><span class="token number">0.1</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

n <span class="token operator">&lt;-</span> <span class="token number">2000</span>
p <span class="token operator">&lt;-</span> <span class="token number">0.01</span>

p_epidemic <span class="token operator">&lt;-</span> <span class="token number">0.01</span>
time <span class="token operator">&lt;-</span> <span class="token number">70</span>

n_0 <span class="token operator">&lt;-</span> <span class="token number">10</span>
n_d <span class="token operator">&lt;-</span> <span class="token number">10</span>

travel_limitation <span class="token operator">&lt;-</span> <span class="token boolean">FALSE</span>
confinement_high <span class="token operator">&lt;-</span> <span class="token number">50</span>
confinement_low <span class="token operator">&lt;-</span> <span class="token number">10</span>
restriction_percentages <span class="token operator">&lt;-</span> <span class="token number">80</span>


false_negatives <span class="token operator">&lt;-</span> <span class="token number">0.2</span>
asymptomatic_proba <span class="token operator">&lt;-</span> <span class="token number">0.2</span>

ig <span class="token operator">&lt;-</span> Erdos_Renyi_optimized<span class="token punctuation">(</span>n<span class="token punctuation">,</span>p<span class="token punctuation">)</span>
cat<span class="token punctuation">(</span><span class="token string">"Erdos Renyi created\n"</span><span class="token punctuation">)</span>
ig <span class="token operator">&lt;-</span> init_epidemic<span class="token punctuation">(</span>ig<span class="token punctuation">,</span>n_0<span class="token punctuation">,</span>n_d<span class="token punctuation">)</span>
<span class="token comment">#epidemic_plot(ig,"Day One")</span>
cat<span class="token punctuation">(</span><span class="token string">"Infection initialized \n"</span><span class="token punctuation">)</span>
res <span class="token operator">&lt;-</span> simulation<span class="token punctuation">(</span>ig<span class="token punctuation">,</span>p_epidemic<span class="token punctuation">,</span>n_d<span class="token punctuation">,</span>time<span class="token punctuation">,</span>confinement_high<span class="token punctuation">,</span>confinement_low<span class="token punctuation">,</span>restriction_percentages<span class="token punctuation">,</span>travel_limitation<span class="token punctuation">,</span>false_negatives<span class="token punctuation">,</span>asymptomatic_proba<span class="token punctuation">)</span>
plot_epidemic_curves<span class="token punctuation">(</span><span class="token number">100</span><span class="token operator">*</span>res<span class="token operator">/</span>n<span class="token punctuation">,</span>time<span class="token punctuation">)</span>

<span class="token comment"># transmis &lt;- transmission(ig,p_epidemic,n_d)</span>
<span class="token comment"># epidemic_plot(transmis,"Day 2")</span>
<span class="token comment"># transmis &lt;- transmission(transmis,p_epidemic,n_d)</span>
<span class="token comment"># epidemic_plot(transmis,"Day 3")</span>
<span class="token comment">#R0_calc(res,n,n_d)</span>
<span class="token comment">#res &lt;- res*100/n</span>
<span class="token comment">#print(res)</span>
<span class="token comment">#plot_epidemic_curves(res,time)</span>
</code></pre><p><img src="/assets/test1.287dfcc8.png" alt=""></p><p>As expected the isolation of infected people reduce the maxium number of infected people, however the pic is still significant. The reason is maybe due to the fact that symptom only appear form the day N5.</p><h3><strong>Scenario B</strong></h3><p>How we apply the scenarios N2 where the 10% of the whole population (randomly chosen each day) is tested every day.</p><p>Here is the code used :</p><pre class="language-r"><code class="language-r">library<span class="token punctuation">(</span>igraph<span class="token punctuation">)</span>

Erdos_Renyi_optimized <span class="token operator">&lt;-</span> <span class="token keyword">function</span><span class="token punctuation">(</span>n<span class="token punctuation">,</span>p<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
  nb_tri <span class="token operator">&lt;-</span> n<span class="token operator">*</span><span class="token punctuation">(</span>n<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">2</span>
  mat <span class="token operator">&lt;-</span> diag<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span>nrow <span class="token operator">=</span> n<span class="token punctuation">,</span> ncol <span class="token operator">=</span> n<span class="token punctuation">)</span>
  vect_rand <span class="token operator">&lt;-</span> runif<span class="token punctuation">(</span>nb_tri <span class="token punctuation">,</span> min <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> max <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">-</span> p
  <span class="token keyword">for</span><span class="token punctuation">(</span>i <span class="token keyword">in</span> <span class="token number">1</span><span class="token operator">:</span>nb_tri<span class="token punctuation">)</span>
  <span class="token punctuation">{</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>vect_rand<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">&gt;</span><span class="token number">0</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
      vect_rand<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">&lt;-</span> <span class="token number">0</span> 
    <span class="token punctuation">}</span>
    <span class="token keyword">else</span>
    <span class="token punctuation">{</span>
      vect_rand<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">&lt;-</span> <span class="token number">1</span> 
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
  mat<span class="token punctuation">[</span>lower.tri<span class="token punctuation">(</span>mat<span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token operator">&lt;-</span> vect_rand
  mat <span class="token operator">&lt;-</span> t<span class="token punctuation">(</span>mat<span class="token punctuation">)</span>
  mat<span class="token punctuation">[</span>lower.tri<span class="token punctuation">(</span>mat<span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token operator">&lt;-</span> vect_rand
  igraph <span class="token operator">&lt;-</span> graph_from_adjacency_matrix<span class="token punctuation">(</span>mat<span class="token punctuation">,</span>mode <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token string">"undirected"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
  igraph
<span class="token punctuation">}</span>

plot_epidemic_curves <span class="token operator">&lt;-</span> <span class="token keyword">function</span><span class="token punctuation">(</span>mat_res<span class="token punctuation">,</span>time<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
  <span class="token comment">#print(mat_res)</span>
  plot<span class="token punctuation">(</span> x <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token number">0</span><span class="token operator">:</span>time<span class="token punctuation">)</span><span class="token punctuation">,</span> y <span class="token operator">=</span> mat_res<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token punctuation">]</span><span class="token punctuation">,</span>xlab<span class="token operator">=</span><span class="token string">"days"</span><span class="token punctuation">,</span>ylab<span class="token operator">=</span><span class="token string">"Percentage of people"</span><span class="token punctuation">,</span>type<span class="token operator">=</span><span class="token string">"b"</span><span class="token punctuation">,</span>col<span class="token operator">=</span><span class="token string">"green"</span><span class="token punctuation">,</span> ylim<span class="token operator">=</span>c<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">,</span>main<span class="token operator">=</span><span class="token string">"Evolution of SIR model epidemic"</span><span class="token punctuation">)</span>
  lines<span class="token punctuation">(</span>x<span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token number">0</span><span class="token operator">:</span>time<span class="token punctuation">)</span><span class="token punctuation">,</span> y <span class="token operator">=</span> mat_res<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token punctuation">]</span><span class="token punctuation">,</span>type<span class="token operator">=</span><span class="token string">"b"</span><span class="token punctuation">,</span>col<span class="token operator">=</span><span class="token string">"blue"</span><span class="token punctuation">)</span>
  lines<span class="token punctuation">(</span>x<span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token number">0</span><span class="token operator">:</span>time<span class="token punctuation">)</span><span class="token punctuation">,</span> y <span class="token operator">=</span> mat_res<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token punctuation">]</span><span class="token punctuation">,</span>type<span class="token operator">=</span><span class="token string">"b"</span><span class="token punctuation">,</span>col<span class="token operator">=</span><span class="token string">"red"</span><span class="token punctuation">)</span>
  legend<span class="token punctuation">(</span> <span class="token punctuation">(</span> time<span class="token operator">-</span><span class="token punctuation">(</span>time<span class="token operator">*</span><span class="token number">0.15</span><span class="token punctuation">)</span> <span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">90</span><span class="token punctuation">,</span> legend<span class="token operator">=</span>c<span class="token punctuation">(</span><span class="token string">"Suceptible"</span><span class="token punctuation">,</span> <span class="token string">"Infected"</span><span class="token punctuation">,</span><span class="token string">"Recovered"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
          col<span class="token operator">=</span>c<span class="token punctuation">(</span><span class="token string">"green"</span><span class="token punctuation">,</span><span class="token string">"blue"</span><span class="token punctuation">,</span><span class="token string">"red"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> lty<span class="token operator">=</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">3</span><span class="token punctuation">,</span> cex<span class="token operator">=</span><span class="token number">0.8</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

epidemic_plot <span class="token operator">&lt;-</span> <span class="token keyword">function</span><span class="token punctuation">(</span>igraph<span class="token punctuation">,</span>mainstr<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
  nb_node <span class="token operator">&lt;-</span> vcount<span class="token punctuation">(</span>igraph<span class="token punctuation">)</span>
  <span class="token keyword">for</span><span class="token punctuation">(</span>i <span class="token keyword">in</span> <span class="token number">1</span><span class="token operator">:</span> nb_node<span class="token punctuation">)</span>
  <span class="token punctuation">{</span>
    node_status <span class="token operator">&lt;-</span> get.vertex.attribute<span class="token punctuation">(</span>igraph<span class="token punctuation">,</span><span class="token string">"epidemic"</span><span class="token punctuation">,</span> i<span class="token punctuation">)</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span> node_status <span class="token operator">==</span> <span class="token string">"i"</span> <span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
      igraph <span class="token operator">&lt;-</span> set.vertex.attribute<span class="token punctuation">(</span>igraph<span class="token punctuation">,</span> <span class="token string">'color'</span><span class="token punctuation">,</span> i<span class="token punctuation">,</span> rgb<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>node_status <span class="token operator">==</span> <span class="token string">"s"</span> <span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
      igraph <span class="token operator">&lt;-</span> set.vertex.attribute<span class="token punctuation">(</span>igraph<span class="token punctuation">,</span> <span class="token string">'color'</span><span class="token punctuation">,</span> i<span class="token punctuation">,</span> rgb<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>node_status <span class="token operator">==</span> <span class="token string">"r"</span> <span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
      igraph <span class="token operator">&lt;-</span> set.vertex.attribute<span class="token punctuation">(</span>igraph<span class="token punctuation">,</span> <span class="token string">'color'</span><span class="token punctuation">,</span> i<span class="token punctuation">,</span> rgb<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">else</span><span class="token punctuation">{</span>
      print<span class="token punctuation">(</span><span class="token string">"BUG PLOT attribute"</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">for</span><span class="token punctuation">(</span>i <span class="token keyword">in</span> <span class="token number">1</span><span class="token operator">:</span> nb_node<span class="token punctuation">)</span>
  <span class="token punctuation">{</span>
    node_status <span class="token operator">&lt;-</span> get.vertex.attribute<span class="token punctuation">(</span>igraph<span class="token punctuation">,</span><span class="token string">"i_time"</span><span class="token punctuation">,</span> i<span class="token punctuation">)</span>

    <span class="token keyword">if</span><span class="token punctuation">(</span> node_status <span class="token operator">&gt;</span> <span class="token number">0</span> <span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
      igraph <span class="token operator">&lt;-</span> set.vertex.attribute<span class="token punctuation">(</span>igraph<span class="token punctuation">,</span> <span class="token string">"label"</span><span class="token punctuation">,</span> i<span class="token punctuation">,</span> node_status  <span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span> node_status <span class="token operator">==</span> <span class="token number">0</span> <span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
      igraph <span class="token operator">&lt;-</span> set.vertex.attribute<span class="token punctuation">(</span>igraph<span class="token punctuation">,</span> <span class="token string">"label"</span><span class="token punctuation">,</span> i<span class="token punctuation">,</span> <span class="token string">"R"</span>  <span class="token punctuation">)</span>
      igraph <span class="token operator">&lt;-</span> set.vertex.attribute<span class="token punctuation">(</span>igraph<span class="token punctuation">,</span> <span class="token string">'color'</span><span class="token punctuation">,</span> i<span class="token punctuation">,</span> rgb<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token keyword">else</span>
    <span class="token punctuation">{</span>
      igraph <span class="token operator">&lt;-</span> set.vertex.attribute<span class="token punctuation">(</span>igraph<span class="token punctuation">,</span> <span class="token string">"label"</span><span class="token punctuation">,</span> i<span class="token punctuation">,</span> <span class="token string">"S"</span>  <span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
  plot<span class="token punctuation">(</span>igraph<span class="token punctuation">,</span> main <span class="token operator">=</span> mainstr <span class="token punctuation">)</span>
<span class="token punctuation">}</span>

is_unique <span class="token operator">&lt;-</span> <span class="token keyword">function</span><span class="token punctuation">(</span>vect<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
  isunique <span class="token operator">&lt;-</span> <span class="token boolean">TRUE</span>
  <span class="token keyword">for</span><span class="token punctuation">(</span>i <span class="token keyword">in</span> <span class="token number">1</span><span class="token operator">:</span> length<span class="token punctuation">(</span>vect<span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token punctuation">{</span>
    iterator <span class="token operator">&lt;-</span> vect<span class="token punctuation">[</span>i<span class="token punctuation">]</span>
    <span class="token keyword">for</span><span class="token punctuation">(</span>j <span class="token keyword">in</span> <span class="token number">1</span><span class="token operator">:</span>length<span class="token punctuation">(</span>vect<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
      <span class="token keyword">if</span><span class="token punctuation">(</span>j <span class="token operator">!=</span> i<span class="token punctuation">)</span>
      <span class="token punctuation">{</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>vect<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">==</span> vect<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
          isunique <span class="token operator">&lt;-</span> <span class="token boolean">FALSE</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
  isunique
<span class="token punctuation">}</span>

<span class="token comment"># The way we ensure uniqueness may be improuved with faster (and nicer) algorithm</span>
ensure_unique <span class="token operator">&lt;-</span> <span class="token keyword">function</span><span class="token punctuation">(</span>vect<span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token keyword">while</span><span class="token punctuation">(</span>is_unique<span class="token punctuation">(</span>vect<span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token boolean">TRUE</span><span class="token punctuation">)</span>
  <span class="token punctuation">{</span>
    <span class="token keyword">for</span><span class="token punctuation">(</span>i <span class="token keyword">in</span> <span class="token number">1</span><span class="token operator">:</span> length<span class="token punctuation">(</span>vect<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
      iterator <span class="token operator">&lt;-</span> vect<span class="token punctuation">[</span>i<span class="token punctuation">]</span>
      <span class="token keyword">for</span><span class="token punctuation">(</span>j <span class="token keyword">in</span> <span class="token number">1</span><span class="token operator">:</span>length<span class="token punctuation">(</span>vect<span class="token punctuation">)</span><span class="token punctuation">)</span>
      <span class="token punctuation">{</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>j <span class="token operator">!=</span> i<span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
          <span class="token keyword">if</span><span class="token punctuation">(</span>iterator <span class="token operator">==</span> vect<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token punctuation">)</span>
          <span class="token punctuation">{</span>
            vect<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">&lt;-</span> floor<span class="token punctuation">(</span>runif<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span>min<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span>max<span class="token operator">=</span>length<span class="token punctuation">(</span>vect<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
  vect
<span class="token punctuation">}</span>

init_epidemic <span class="token operator">&lt;-</span> <span class="token keyword">function</span><span class="token punctuation">(</span>igraph<span class="token punctuation">,</span>n_0<span class="token punctuation">,</span>n_d<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
  nb_node <span class="token operator">&lt;-</span> vcount<span class="token punctuation">(</span>igraph<span class="token punctuation">)</span>
  Infected_vect <span class="token operator">&lt;-</span> floor<span class="token punctuation">(</span>runif<span class="token punctuation">(</span>n_0<span class="token punctuation">,</span>min<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span>max<span class="token operator">=</span>nb_node<span class="token punctuation">)</span><span class="token punctuation">)</span>
  Infected_vect <span class="token operator">&lt;-</span> ensure_unique<span class="token punctuation">(</span>Infected_vect<span class="token punctuation">)</span>

  igraph <span class="token operator">&lt;-</span> set.vertex.attribute<span class="token punctuation">(</span>igraph<span class="token punctuation">,</span><span class="token string">"epidemic"</span><span class="token punctuation">,</span> value<span class="token operator">=</span><span class="token string">"s"</span><span class="token punctuation">)</span>
  igraph <span class="token operator">&lt;-</span> set.vertex.attribute<span class="token punctuation">(</span>igraph<span class="token punctuation">,</span><span class="token string">"i_time"</span><span class="token punctuation">,</span> value <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span> <span class="token punctuation">)</span>
  <span class="token keyword">for</span><span class="token punctuation">(</span> i <span class="token keyword">in</span> <span class="token number">1</span> <span class="token operator">:</span> n_0 <span class="token punctuation">)</span>
  <span class="token punctuation">{</span>
    igraph <span class="token operator">&lt;-</span> set.vertex.attribute<span class="token punctuation">(</span>igraph<span class="token punctuation">,</span><span class="token string">"epidemic"</span><span class="token punctuation">,</span> Infected_vect<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token punctuation">,</span>value<span class="token operator">=</span><span class="token string">"i"</span><span class="token punctuation">)</span>
    igraph <span class="token operator">&lt;-</span> set.vertex.attribute<span class="token punctuation">(</span>igraph<span class="token punctuation">,</span><span class="token string">"i_time"</span><span class="token punctuation">,</span> Infected_vect<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token punctuation">,</span>value<span class="token operator">=</span> n_d <span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
  stat_days<span class="token punctuation">(</span>igraph<span class="token punctuation">)</span>
  igraph
<span class="token punctuation">}</span>

infected_heal <span class="token operator">&lt;-</span> <span class="token keyword">function</span><span class="token punctuation">(</span>igraph<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
  nb_node <span class="token operator">&lt;-</span> vcount<span class="token punctuation">(</span>igraph<span class="token punctuation">)</span>
  <span class="token keyword">for</span><span class="token punctuation">(</span> i <span class="token keyword">in</span> <span class="token number">1</span><span class="token operator">:</span> nb_node<span class="token punctuation">)</span>
  <span class="token punctuation">{</span>
    node_time_status <span class="token operator">&lt;-</span> get.vertex.attribute<span class="token punctuation">(</span>igraph<span class="token punctuation">,</span><span class="token string">"i_time"</span><span class="token punctuation">,</span> i<span class="token punctuation">)</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span> node_time_status <span class="token operator">&gt;</span> <span class="token number">0</span> <span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
      igraph <span class="token operator">&lt;-</span> set.vertex.attribute<span class="token punctuation">(</span>igraph<span class="token punctuation">,</span><span class="token string">"i_time"</span><span class="token punctuation">,</span> i <span class="token punctuation">,</span>value<span class="token operator">=</span> <span class="token punctuation">(</span>node_time_status <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span> node_time_status <span class="token operator">==</span> <span class="token number">1</span> <span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
      <span class="token comment">#cat("Last day of infection ? \n")</span>
      igraph <span class="token operator">&lt;-</span> set.vertex.attribute<span class="token punctuation">(</span>igraph<span class="token punctuation">,</span><span class="token string">"epidemic"</span><span class="token punctuation">,</span> i <span class="token punctuation">,</span>value<span class="token operator">=</span><span class="token string">"r"</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
  igraph
<span class="token punctuation">}</span>

transmission <span class="token operator">&lt;-</span> <span class="token keyword">function</span><span class="token punctuation">(</span>igraph<span class="token punctuation">,</span>p_epidemic<span class="token punctuation">,</span>n_d<span class="token punctuation">,</span>false_negatives_before4<span class="token punctuation">,</span>false_negatives_after4<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
  igraph <span class="token operator">&lt;-</span> infected_heal<span class="token punctuation">(</span>igraph<span class="token punctuation">)</span>
  nb_node <span class="token operator">&lt;-</span> vcount<span class="token punctuation">(</span>igraph<span class="token punctuation">)</span>

  adj_mat <span class="token operator">&lt;-</span> as_adjacency_matrix<span class="token punctuation">(</span>igraph<span class="token punctuation">,</span> type <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token string">"both"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

  vect_i <span class="token operator">&lt;-</span> vector<span class="token punctuation">(</span>mode <span class="token operator">=</span> <span class="token string">"numeric"</span><span class="token punctuation">,</span>nb_node<span class="token punctuation">)</span>
  vect_i_opo <span class="token operator">&lt;-</span> vector<span class="token punctuation">(</span>mode <span class="token operator">=</span> <span class="token string">"numeric"</span><span class="token punctuation">,</span>nb_node<span class="token punctuation">)</span>
  <span class="token keyword">for</span><span class="token punctuation">(</span>i <span class="token keyword">in</span> <span class="token number">1</span><span class="token operator">:</span>nb_node<span class="token punctuation">)</span>
  <span class="token punctuation">{</span>
    node_status <span class="token operator">&lt;-</span> get.vertex.attribute<span class="token punctuation">(</span>igraph<span class="token punctuation">,</span><span class="token string">"epidemic"</span><span class="token punctuation">,</span> i<span class="token punctuation">)</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span> node_status <span class="token operator">==</span> <span class="token string">"i"</span> <span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
      vect_i<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">&lt;-</span> <span class="token number">1</span>
      vect_i_opo<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">&lt;-</span> <span class="token number">0</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">else</span>
    <span class="token punctuation">{</span>
      vect_i<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">&lt;-</span> <span class="token number">0</span>
      vect_i_opo<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">&lt;-</span> <span class="token number">1</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>

  vect_r_op <span class="token operator">&lt;-</span> vector<span class="token punctuation">(</span>mode <span class="token operator">=</span> <span class="token string">"numeric"</span><span class="token punctuation">,</span>nb_node<span class="token punctuation">)</span>
  <span class="token keyword">for</span><span class="token punctuation">(</span>i <span class="token keyword">in</span> <span class="token number">1</span><span class="token operator">:</span>nb_node<span class="token punctuation">)</span>
  <span class="token punctuation">{</span>
    node_status <span class="token operator">&lt;-</span> get.vertex.attribute<span class="token punctuation">(</span>igraph<span class="token punctuation">,</span><span class="token string">"epidemic"</span><span class="token punctuation">,</span> i<span class="token punctuation">)</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span> node_status <span class="token operator">==</span> <span class="token string">"r"</span> <span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
      vect_r_op<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">&lt;-</span> <span class="token number">0</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">else</span>
    <span class="token punctuation">{</span>
      vect_r_op<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">&lt;-</span> <span class="token number">1</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>

  neigbour_infected_vect <span class="token operator">&lt;-</span> adj_mat<span class="token percent-operator operator">%*%</span>vect_i
  try_infect <span class="token operator">&lt;-</span> as.vector<span class="token punctuation">(</span>neigbour_infected_vect<span class="token punctuation">)</span><span class="token operator">*</span>vect_r_op<span class="token operator">*</span>vect_i_opo
  <span class="token keyword">for</span><span class="token punctuation">(</span>i <span class="token keyword">in</span> <span class="token number">1</span><span class="token operator">:</span>nb_node<span class="token punctuation">)</span>
  <span class="token punctuation">{</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>try_infect<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">&gt;</span> <span class="token number">0</span> <span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
      <span class="token keyword">for</span><span class="token punctuation">(</span>j <span class="token keyword">in</span> <span class="token number">1</span><span class="token operator">:</span>try_infect<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token punctuation">)</span>
      <span class="token punctuation">{</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>runif<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span> p_epidemic<span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
          igraph <span class="token operator">&lt;-</span> set.vertex.attribute<span class="token punctuation">(</span>igraph<span class="token punctuation">,</span><span class="token string">"epidemic"</span><span class="token punctuation">,</span> i <span class="token punctuation">,</span>value<span class="token operator">=</span><span class="token string">"i"</span><span class="token punctuation">)</span>
          igraph <span class="token operator">&lt;-</span> set.vertex.attribute<span class="token punctuation">(</span>igraph<span class="token punctuation">,</span><span class="token string">"i_time"</span><span class="token punctuation">,</span> i <span class="token punctuation">,</span>value<span class="token operator">=</span> n_d <span class="token punctuation">)</span>
          <span class="token comment">#cat("We inflect node N",i,"\n")</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">for</span><span class="token punctuation">(</span>i <span class="token keyword">in</span> <span class="token number">1</span><span class="token operator">:</span>nb_node<span class="token punctuation">)</span>
  <span class="token punctuation">{</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>try_infect<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">&gt;</span> <span class="token number">0</span> <span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
      <span class="token keyword">for</span><span class="token punctuation">(</span>j <span class="token keyword">in</span> <span class="token number">1</span><span class="token operator">:</span>try_infect<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token punctuation">)</span>
      <span class="token punctuation">{</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>runif<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span> p_epidemic<span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
          igraph <span class="token operator">&lt;-</span> set.vertex.attribute<span class="token punctuation">(</span>igraph<span class="token punctuation">,</span><span class="token string">"epidemic"</span><span class="token punctuation">,</span> i <span class="token punctuation">,</span>value<span class="token operator">=</span><span class="token string">"i"</span><span class="token punctuation">)</span>
          igraph <span class="token operator">&lt;-</span> set.vertex.attribute<span class="token punctuation">(</span>igraph<span class="token punctuation">,</span><span class="token string">"i_time"</span><span class="token punctuation">,</span> i <span class="token punctuation">,</span>value<span class="token operator">=</span> n_d <span class="token punctuation">)</span>
          <span class="token comment">#cat("We inflect node N",i,"\n")</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
  igraph <span class="token operator">&lt;-</span> positive_test_whole_pop<span class="token punctuation">(</span>igraph<span class="token punctuation">,</span>false_negatives_before4<span class="token punctuation">,</span>false_negatives_after4<span class="token punctuation">)</span>
  igraph
<span class="token punctuation">}</span>

batch_to_test <span class="token operator">&lt;-</span> <span class="token keyword">function</span><span class="token punctuation">(</span>igraph<span class="token punctuation">)</span><span class="token punctuation">{</span>
  nb_node <span class="token operator">&lt;-</span> vcount<span class="token punctuation">(</span>igraph<span class="token punctuation">)</span>
  proportion_to_test <span class="token operator">&lt;-</span> <span class="token number">0.1</span>
  batch <span class="token operator">&lt;-</span> vector<span class="token punctuation">(</span>mode <span class="token operator">=</span> <span class="token string">"numeric"</span><span class="token punctuation">,</span>nb_node<span class="token punctuation">)</span>
  <span class="token keyword">for</span><span class="token punctuation">(</span> i <span class="token keyword">in</span> <span class="token number">1</span><span class="token operator">:</span>nb_node <span class="token punctuation">)</span>
  <span class="token punctuation">{</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span> runif<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> asymptomatic_proba <span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
      batch<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">&lt;-</span> <span class="token number">0</span>
    <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>
      batch<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">&lt;-</span> <span class="token number">1</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
  batch
<span class="token punctuation">}</span>

positive_test_whole_pop <span class="token operator">&lt;-</span> <span class="token keyword">function</span><span class="token punctuation">(</span>igraph<span class="token punctuation">,</span>false_negatives_before4<span class="token punctuation">,</span>false_negatives_after4<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
  nb_node <span class="token operator">&lt;-</span> vcount<span class="token punctuation">(</span>igraph<span class="token punctuation">)</span>
  batch <span class="token operator">&lt;-</span> batch_to_test<span class="token punctuation">(</span>igraph<span class="token punctuation">)</span>
  cat<span class="token punctuation">(</span><span class="token string">"Init = "</span><span class="token punctuation">,</span>length<span class="token punctuation">(</span>as_edgelist<span class="token punctuation">(</span>igraph<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">"\n"</span><span class="token punctuation">)</span>
  adj_lst <span class="token operator">&lt;-</span> as_adj_list<span class="token punctuation">(</span>igraph<span class="token punctuation">,</span> mode <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token string">"all"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token keyword">for</span><span class="token punctuation">(</span>i <span class="token keyword">in</span> <span class="token number">1</span><span class="token operator">:</span>nb_node<span class="token punctuation">)</span>
  <span class="token punctuation">{</span>
    itime <span class="token operator">&lt;-</span> get.vertex.attribute<span class="token punctuation">(</span>igraph<span class="token punctuation">,</span><span class="token string">"i_time"</span><span class="token punctuation">,</span> i <span class="token punctuation">)</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span> <span class="token punctuation">(</span>itime <span class="token operator">&lt;=</span> <span class="token number">5</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span>itime <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span>  <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span> runif<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> false_negatives_after4<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span>batch<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">1</span> <span class="token punctuation">)</span> <span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
      igraph <span class="token operator">&lt;-</span> delete.edges<span class="token punctuation">(</span>igraph<span class="token punctuation">,</span>which<span class="token punctuation">(</span>as_edgelist<span class="token punctuation">(</span>igraph<span class="token punctuation">)</span><span class="token operator">==</span>i<span class="token punctuation">,</span>arr.ind<span class="token operator">=</span><span class="token boolean">TRUE</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span> <span class="token punctuation">(</span>itime <span class="token operator">&gt;</span> <span class="token number">5</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span> runif<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> false_negatives_before4 <span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span>batch<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">1</span> <span class="token punctuation">)</span> <span class="token punctuation">)</span><span class="token punctuation">{</span>
      igraph <span class="token operator">&lt;-</span> delete.edges<span class="token punctuation">(</span>igraph<span class="token punctuation">,</span>which<span class="token punctuation">(</span>as_edgelist<span class="token punctuation">(</span>igraph<span class="token punctuation">)</span><span class="token operator">==</span>i<span class="token punctuation">,</span>arr.ind<span class="token operator">=</span><span class="token boolean">TRUE</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
  cat<span class="token punctuation">(</span><span class="token string">"AFTER  = "</span><span class="token punctuation">,</span>length<span class="token punctuation">(</span>as_edgelist<span class="token punctuation">(</span>igraph<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">"\n"</span><span class="token punctuation">)</span>
  igraph
<span class="token punctuation">}</span>

stat_days <span class="token operator">&lt;-</span> <span class="token keyword">function</span><span class="token punctuation">(</span>igraph<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
  nb_node <span class="token operator">&lt;-</span> vcount<span class="token punctuation">(</span>igraph<span class="token punctuation">)</span>
  tot_i <span class="token operator">&lt;-</span> <span class="token number">0</span>
  tot_s <span class="token operator">&lt;-</span> <span class="token number">0</span>
  tot_r <span class="token operator">&lt;-</span> <span class="token number">0</span>
  res <span class="token operator">&lt;-</span> vector<span class="token punctuation">(</span>mode <span class="token operator">=</span> <span class="token string">"numeric"</span><span class="token punctuation">)</span>
  <span class="token keyword">for</span><span class="token punctuation">(</span>i <span class="token keyword">in</span> <span class="token number">1</span><span class="token operator">:</span>nb_node<span class="token punctuation">)</span>
  <span class="token punctuation">{</span>
    epi <span class="token operator">&lt;-</span> get.vertex.attribute<span class="token punctuation">(</span>igraph<span class="token punctuation">,</span><span class="token string">"epidemic"</span><span class="token punctuation">,</span> i <span class="token punctuation">)</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>epi <span class="token operator">==</span> <span class="token string">"i"</span> <span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
      tot_i <span class="token operator">&lt;-</span> tot_i <span class="token operator">+</span> <span class="token number">1</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>epi <span class="token operator">==</span> <span class="token string">"s"</span> <span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
      tot_s <span class="token operator">&lt;-</span> tot_s <span class="token operator">+</span> <span class="token number">1</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>epi <span class="token operator">==</span> <span class="token string">"r"</span> <span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
      tot_r <span class="token operator">&lt;-</span> tot_r <span class="token operator">+</span> <span class="token number">1</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
  res<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">&lt;-</span> tot_i
  res<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">&lt;-</span> tot_s
  res<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">&lt;-</span> tot_r
  cat<span class="token punctuation">(</span><span class="token string">"Sucesptible: "</span><span class="token punctuation">,</span>res<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token string">" Infected: "</span><span class="token punctuation">,</span>res<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token string">"Recoverd: "</span><span class="token punctuation">,</span>res<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token string">"\n"</span><span class="token punctuation">)</span>
  res
<span class="token punctuation">}</span>

simulation <span class="token operator">&lt;-</span> <span class="token keyword">function</span><span class="token punctuation">(</span>igraph<span class="token punctuation">,</span>p_epidemic<span class="token punctuation">,</span>n_d<span class="token punctuation">,</span>time<span class="token punctuation">,</span>confinement_high<span class="token punctuation">,</span>confinement_low<span class="token punctuation">,</span>restriction_percentages<span class="token punctuation">,</span>travel_limitation<span class="token punctuation">,</span>false_negatives_before4<span class="token punctuation">,</span>false_negatives_after4<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
  cat<span class="token punctuation">(</span><span class="token string">"Begin simulation \n"</span><span class="token punctuation">)</span>
  init_graph <span class="token operator">&lt;-</span> igraph
  mat_res <span class="token operator">&lt;-</span> matrix<span class="token punctuation">(</span>ncol <span class="token operator">=</span> time<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">,</span>nrow <span class="token operator">=</span> <span class="token number">3</span> <span class="token punctuation">)</span>
  mat_res<span class="token punctuation">[</span><span class="token punctuation">,</span><span class="token number">1</span> <span class="token punctuation">]</span> <span class="token operator">&lt;-</span> stat_days<span class="token punctuation">(</span>igraph<span class="token punctuation">)</span>
  <span class="token keyword">if</span><span class="token punctuation">(</span>travel_limitation <span class="token operator">==</span> <span class="token boolean">TRUE</span> <span class="token punctuation">)</span>
  <span class="token punctuation">{</span>
    restrictions <span class="token operator">&lt;-</span> <span class="token boolean">FALSE</span>
    <span class="token keyword">for</span><span class="token punctuation">(</span>i <span class="token keyword">in</span> <span class="token number">1</span><span class="token operator">:</span>time <span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
      strday <span class="token operator">&lt;-</span> c<span class="token punctuation">(</span><span class="token string">"Day N"</span><span class="token punctuation">,</span>toString<span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">)</span>
      cat<span class="token punctuation">(</span>strday<span class="token punctuation">,</span><span class="token string">"\n"</span><span class="token punctuation">)</span>
      igraph <span class="token operator">&lt;-</span> transmission<span class="token punctuation">(</span>igraph<span class="token punctuation">,</span>p_epidemic<span class="token punctuation">,</span>n_d<span class="token punctuation">,</span>false_negatives_before4<span class="token punctuation">,</span>false_negatives_after4<span class="token punctuation">)</span>

      <span class="token keyword">if</span><span class="token punctuation">(</span>restrictions <span class="token operator">==</span> <span class="token boolean">FALSE</span> <span class="token operator">&amp;&amp;</span> confine_required<span class="token punctuation">(</span>igraph<span class="token punctuation">,</span>confinement_high<span class="token punctuation">,</span>confinement_low<span class="token punctuation">,</span>restrictions<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token boolean">TRUE</span>  <span class="token punctuation">)</span>
      <span class="token punctuation">{</span>
        cat<span class="token punctuation">(</span><span class="token string">"Day of limitations implemention\n"</span><span class="token punctuation">)</span>
        igraph <span class="token operator">&lt;-</span> graph_with_restrictions<span class="token punctuation">(</span>igraph<span class="token punctuation">,</span>restriction_percentages<span class="token punctuation">)</span>
        restrictions <span class="token operator">&lt;-</span> <span class="token boolean">TRUE</span>
      <span class="token punctuation">}</span>
      <span class="token keyword">if</span><span class="token punctuation">(</span>restrictions <span class="token operator">==</span> <span class="token boolean">TRUE</span> <span class="token operator">&amp;&amp;</span> confine_required<span class="token punctuation">(</span>igraph<span class="token punctuation">,</span>confinement_high<span class="token punctuation">,</span>confinement_low<span class="token punctuation">,</span>restrictions<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token boolean">FALSE</span>  <span class="token punctuation">)</span>
      <span class="token punctuation">{</span>
        cat<span class="token punctuation">(</span><span class="token string">"Day of UNDO limitations implemention\n"</span><span class="token punctuation">)</span>
        igraph <span class="token operator">&lt;-</span> undo_graph_with_restrictions<span class="token punctuation">(</span>igraph<span class="token punctuation">,</span>init_graph<span class="token punctuation">)</span>
        restrictions <span class="token operator">&lt;-</span> <span class="token boolean">FALSE</span>
      <span class="token punctuation">}</span>
      restrans <span class="token operator">&lt;-</span> stat_days<span class="token punctuation">(</span>igraph<span class="token punctuation">)</span>
      <span class="token comment">#epidemic_plot(igraph,strday)</span>
      mat_res<span class="token punctuation">[</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">]</span> <span class="token operator">&lt;-</span> restrans
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>travel_limitation <span class="token operator">==</span> <span class="token boolean">FALSE</span> <span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">for</span><span class="token punctuation">(</span>i <span class="token keyword">in</span> <span class="token number">1</span><span class="token operator">:</span>time <span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
      strday <span class="token operator">&lt;-</span> c<span class="token punctuation">(</span><span class="token string">"Day N"</span><span class="token punctuation">,</span>toString<span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">)</span>
      cat<span class="token punctuation">(</span>strday<span class="token punctuation">,</span><span class="token string">"\n"</span><span class="token punctuation">)</span>
      igraph <span class="token operator">&lt;-</span> transmission<span class="token punctuation">(</span>igraph<span class="token punctuation">,</span>p_epidemic<span class="token punctuation">,</span>n_d<span class="token punctuation">,</span>false_negatives_before4<span class="token punctuation">,</span>false_negatives_after4<span class="token punctuation">)</span>
      restrans <span class="token operator">&lt;-</span> stat_days<span class="token punctuation">(</span>igraph<span class="token punctuation">)</span>
      <span class="token comment">#epidemic_plot(igraph,strday)</span>
      mat_res<span class="token punctuation">[</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">]</span> <span class="token operator">&lt;-</span> restrans
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
  mat_res
<span class="token punctuation">}</span>

<span class="token comment"># Dire que le graph devrait etre en constante volution ce qui plus repsentatif de la ralit plutot que de revenir a un etat initial fixe..</span>
undo_graph_with_restrictions <span class="token operator">&lt;-</span> <span class="token keyword">function</span><span class="token punctuation">(</span>graph_now<span class="token punctuation">,</span>graph_init<span class="token punctuation">)</span><span class="token punctuation">{</span>
  nb_node <span class="token operator">&lt;-</span> vcount<span class="token punctuation">(</span>graph_now<span class="token punctuation">)</span>
  <span class="token keyword">for</span><span class="token punctuation">(</span> i <span class="token keyword">in</span> <span class="token number">1</span><span class="token operator">:</span> nb_node<span class="token punctuation">)</span>
  <span class="token punctuation">{</span>
    epi <span class="token operator">&lt;-</span> get.vertex.attribute<span class="token punctuation">(</span>graph_now<span class="token punctuation">,</span><span class="token string">"epidemic"</span><span class="token punctuation">,</span> i <span class="token punctuation">)</span>
    itime <span class="token operator">&lt;-</span> get.vertex.attribute<span class="token punctuation">(</span>graph_now<span class="token punctuation">,</span><span class="token string">"i_time"</span><span class="token punctuation">,</span> i <span class="token punctuation">)</span>
    graph_init <span class="token operator">&lt;-</span> set.vertex.attribute<span class="token punctuation">(</span>graph_init<span class="token punctuation">,</span><span class="token string">"epidemic"</span><span class="token punctuation">,</span> i <span class="token punctuation">,</span>value<span class="token operator">=</span>epi<span class="token punctuation">)</span>
    graph_init <span class="token operator">&lt;-</span> set.vertex.attribute<span class="token punctuation">(</span>graph_init<span class="token punctuation">,</span><span class="token string">"i_time"</span><span class="token punctuation">,</span> i <span class="token punctuation">,</span>value<span class="token operator">=</span>itime<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
  graph_init
<span class="token punctuation">}</span>

graph_with_restrictions <span class="token operator">&lt;-</span> <span class="token keyword">function</span><span class="token punctuation">(</span>igraph<span class="token punctuation">,</span>restriction_percentages<span class="token punctuation">)</span><span class="token punctuation">{</span>
  edge_lst <span class="token operator">&lt;-</span> as_edgelist<span class="token punctuation">(</span>igraph<span class="token punctuation">)</span>

  delete_vect <span class="token operator">&lt;-</span> runif<span class="token punctuation">(</span>nrow<span class="token punctuation">(</span>edge_lst<span class="token punctuation">)</span><span class="token punctuation">)</span>
  vect_bind <span class="token operator">&lt;-</span> vector<span class="token punctuation">(</span>mode <span class="token operator">=</span> <span class="token string">"numeric"</span><span class="token punctuation">,</span>nrow<span class="token punctuation">(</span>edge_lst<span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token keyword">for</span><span class="token punctuation">(</span>i <span class="token keyword">in</span> nrow<span class="token punctuation">(</span>edge_lst<span class="token punctuation">)</span><span class="token operator">:</span><span class="token number">1</span> <span class="token punctuation">)</span>
  <span class="token punctuation">{</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span> delete_vect<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">&gt;</span> <span class="token punctuation">(</span>restriction_percentages<span class="token operator">/</span><span class="token number">100</span><span class="token punctuation">)</span>  <span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
      <span class="token comment">#edge_lst[i,3] &lt;- 0</span>
      vect_bind<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">&lt;-</span> <span class="token number">0</span>
    <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>
      vect_bind<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">&lt;-</span> <span class="token number">1</span>
      <span class="token comment">#edge_lst[i,3] &lt;- 1</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
  edge_lst <span class="token operator">&lt;-</span> cbind<span class="token punctuation">(</span>edge_lst<span class="token punctuation">,</span>vect_bind<span class="token punctuation">)</span>
  <span class="token keyword">for</span><span class="token punctuation">(</span>i <span class="token keyword">in</span> nrow<span class="token punctuation">(</span>edge_lst<span class="token punctuation">)</span><span class="token operator">:</span><span class="token number">1</span> <span class="token punctuation">)</span>
  <span class="token punctuation">{</span>
    <span class="token comment">#cat("del? \t",i,"\t",edge_lst[i,3])</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>edge_lst<span class="token punctuation">[</span>i<span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
      <span class="token comment">#cat("We sup\n")</span>
      edge_lst <span class="token operator">&lt;-</span> edge_lst<span class="token punctuation">[</span><span class="token operator">-</span>i<span class="token punctuation">,</span><span class="token punctuation">]</span>
    <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>
      <span class="token comment">#cat("\n")</span>
    <span class="token punctuation">}</span>

  <span class="token punctuation">}</span>
  edge_lst <span class="token operator">&lt;-</span> edge_lst<span class="token punctuation">[</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">3</span><span class="token punctuation">]</span>
  limited_graph <span class="token operator">&lt;-</span> graph_from_edgelist<span class="token punctuation">(</span>edge_lst<span class="token punctuation">,</span> directed <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">)</span>

  <span class="token comment"># cat("LIMITED ROW ",nrow(as_edgelist(limited_graph)),"Nbnode=",vcount(limited_graph) ,"\n")</span>
  <span class="token comment"># cat("UNLIMITED ROW ", nrow(as_edgelist(igraph)),"Nbnode=",vcount(limited_graph),"\n")</span>

  nb_node <span class="token operator">&lt;-</span> vcount<span class="token punctuation">(</span>igraph<span class="token punctuation">)</span>
  <span class="token keyword">for</span><span class="token punctuation">(</span> i <span class="token keyword">in</span> <span class="token number">1</span><span class="token operator">:</span> nb_node<span class="token punctuation">)</span>
  <span class="token punctuation">{</span>
    epi <span class="token operator">&lt;-</span> get.vertex.attribute<span class="token punctuation">(</span>igraph<span class="token punctuation">,</span><span class="token string">"epidemic"</span><span class="token punctuation">,</span> i <span class="token punctuation">)</span>
    itime <span class="token operator">&lt;-</span> get.vertex.attribute<span class="token punctuation">(</span>igraph<span class="token punctuation">,</span><span class="token string">"i_time"</span><span class="token punctuation">,</span> i <span class="token punctuation">)</span>
    limited_graph <span class="token operator">&lt;-</span> set.vertex.attribute<span class="token punctuation">(</span>limited_graph<span class="token punctuation">,</span><span class="token string">"epidemic"</span><span class="token punctuation">,</span> i <span class="token punctuation">,</span>value<span class="token operator">=</span>epi<span class="token punctuation">)</span>
    limited_graph <span class="token operator">&lt;-</span> set.vertex.attribute<span class="token punctuation">(</span>limited_graph<span class="token punctuation">,</span><span class="token string">"i_time"</span><span class="token punctuation">,</span> i <span class="token punctuation">,</span>value<span class="token operator">=</span>itime<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>

  <span class="token comment">#vertex_attr(limited_graph) &lt;- vertex_attr(igraph)</span>
  <span class="token comment"># cat("LIMITED ROW ",nrow(as_edgelist(limited_graph)),"Nbnode=",vcount(limited_graph) ,"\n")</span>
  <span class="token comment"># cat("UNLIMITED ROW ", nrow(as_edgelist(igraph)),"Nbnode=",vcount(limited_graph),"\n")</span>
  <span class="token comment"># print(vertex_attr(limited_graph))</span>
  <span class="token comment"># print("=====================")</span>
  <span class="token comment"># print(vertex_attr(igraph))</span>
  <span class="token comment">#epidemic_plot(igraph,"Unrestrited")</span>
  <span class="token comment">#epidemic_plot(igraph,"Restrited")</span>
  limited_graph
<span class="token punctuation">}</span>

confine_required <span class="token operator">&lt;-</span> <span class="token keyword">function</span><span class="token punctuation">(</span>igraph<span class="token punctuation">,</span>confinement_high<span class="token punctuation">,</span>confinement_low<span class="token punctuation">,</span>restrictions<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
  nb_node <span class="token operator">&lt;-</span> vcount<span class="token punctuation">(</span>igraph<span class="token punctuation">)</span>
  nb_i <span class="token operator">&lt;-</span> <span class="token number">0</span>
  <span class="token keyword">for</span><span class="token punctuation">(</span>i <span class="token keyword">in</span> <span class="token number">1</span><span class="token operator">:</span>nb_node<span class="token punctuation">)</span>
  <span class="token punctuation">{</span>
    node_status <span class="token operator">&lt;-</span> get.vertex.attribute<span class="token punctuation">(</span>igraph<span class="token punctuation">,</span><span class="token string">"epidemic"</span><span class="token punctuation">,</span> i<span class="token punctuation">)</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span> node_status <span class="token operator">==</span> <span class="token string">"i"</span> <span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
      nb_i <span class="token operator">&lt;-</span> nb_i<span class="token operator">+</span><span class="token number">1</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">if</span><span class="token punctuation">(</span>restrictions <span class="token operator">==</span> <span class="token boolean">FALSE</span><span class="token punctuation">)</span>
  <span class="token punctuation">{</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>nb_i <span class="token operator">&gt;</span> confinement_high<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
      restrictions <span class="token operator">&lt;-</span> <span class="token boolean">TRUE</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span> restrictions <span class="token operator">==</span> <span class="token boolean">TRUE</span> <span class="token punctuation">)</span>
  <span class="token punctuation">{</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span> nb_i <span class="token operator">&lt;</span> confinement_low <span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
      restrictions <span class="token operator">&lt;-</span> <span class="token boolean">FALSE</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
  <span class="token comment"># cat("Nb of infected people:",nb_i,"\n")</span>
  <span class="token comment"># cat("Contact limitation ? ",restrictions,"\n")</span>
  restrictions
<span class="token punctuation">}</span>


R0_calc <span class="token operator">&lt;-</span> <span class="token keyword">function</span><span class="token punctuation">(</span>result_mat<span class="token punctuation">,</span>nb_node<span class="token punctuation">,</span> n_d<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
  nb_day <span class="token operator">&lt;-</span> ncol<span class="token punctuation">(</span>result_mat<span class="token punctuation">)</span>
  gam <span class="token operator">&lt;-</span> <span class="token number">1</span><span class="token operator">/</span>n_d
  outmat <span class="token operator">&lt;-</span> matrix<span class="token punctuation">(</span>nrow <span class="token operator">=</span> <span class="token number">6</span><span class="token punctuation">,</span> ncol <span class="token operator">=</span> nb_day<span class="token punctuation">)</span>

  x <span class="token operator">&lt;-</span> result_mat<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token punctuation">]</span><span class="token operator">/</span>nb_node
  s <span class="token operator">&lt;-</span> result_mat<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token punctuation">]</span><span class="token operator">/</span>nb_node
  r <span class="token operator">&lt;-</span> result_mat<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token punctuation">]</span><span class="token operator">/</span>nb_node

  d_x <span class="token operator">&lt;-</span> vector<span class="token punctuation">(</span>mode <span class="token operator">=</span> <span class="token string">"numeric"</span><span class="token punctuation">,</span>nb_day<span class="token punctuation">)</span>
  d_s <span class="token operator">&lt;-</span> vector<span class="token punctuation">(</span>mode <span class="token operator">=</span> <span class="token string">"numeric"</span><span class="token punctuation">,</span>nb_day<span class="token punctuation">)</span>
  d_r <span class="token operator">&lt;-</span> vector<span class="token punctuation">(</span>mode <span class="token operator">=</span> <span class="token string">"numeric"</span><span class="token punctuation">,</span>nb_day<span class="token punctuation">)</span>
  beta <span class="token operator">&lt;-</span> vector<span class="token punctuation">(</span>mode <span class="token operator">=</span> <span class="token string">"numeric"</span><span class="token punctuation">,</span>nb_day<span class="token punctuation">)</span>
  gamma <span class="token operator">&lt;-</span> vector<span class="token punctuation">(</span>mode <span class="token operator">=</span> <span class="token string">"numeric"</span><span class="token punctuation">,</span>nb_day<span class="token punctuation">)</span>
  <span class="token keyword">for</span><span class="token punctuation">(</span>i <span class="token keyword">in</span> <span class="token number">2</span><span class="token operator">:</span>nb_day <span class="token punctuation">)</span>
  <span class="token punctuation">{</span>
    d_x<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">&lt;-</span> x<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">-</span> x<span class="token punctuation">[</span>i<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span>
    d_s<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">&lt;-</span> s<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">-</span> s<span class="token punctuation">[</span>i<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span>
    d_r<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">&lt;-</span> r<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">-</span> r<span class="token punctuation">[</span>i<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">for</span><span class="token punctuation">(</span>i <span class="token keyword">in</span> <span class="token number">2</span><span class="token operator">:</span>nb_day <span class="token punctuation">)</span>
  <span class="token punctuation">{</span>
    beta<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">&lt;-</span> d_s<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">/</span><span class="token punctuation">(</span>s<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">*</span>x<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
  print<span class="token punctuation">(</span>beta<span class="token operator">/</span><span class="token number">0.1</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

n <span class="token operator">&lt;-</span> <span class="token number">2000</span>
p <span class="token operator">&lt;-</span> <span class="token number">0.01</span>

p_epidemic <span class="token operator">&lt;-</span> <span class="token number">0.01</span>
time <span class="token operator">&lt;-</span> <span class="token number">70</span>

n_0 <span class="token operator">&lt;-</span> <span class="token number">10</span>
n_d <span class="token operator">&lt;-</span> <span class="token number">10</span>

travel_limitation <span class="token operator">&lt;-</span> <span class="token boolean">FALSE</span>
confinement_high <span class="token operator">&lt;-</span> <span class="token number">50</span>
confinement_low <span class="token operator">&lt;-</span> <span class="token number">10</span>
restriction_percentages <span class="token operator">&lt;-</span> <span class="token number">80</span>


false_negatives_before4 <span class="token operator">&lt;-</span> <span class="token number">0.6</span>
false_negatives_after4 <span class="token operator">&lt;-</span> <span class="token number">.2</span>
asymptomatic_proba <span class="token operator">&lt;-</span> <span class="token number">0.2</span>

ig <span class="token operator">&lt;-</span> Erdos_Renyi_optimized<span class="token punctuation">(</span>n<span class="token punctuation">,</span>p<span class="token punctuation">)</span>
cat<span class="token punctuation">(</span><span class="token string">"Erdos Renyi created\n"</span><span class="token punctuation">)</span>
ig <span class="token operator">&lt;-</span> init_epidemic<span class="token punctuation">(</span>ig<span class="token punctuation">,</span>n_0<span class="token punctuation">,</span>n_d<span class="token punctuation">)</span>
<span class="token comment">#epidemic_plot(ig,"Day One")</span>
cat<span class="token punctuation">(</span><span class="token string">"Infection initialized \n"</span><span class="token punctuation">)</span>
res <span class="token operator">&lt;-</span> simulation<span class="token punctuation">(</span>ig<span class="token punctuation">,</span>p_epidemic<span class="token punctuation">,</span>n_d<span class="token punctuation">,</span>time<span class="token punctuation">,</span>confinement_high<span class="token punctuation">,</span>confinement_low<span class="token punctuation">,</span>restriction_percentages<span class="token punctuation">,</span>travel_limitation<span class="token punctuation">,</span>false_negatives_before4<span class="token punctuation">,</span>false_negatives_after4<span class="token punctuation">)</span>
plot_epidemic_curves<span class="token punctuation">(</span><span class="token number">100</span><span class="token operator">*</span>res<span class="token operator">/</span>n<span class="token punctuation">,</span>time<span class="token punctuation">)</span>

<span class="token comment"># transmis &lt;- transmission(ig,p_epidemic,n_d)</span>
<span class="token comment"># epidemic_plot(transmis,"Day 2")</span>
<span class="token comment"># transmis &lt;- transmission(transmis,p_epidemic,n_d)</span>
<span class="token comment"># epidemic_plot(transmis,"Day 3")</span>
<span class="token comment">#R0_calc(res,n,n_d)</span>
<span class="token comment">#res &lt;- res*100/n</span>
<span class="token comment">#print(res)</span>
<span class="token comment">#plot_epidemic_curves(res,time)</span>
</code></pre><p>And the unexpected results:</p><p><img src="/assets/test_everybpody.0bddf6d1.png" alt=""></p><p>The scenario B seem more performant than to test only symptomatic people.</p></div><div class="buttonsSection" data-v-7aa07aa5=""><a href="/complexSystem/epidemicModels/404" class="nextButton btn true" double="true" data-v-7aa07aa5="" data-v-5e18b108=""><div class="nextText" data-v-5e18b108=""><label data-v-5e18b108="">Next</label><h3 data-v-5e18b108="">Go further: Real data input</h3></div><svg width="1.2em" height="1.2em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 24 24" class="arrow" data-v-5e18b108=""><g fill="none"><path d="M4 12h16" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path><path d="M13 5l7 7l-7 7" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path></g></svg></a><a href="/complexSystem/epidemicModels/effectOfConfinePeople" class="prevButton btn true" double="true" data-v-7aa07aa5="" data-v-5e18b108=""><svg width="1.2em" height="1.2em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 24 24" class="arrow" data-v-5e18b108=""><g fill="none"><path d="M11 5l-7 7l7 7" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path><path d="M4 12h16" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path></g></svg><div class="prevText" data-v-5e18b108=""><label data-v-5e18b108="">Previous</label><h3 data-v-5e18b108="">Effect of confine people</h3></div></a></div></div></div></main></div><script>window.__INITIAL_STATE__='{"pinia":{}}'</script><link rel="stylesheet" href="/assets/app.c3121e54.css"><link rel="stylesheet" href="/assets/ButtonSection.5de0d717.css"><link rel="stylesheet" href="/katex.min.css"></body></html>