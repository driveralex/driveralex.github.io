<!DOCTYPE html><html lang="en"><head><link rel="preconnect" href="https://fonts.gstatic.com/" crossorigin=""><link rel="preload" as="style" onload='this.rel="stylesheet"' href="https://fonts.googleapis.com/css2?family=Source Sans Pro&amp;family=Rubik&amp;family=B612 Mono&amp;display=swap"><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1"><link rel="icon" href="/favicon.svg" type="image/svg+xml"><link rel="apple-touch-icon" href="/pwa-192x192.png"><link rel="mask-icon" href="/safari-pinned-tab.svg" color="#00aba9"><!--   <link rel="preload" href="/fonts/KaTeX_Main-Regular.woff2" type="text/css" onload="this.rel='stylesheet'">
   <link rel="preload" href="/fonts/KaTeX_Math-Italic.woff2" as="style" onload="this.rel='stylesheet'">
     <link rel="preload" as="font" href="./fonts/Urbanist/Urbanist-Regular.ttf" type="font/woff2"> --><style>@font-face{font-family:KaTeX_Main;font-style:normal;font-weight:700;src:url(fonts/KaTeX_Main-Bold.woff2) format("woff2"),url(fonts/KaTeX_Main-Bold.woff) format("woff"),url(fonts/KaTeX_Main-Bold.ttf) format("truetype")}@font-face{font-family:KaTeX_Main;font-style:italic;font-weight:700;src:url(fonts/KaTeX_Main-BoldItalic.woff2) format("woff2"),url(fonts/KaTeX_Main-BoldItalic.woff) format("woff"),url(fonts/KaTeX_Main-BoldItalic.ttf) format("truetype")}@font-face{font-family:KaTeX_Main;font-style:italic;font-weight:400;src:url(fonts/KaTeX_Main-Italic.woff2) format("woff2"),url(fonts/KaTeX_Main-Italic.woff) format("woff"),url(fonts/KaTeX_Main-Italic.ttf) format("truetype")}@font-face{font-family:KaTeX_Main;font-style:normal;font-weight:400;src:url(fonts/KaTeX_Main-Regular.woff2) format("woff2"),url(fonts/KaTeX_Main-Regular.woff) format("woff"),url(fonts/KaTeX_Main-Regular.ttf) format("truetype")}@font-face{font-family:KaTeX_Math;font-style:italic;font-weight:700;src:url(fonts/KaTeX_Math-BoldItalic.woff2) format("woff2"),url(fonts/KaTeX_Math-BoldItalic.woff) format("woff"),url(fonts/KaTeX_Math-BoldItalic.ttf) format("truetype")}@font-face{font-family:KaTeX_Math;font-style:italic;font-weight:400;src:url(fonts/KaTeX_Math-Italic.woff2) format("woff2"),url(fonts/KaTeX_Math-Italic.woff) format("woff"),url(fonts/KaTeX_Math-Italic.ttf) format("truetype")}@font-face{font-family:KaTeX_Size4;font-style:normal;font-weight:400;src:url(fonts/KaTeX_Size4-Regular.woff2) format("woff2"),url(fonts/KaTeX_Size4-Regular.woff) format("woff"),url(fonts/KaTeX_Size4-Regular.ttf) format("truetype")}.katex{text-rendering:auto;font:normal 1.21em KaTeX_Main,Times New Roman,serif;line-height:1.2;text-indent:0}.katex *{-ms-high-contrast-adjust:none!important;border-color:currentColor}.katex .katex-mathml{clip:rect(1px,1px,1px,1px);border:0;height:1px;overflow:hidden;padding:0;position:absolute;width:1px}.katex .base{position:relative;white-space:nowrap;width:-webkit-min-content;width:-moz-min-content;width:min-content}.katex .base,.katex .strut{display:inline-block}.katex .mathnormal{font-family:KaTeX_Math;font-style:italic}.katex .vlist-t{border-collapse:collapse;display:inline-table;table-layout:fixed}.katex .vlist-r{display:table-row}.katex .vlist{display:table-cell;position:relative;vertical-align:bottom}.katex .vlist>span{display:block;height:0;position:relative}.katex .vlist>span>span{display:inline-block}.katex .vlist>span>.pstrut{overflow:hidden;width:0}.katex .vlist-t2{margin-right:-2px}.katex .vlist-s{display:table-cell;font-size:1px;min-width:2px;vertical-align:bottom;width:2px}.katex .msupsub{text-align:left}.katex .mfrac>span>span{text-align:center}.katex .mfrac .frac-line{border-bottom-style:solid;display:inline-block;width:100%}.katex .mfrac .frac-line{min-height:1px}.katex .mspace{display:inline-block}.katex .sizing.reset-size6.size3{font-size:.7em}.katex .delimsizing.mult .delim-size4>span{font-family:KaTeX_Size4}.katex .nulldelimiter{display:inline-block;width:.12em}.katex .mtable .arraycolsep{display:inline-block}.katex .mtable .col-align-l>.vlist-t{text-align:left}.katex svg{fill:currentColor;stroke:currentColor;fill-rule:nonzero;fill-opacity:1;stroke-width:1;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;stroke-opacity:1;display:block;height:inherit;position:absolute;width:100%}.katex svg path{stroke:none}.katex-display{display:block;margin:1em 0;text-align:center}.katex-display>.katex{display:block;text-align:center;white-space:nowrap}.katex-display>.katex>.katex-html{display:block;position:relative}body{counter-reset:katexEqnNo mmlEqnNo}.container[data-v-2966c002]{width:100%}.mainSection[data-v-2966c002]{display:flex;flex-direction:row;justify-content:space-between;align-items:center;width:100%;color:#fff;font-weight:600;cursor:pointer;text-align:start;z-index:10}.mainSection .mainText[data-v-2966c002]{margin:1rem;cursor:pointer}.mainSection .mainArrow[data-v-2966c002]{margin:1rem}.mainSection .closesub[data-v-2966c002]{transform:rotate(0);transition:transform ease-in-out .3s}.mainSection[data-v-2966c002]:hover{background-color:#303233}html:not(.dark) .mainSection[data-v-2966c002]{color:#000}html:not(.dark) .mainSection[data-v-2966c002]:hover{background-color:#bbc3c9}.normal[data-v-2966c002]{border-left:#242526 .25rem solid}.normal[data-v-2966c002]:hover{border-left:#303233 .25rem solid}html:not(.dark) .normal[data-v-2966c002]{border-left:#adb6be .25rem solid}html:not(.dark) .normal[data-v-2966c002]:hover{border-left:#bbc3c9 .25rem solid}.lasum[data-v-2966c002]{flex-direction:column;color:#fff;margin-left:1rem;flex-wrap:wrap;text-align:start;padding:.8rem}.lasum[data-v-2966c002]:hover{background-color:#303233}html:not(.dark) .lasum[data-v-2966c002]{color:#000}html:not(.dark) .lasum[data-v-2966c002]:hover{background-color:#bbc3c9}.closesubs[data-v-2966c002]{display:none}.normalSub[data-v-2966c002]{color:#d3d3d3}html:not(.dark) .normalSub[data-v-2966c002]{color:#353b3d}.normalSubs[data-v-2966c002]{border-left:solid 1px #fff}html:not(.dark) .normalSubs[data-v-2966c002]{border-left:solid #353b3d 1px}[data-simplebar]{position:relative;flex-direction:column;flex-wrap:wrap;justify-content:flex-start;align-content:flex-start;align-items:flex-start}.navcontainer[data-v-90ec57cc]{display:flex;flex-direction:column;width:100%;background:#242526;align-items:center}html:not(.dark) .navcontainer[data-v-90ec57cc]{background:#adb6be}.tree[data-v-90ec57cc]{display:flex;flex-direction:column;width:100%;overflow-y:auto;overflow-x:hidden}.footnav[data-v-90ec57cc]{display:flex;flex-direction:row;justify-content:center;align-items:center;padding:1rem;color:#fff;border-top:1px solid #808486}html:not(.dark) .footnav[data-v-90ec57cc]{color:#000;border-top:1px solid #5a5c5e}.headnav[data-v-90ec57cc]{display:grid;grid-template-columns:25% 50% 25%;grid-template-rows:auto;justify-items:center;align-items:center;margin:1.5rem 1rem 1rem;width:100%;font-weight:900;font-size:1.3rem}.headnav .mainIcon[data-v-90ec57cc]{height:100%;width:100%;transform:scale(1);color:#039be5}.headnav p[data-v-90ec57cc]{padding:0;font-size:1.4rem;white-space:nowrap}.themeToggle[data-v-092b0483]{transform:scale(1.2)}.test[data-v-a0229b55]{color:#039be5}@keyframes translateOut-a0229b55{90%{display:none}to{transform:translate(-100%);opacity:0}}.navhidden[data-v-a0229b55]{display:none}@media (max-width:1024px){.navhidden[data-v-a0229b55]{display:flex;max-width:100vw;position:absolute;top:3.95rem;opacity:1;z-index:1;animation:translateOut-a0229b55 .5s ease-in-out forwards}}main[data-v-a0229b55]{display:flex;flex-direction:column;height:max-content}.mynavTree[data-v-a0229b55]{align-self:stretch;max-height:100vh;max-width:20%;font-family:Rubik}@media (max-width:1024px){.mynavTree[data-v-a0229b55]{display:none}}.routeVue[data-v-a0229b55]{display:flex;height:100vh;overflow-y:auto;padding:2rem 3rem;width:100vw;font-family:Source Sans Pro}@media (max-width:1024px){.routeVue[data-v-a0229b55]{padding:.4rem .6rem}}.topPage[data-v-a0229b55]{display:flex;flex-direction:row;height:max-content;justify-content:center;align-items:stretch;box-sizing:border-box}@media (max-width:1024px){.topPage[data-v-a0229b55]{flex-direction:column;max-height:100vh}}.headerfull[data-v-a0229b55]{background:#242526;display:none;color:#039be5}@media (max-width:1024px){.headerfull[data-v-a0229b55]{display:flex;flex-direction:row;padding:1rem;align-items:center;justify-content:flex-start}}.headerfull h1[data-v-a0229b55]{margin-left:2rem;font-weight:700;font-size:1.3rem;color:#fff}.headerfull span[data-v-a0229b55]{display:flex;align-items:center;justify-content:center;color:#fff}html:not(.dark) .headerfull[data-v-a0229b55]{background:#adb6be}html:not(.dark) .headerfull h1[data-v-a0229b55]{color:#000}html:not(.dark) .headerfull span[data-v-a0229b55]{color:#000}.themeToggle[data-v-a0229b55]{display:block;position:absolute;top:0;right:0;margin:1rem;z-index:10}*,:after,:before{box-sizing:border-box;border-width:0;border-style:solid;border-color:#e5e7eb}html{line-height:1.5;-webkit-text-size-adjust:100%;-moz-tab-size:4;tab-size:4;font-family:ui-sans-serif,system-ui,-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,Noto Sans,sans-serif,"Apple Color Emoji","Segoe UI Emoji",Segoe UI Symbol,"Noto Color Emoji"}body{margin:0;line-height:inherit}h1{font-size:inherit;font-weight:inherit}a{color:inherit;text-decoration:inherit}code,pre{font-family:ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,Liberation Mono,Courier New,monospace;font-size:1em}button{font-family:inherit;font-size:100%;font-weight:inherit;line-height:inherit;color:inherit;margin:0;padding:0}button{text-transform:none}button{-webkit-appearance:button;background-color:transparent;background-image:none}h1,p,pre{margin:0}button{cursor:pointer}img,svg{display:block;vertical-align:middle}img{max-width:100%;height:auto}.prose{max-width:90ch!important;width:100%}.prose pre:not(.shiki){padding:0}.prose .shiki{font-family:DM Mono,monospace;font-size:1.2em;line-height:1.4}.prose img{width:100%}.shiki-light{background:#f8f8f8!important}.shiki-dark{background:#0e0e0e!important}html:not(.dark) .shiki-dark{display:none}code{counter-reset:step;counter-increment:step 0}code .line:before{content:counter(step);counter-increment:step;width:1rem;margin-right:1.5rem;display:inline-block;text-align:right;color:#738a9466}code[class*=language-]{color:#f8f8f2;background:0 0;font-family:Consolas,Monaco,Andale Mono,Ubuntu Mono,monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none}#app,body,html{height:100%;margin:0;padding:0}img{padding:0 1rem}*,::after,::before{--un-rotate:0;--un-rotate-x:0;--un-rotate-y:0;--un-rotate-z:0;--un-scale-x:1;--un-scale-y:1;--un-scale-z:1;--un-skew-x:0;--un-skew-y:0;--un-translate-x:0;--un-translate-y:0;--un-translate-z:0;--un-scroll-snap-strictness:proximity;--un-border-spacing-x:0;--un-border-spacing-y:0;--un-ring-offset-shadow:0 0 rgba(0,0,0,0);--un-ring-shadow:0 0 rgba(0,0,0,0);--un-shadow:0 0 rgba(0,0,0,0);--un-ring-offset-width:0px;--un-ring-offset-color:#fff;--un-ring-width:0px;--un-ring-color:rgba(147,197,253,0.5)}.i-carbon-moon{--un-icon:url("data:image/svg+xml;utf8,%3Csvg preserveAspectRatio='xMidYMid meet' viewBox='0 0 32 32' width='1.2em' height='1.2em' xmlns='http://www.w3.org/2000/svg' %3E%3Cpath fill='currentColor' d='M13.502 5.414a15.075 15.075 0 0 0 11.594 18.194a11.113 11.113 0 0 1-7.975 3.39c-.138 0-.278.005-.418 0a11.094 11.094 0 0 1-3.2-21.584M14.98 3a1.002 1.002 0 0 0-.175.016a13.096 13.096 0 0 0 1.825 25.981c.164.006.328 0 .49 0a13.072 13.072 0 0 0 10.703-5.555a1.01 1.01 0 0 0-.783-1.565A13.08 13.08 0 0 1 15.89 4.38A1.015 1.015 0 0 0 14.98 3Z'/%3E%3C/svg%3E");mask:var(--un-icon) no-repeat;mask-size:100% 100%;-webkit-mask:var(--un-icon) no-repeat;-webkit-mask-size:100% 100%;background-color:currentColor;width:1.2em;height:1.2em}.i-akar-icons\:chevron-right{--un-icon:url("data:image/svg+xml;utf8,%3Csvg preserveAspectRatio='xMidYMid meet' viewBox='0 0 24 24' width='1.2em' height='1.2em' xmlns='http://www.w3.org/2000/svg' %3E%3Cpath fill='none' stroke='currentColor' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' d='m8 4l8 8l-8 8'/%3E%3C/svg%3E");mask:var(--un-icon) no-repeat;mask-size:100% 100%;-webkit-mask:var(--un-icon) no-repeat;-webkit-mask-size:100% 100%;background-color:currentColor;width:1.2em;height:1.2em}.i-carbon-sun{--un-icon:url("data:image/svg+xml;utf8,%3Csvg preserveAspectRatio='xMidYMid meet' viewBox='0 0 32 32' width='1.2em' height='1.2em' xmlns='http://www.w3.org/2000/svg' %3E%3Cpath fill='currentColor' d='M16 12.005a4 4 0 1 1-4 4a4.005 4.005 0 0 1 4-4m0-2a6 6 0 1 0 6 6a6 6 0 0 0-6-6ZM5.394 6.813L6.81 5.399l3.505 3.506L8.9 10.319zM2 15.005h5v2H2zm3.394 10.193L8.9 21.692l1.414 1.414l-3.505 3.506zM15 25.005h2v5h-2zm6.687-1.9l1.414-1.414l3.506 3.506l-1.414 1.414zm3.313-8.1h5v2h-5zm-3.313-6.101l3.506-3.506l1.414 1.414l-3.506 3.506zM15 2.005h2v5h-2z'/%3E%3C/svg%3E");mask:var(--un-icon) no-repeat;mask-size:100% 100%;-webkit-mask:var(--un-icon) no-repeat;-webkit-mask-size:100% 100%;background-color:currentColor;width:1.2em;height:1.2em}.i-carbon\:network-4,[i-carbon\:network-4=""]{--un-icon:url("data:image/svg+xml;utf8,%3Csvg preserveAspectRatio='xMidYMid meet' viewBox='0 0 32 32' width='1.2em' height='1.2em' xmlns='http://www.w3.org/2000/svg' %3E%3Ccircle cx='21' cy='26' r='2' fill='currentColor'/%3E%3Ccircle cx='21' cy='6' r='2' fill='currentColor'/%3E%3Ccircle cx='4' cy='16' r='2' fill='currentColor'/%3E%3Cpath fill='currentColor' d='M28 12a3.996 3.996 0 0 0-3.858 3h-4.284a3.966 3.966 0 0 0-5.491-2.643l-3.177-3.97A3.963 3.963 0 0 0 12 6a4 4 0 1 0-4 4a3.96 3.96 0 0 0 1.634-.357l3.176 3.97a3.924 3.924 0 0 0 0 4.774l-3.176 3.97A3.96 3.96 0 0 0 8 22a4 4 0 1 0 4 4a3.962 3.962 0 0 0-.81-2.387l3.176-3.97A3.966 3.966 0 0 0 19.858 17h4.284A3.993 3.993 0 1 0 28 12ZM6 6a2 2 0 1 1 2 2a2.002 2.002 0 0 1-2-2Zm2 22a2 2 0 1 1 2-2a2.002 2.002 0 0 1-2 2Zm8-10a2 2 0 1 1 2-2a2.002 2.002 0 0 1-2 2Zm12 0a2 2 0 1 1 2-2a2.002 2.002 0 0 1-2 2Z'/%3E%3C/svg%3E");mask:var(--un-icon) no-repeat;mask-size:100% 100%;-webkit-mask:var(--un-icon) no-repeat;-webkit-mask-size:100% 100%;background-color:currentColor;width:1.2em;height:1.2em}.i-carbon\:search{--un-icon:url("data:image/svg+xml;utf8,%3Csvg preserveAspectRatio='xMidYMid meet' viewBox='0 0 32 32' width='1.2em' height='1.2em' xmlns='http://www.w3.org/2000/svg' %3E%3Cpath fill='currentColor' d='m29 27.586l-7.552-7.552a11.018 11.018 0 1 0-1.414 1.414L27.586 29ZM4 13a9 9 0 1 1 9 9a9.01 9.01 0 0 1-9-9Z'/%3E%3C/svg%3E");mask:var(--un-icon) no-repeat;mask-size:100% 100%;-webkit-mask:var(--un-icon) no-repeat;-webkit-mask-size:100% 100%;background-color:currentColor;width:1.2em;height:1.2em}.i-logos-vue{background:url("data:image/svg+xml;utf8,%3Csvg preserveAspectRatio='xMidYMid meet' viewBox='0 0 256 221' width='1.2em' height='1.2em' xmlns='http://www.w3.org/2000/svg' %3E%3Cpath fill='%2341B883' d='M204.8 0H256L128 220.8L0 0h97.92L128 51.2L157.44 0h47.36Z'/%3E%3Cpath fill='%2341B883' d='m0 0l128 220.8L256 0h-51.2L128 132.48L50.56 0H0Z'/%3E%3Cpath fill='%2335495E' d='M50.56 0L128 133.12L204.8 0h-47.36L128 51.2L97.92 0H50.56Z'/%3E%3C/svg%3E") no-repeat;background-size:100% 100%;background-color:transparent;width:1.2em;height:1.2em}.i-noto\:red-heart{background:url("data:image/svg+xml;utf8,%3Csvg preserveAspectRatio='xMidYMid meet' viewBox='0 0 128 128' width='1.2em' height='1.2em' xmlns='http://www.w3.org/2000/svg' %3E%3Cpath fill='%23F44336' d='M93.99 8.97c-21.91 0-29.96 22.39-29.96 22.39s-7.94-22.39-30-22.39c-16.58 0-35.48 13.14-28.5 43.01c6.98 29.87 58.56 67.08 58.56 67.08s51.39-37.21 58.38-67.08c6.98-29.87-10.56-43.01-28.48-43.01z'/%3E%3Cpath fill='%23C33' d='M30.65 11.2c17.2 0 25.74 18.49 28.5 25.98c.39 1.07 1.88 1.1 2.33.06L64 31.35C60.45 20.01 50.69 8.97 34.03 8.97c-6.9 0-14.19 2.28-19.86 7.09c5.01-3.29 10.88-4.86 16.48-4.86zm63.34-2.23c-5.29 0-10.11 1.15-13.87 3.47c2.64-1.02 5.91-1.24 9.15-1.24c16.21 0 30.72 12.29 24.17 40.7c-5.62 24.39-38.46 53.98-48.49 65.27c-.64.72-.86 1.88-.86 1.88s51.39-37.21 58.38-67.08c6.98-29.86-10.53-43-28.48-43z'/%3E%3Cpath fill='%23FF8A80' d='M17.04 24.82c3.75-4.68 10.45-8.55 16.13-4.09c3.07 2.41 1.73 7.35-1.02 9.43c-4 3.04-7.48 4.87-9.92 9.63c-1.46 2.86-2.34 5.99-2.79 9.18c-.18 1.26-1.83 1.57-2.45.46c-4.22-7.48-5.42-17.78.05-24.61zm60.12 9.84c-1.76 0-3-1.7-2.36-3.34c1.19-3.02 2.73-5.94 4.58-8.54c2.74-3.84 7.95-6.08 11.25-3.75c3.38 2.38 2.94 7.14.57 9.44c-5.09 4.93-11.51 6.19-14.04 6.19z'/%3E%3C/svg%3E") no-repeat;background-size:100% 100%;background-color:transparent;width:1.2em;height:1.2em}.i-radix-icons\:hamburger-menu{--un-icon:url("data:image/svg+xml;utf8,%3Csvg preserveAspectRatio='xMidYMid meet' viewBox='0 0 15 15' width='1.2em' height='1.2em' xmlns='http://www.w3.org/2000/svg' %3E%3Cpath fill='currentColor' fill-rule='evenodd' d='M1.5 3a.5.5 0 0 0 0 1h12a.5.5 0 0 0 0-1h-12ZM1 7.5a.5.5 0 0 1 .5-.5h12a.5.5 0 0 1 0 1h-12a.5.5 0 0 1-.5-.5Zm0 4a.5.5 0 0 1 .5-.5h12a.5.5 0 0 1 0 1h-12a.5.5 0 0 1-.5-.5Z' clip-rule='evenodd'/%3E%3C/svg%3E");mask:var(--un-icon) no-repeat;mask-size:100% 100%;-webkit-mask:var(--un-icon) no-repeat;-webkit-mask-size:100% 100%;background-color:currentColor;width:1.2em;height:1.2em}.prose :where(h1,h2,h3,h4,h5,h6):not(:where(.not-prose,.not-prose*)){color:var(--un-prose-headings);font-weight:600;line-height:1.25}.prose :where(a):not(:where(.not-prose,.not-prose*)){color:var(--un-prose-links);text-decoration:underline;font-weight:500}.prose :where(p,ul,ol,pre):not(:where(.not-prose,.not-prose*)){margin:1em 0;line-height:1.75}.prose :where(h1):not(:where(.not-prose,.not-prose*)){margin:1rem 0;font-size:2.25em}.prose :where(img,video):not(:where(.not-prose,.not-prose*)){max-width:100%}.prose :where(code):not(:where(.not-prose,.not-prose*)){color:var(--un-prose-code);font-size:.875em;font-weight:600;font-family:var(--un-prose-font-mono)}.prose :where(pre):not(:where(.not-prose,.not-prose*)){padding:1.25rem 1.5rem;overflow-x:auto;border-radius:.375rem}.prose :where(pre,code):not(:where(.not-prose,.not-prose*)){white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;hyphens:none;background:0 0}.prose :where(precode):not(:where(.not-prose,.not-prose*)){font-weight:inherit}.prose{color:var(--un-prose-body);max-width:65ch}.container{max-width:100%}@media (min-width:640px){.container{max-width:640px}}@media (min-width:768px){.container{max-width:768px}}@media (min-width:1024px){.container{max-width:1024px}}@media (min-width:1280px){.container{max-width:1280px}}@media (min-width:1536px){.container{max-width:1536px}}.m-auto{margin:auto}[mx-1rem=""]{margin-left:1rem;margin-right:1rem}[inline-block=""]{display:inline-block}.px-xl{padding-left:1.25rem;padding-right:1.25rem}.text-left{text-align:left}[color~="\#00aba9"]{--un-text-opacity:1;color:rgba(0,171,169,var(--un-text-opacity))}.text-gray-700{--un-text-opacity:1;color:rgba(55,65,81,var(--un-text-opacity))}</style><link rel="preload" href="/katex.min.css" as="style"><script src="/markdown-it.min.js"></script><script src="/wasm_exec.js"></script><!-- <script src="/wasm_import.js"></script> --><!--  https://cdn.jsdelivr.net/npm/markdown-it-texmath/texmath.min.js  --><meta name="msapplication-TileColor" content="#00aba9"><meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"><meta name="theme-color" content="#039be5"><!-- Global site tag (gtag.js) - Google Analytics --><!-- <script async src="https://www.googletagmanager.com/gtag/js?id=G-V1N5Q8L1GV"></>
    <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'G-V1N5Q8L1GV');
  </script> --><script>!function(){var e=window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches,t=localStorage.getItem("vueuse-color-scheme")||"auto";("dark"===t||e&&"light"!==t)&&document.documentElement.classList.toggle("dark",!0)}()</script><script type="module" async="" crossorigin="" src="/assets/app.058cc115.js"></script><link rel="preload" href="/assets/index.436e7bc5.css" as="style"><link rel="manifest" href="/manifest.webmanifest"><link rel="modulepreload" crossorigin="" href="/assets/implementation.e959774b.js"><title>Driveralex</title><meta name="description" content="Just driveralex website"><meta name="theme-color" content="#ffffff"><link rel="icon" type="image/svg+xml" href="/favicon.svg"><meta name="head:count" content="3"><link rel="preload" as="font" crossorigin="anonymous" href="fonts/KaTeX_AMS-Regular.woff2"><link rel="preload" as="font" crossorigin="anonymous" href="fonts/KaTeX_Caligraphic-Bold.woff2"><link rel="preload" as="font" crossorigin="anonymous" href="fonts/KaTeX_Caligraphic-Regular.woff2"><link rel="preload" as="font" crossorigin="anonymous" href="fonts/KaTeX_Fraktur-Bold.woff2"><link rel="preload" as="font" crossorigin="anonymous" href="fonts/KaTeX_Fraktur-Regular.woff2"><link rel="preload" as="font" crossorigin="anonymous" href="fonts/KaTeX_Main-Bold.woff2"><link rel="preload" as="font" crossorigin="anonymous" href="fonts/KaTeX_Main-BoldItalic.woff2"><link rel="preload" as="font" crossorigin="anonymous" href="fonts/KaTeX_Main-Italic.woff2"><link rel="preload" as="font" crossorigin="anonymous" href="fonts/KaTeX_Main-Regular.woff2"><link rel="preload" as="font" crossorigin="anonymous" href="fonts/KaTeX_Math-BoldItalic.woff2"><link rel="preload" as="font" crossorigin="anonymous" href="fonts/KaTeX_Math-Italic.woff2"><link rel="preload" as="font" crossorigin="anonymous" href="fonts/KaTeX_SansSerif-Bold.woff2"><link rel="preload" as="font" crossorigin="anonymous" href="fonts/KaTeX_SansSerif-Italic.woff2"><link rel="preload" as="font" crossorigin="anonymous" href="fonts/KaTeX_SansSerif-Regular.woff2"><link rel="preload" as="font" crossorigin="anonymous" href="fonts/KaTeX_Script-Regular.woff2"><link rel="preload" as="font" crossorigin="anonymous" href="fonts/KaTeX_Size1-Regular.woff2"><link rel="preload" as="font" crossorigin="anonymous" href="fonts/KaTeX_Size2-Regular.woff2"><link rel="preload" as="font" crossorigin="anonymous" href="fonts/KaTeX_Size3-Regular.woff2"><link rel="preload" as="font" crossorigin="anonymous" href="fonts/KaTeX_Size4-Regular.woff2"><link rel="preload" as="font" crossorigin="anonymous" href="fonts/KaTeX_Typewriter-Regular.woff2"><link rel="preload" as="font" crossorigin="anonymous" href="/fonts/Urbanist/Urbanist-Regular.woff2"><link rel="preload" as="font" crossorigin="anonymous" href="https://fonts.gstatic.com/s/dmmono/v10/aFTU7PB1QTsUX8KYhh0.ttf"><link rel="preload" as="font" crossorigin="anonymous" href="https://fonts.gstatic.com/s/dmsans/v11/rP2Hp2ywxg089UriOZQ.ttf"><link rel="preload" as="font" crossorigin="anonymous" href="https://fonts.gstatic.com/s/dmserifdisplay/v10/-nFnOHM81r4j6k0gjAW3mujVU2B2K_c.ttf"></head><body><div id="app" data-server-rendered="true"><main class="text-gray-700 dark:text-gray-200" data-v-a0229b55=""><div class="topPage" data-v-a0229b55=""><button class="themeToggle" data-v-a0229b55="" data-v-092b0483=""><div style="" class="i-carbon-moon" data-v-092b0483=""></div><div style="display:none" class="i-carbon-sun" data-v-092b0483=""></div></button><div class="navcontainer mynavTree" data-v-a0229b55="" data-v-90ec57cc=""><div class="headnav" data-v-90ec57cc=""><div i-carbon:network-4="" inline-block="" class="mainIcon" data-v-90ec57cc=""></div><p data-v-90ec57cc="">Complex systems</p><div class="i-carbon:search" style="display:none" data-v-90ec57cc=""></div></div><div data-simplebar="" data-simplebar-auto-hide="false" class="tree" data-v-90ec57cc=""><div class="container" data-v-90ec57cc="" data-v-2966c002=""><div class="normal mainSection" data-v-2966c002=""><p class="mainText" data-v-2966c002="">Introduction</p><!----></div><!--[--><!--]--></div><div class="container" data-v-90ec57cc="" data-v-2966c002=""><div class="normal mainSection" data-v-2966c002=""><p class="mainText" data-v-2966c002="">Getting Started</p><div class="closesub i-akar-icons:chevron-right mainArrow" data-v-2966c002=""></div></div><!--[--><div class="normalSubs closesubs lasum" data-v-2966c002=""><a href="/complexSystem/getting-started/representations-of-graph-and-first-metrics" class="asub normalSub" data-v-2966c002="">Representations of graph and first metrics</a></div><div class="normalSubs closesubs lasum" data-v-2966c002=""><a href="/complexSystem/getting-started/breadth-first-search-algorithm-and-applications" class="asub normalSub" data-v-2966c002="">Breadth-first search algorithm and applications</a></div><div class="normalSubs closesubs lasum" data-v-2966c002=""><a href="/complexSystem/getting-started/igraph-package" class="asub normalSub" data-v-2966c002="">Igraph package</a></div><!--]--></div><div class="container" data-v-90ec57cc="" data-v-2966c002=""><div class="normal mainSection" data-v-2966c002=""><p class="mainText" data-v-2966c002="">Random graph models</p><div class="closesub i-akar-icons:chevron-right mainArrow" data-v-2966c002=""></div></div><!--[--><div class="normalSubs closesubs lasum" data-v-2966c002=""><a href="/complexSystem/random-graph-models/erdos-renyi-model" class="asub normalSub" data-v-2966c002="">Erdos-Renyi model</a></div><div class="normalSubs closesubs lasum" data-v-2966c002=""><a href="/complexSystem/random-graph-models/watts-strogatz-model-small-world-network" class="asub normalSub" data-v-2966c002="">Watts-Strogatz model : Small world network</a></div><div class="normalSubs closesubs lasum" data-v-2966c002=""><a href="/complexSystem/random-graph-models/graph-scale-free" class="asub normalSub" data-v-2966c002="">Graph scale free</a></div><div class="normalSubs closesubs lasum" data-v-2966c002=""><a href="/complexSystem/random-graph-models/histograms-of-the-degree-distribution" class="asub normalSub" data-v-2966c002="">Histograms of the degree distribution</a></div><div class="normalSubs closesubs lasum" data-v-2966c002=""><a href="/complexSystem/random-graph-models/scale-free-power-law-degree-distribution" class="asub normalSub" data-v-2966c002="">Scale free, power law degree distribution</a></div><div class="normalSubs closesubs lasum" data-v-2966c002=""><a href="/complexSystem/random-graph-models/erdos-renyi-average-length-as-function-of-p" class="asub normalSub" data-v-2966c002="">Erdos-Renyi, average length as function of p</a></div><div class="normalSubs closesubs lasum" data-v-2966c002=""><a href="/complexSystem/random-graph-models/erdos-renyi-clustering-coefficient-as-functions-of-p" class="asub normalSub" data-v-2966c002="">Erdos-Renyi, clustering coefficient as functions of p</a></div><!--]--></div><div class="container" data-v-90ec57cc="" data-v-2966c002=""><div class="normal mainSection" data-v-2966c002=""><p class="mainText" data-v-2966c002="">Voter model</p><div class="closesub i-akar-icons:chevron-right mainArrow" data-v-2966c002=""></div></div><!--[--><div class="normalSubs closesubs lasum" data-v-2966c002=""><a href="/complexSystem/voterModel/Representation" class="asub normalSub" data-v-2966c002="">Representation</a></div><div class="normalSubs closesubs lasum" data-v-2966c002=""><a href="/complexSystem/voterModel/influenceingScenarios" class="asub normalSub" data-v-2966c002="">Influenceing scenarios</a></div><!--]--></div><div class="container" data-v-90ec57cc="" data-v-2966c002=""><div class="normal mainSection" data-v-2966c002=""><p class="mainText" data-v-2966c002="">Epidemic models</p><div class="closesub i-akar-icons:chevron-right mainArrow" data-v-2966c002=""></div></div><!--[--><div class="normalSubs closesubs lasum" data-v-2966c002=""><a href="/complexSystem/epidemicModels/implementation" class="asub normalSub" data-v-2966c002="">Implementation</a></div><div class="normalSubs closesubs lasum" data-v-2966c002=""><a href="/complexSystem/epidemicModels/effectOfConfinePeople" class="asub normalSub" data-v-2966c002="">Effect of confine people</a></div><div class="normalSubs closesubs lasum" data-v-2966c002=""><a href="/complexSystem/epidemicModels/testAndIsolationStrategies" class="asub normalSub" data-v-2966c002="">Test and isolation strategies</a></div><!--]--></div></div><div class="footnav" data-v-90ec57cc=""><p data-v-90ec57cc="">Crafted with</p><div class="i-logos-vue px-xl" data-v-90ec57cc=""></div><p data-v-90ec57cc="">and</p><div class="i-noto:red-heart px-xl" data-v-90ec57cc=""></div></div></div><div class="headerfull" data-v-a0229b55=""><span data-v-a0229b55=""><div class="i-radix-icons:hamburger-menu" data-v-a0229b55=""></div></span><div class="test i-carbon:network-4" mx-1rem="" data-v-a0229b55=""></div><h1 data-v-a0229b55="">Complex systems</h1></div><div class="navcontainer navhidden" data-v-a0229b55="" data-v-90ec57cc=""><!----><div data-simplebar="" data-simplebar-auto-hide="false" class="tree" data-v-90ec57cc=""><div class="container" data-v-90ec57cc="" data-v-2966c002=""><div class="normal mainSection" data-v-2966c002=""><p class="mainText" data-v-2966c002="">Introduction</p><!----></div><!--[--><!--]--></div><div class="container" data-v-90ec57cc="" data-v-2966c002=""><div class="normal mainSection" data-v-2966c002=""><p class="mainText" data-v-2966c002="">Getting Started</p><div class="closesub i-akar-icons:chevron-right mainArrow" data-v-2966c002=""></div></div><!--[--><div class="normalSubs closesubs lasum" data-v-2966c002=""><a href="/complexSystem/getting-started/representations-of-graph-and-first-metrics" class="asub normalSub" data-v-2966c002="">Representations of graph and first metrics</a></div><div class="normalSubs closesubs lasum" data-v-2966c002=""><a href="/complexSystem/getting-started/breadth-first-search-algorithm-and-applications" class="asub normalSub" data-v-2966c002="">Breadth-first search algorithm and applications</a></div><div class="normalSubs closesubs lasum" data-v-2966c002=""><a href="/complexSystem/getting-started/igraph-package" class="asub normalSub" data-v-2966c002="">Igraph package</a></div><!--]--></div><div class="container" data-v-90ec57cc="" data-v-2966c002=""><div class="normal mainSection" data-v-2966c002=""><p class="mainText" data-v-2966c002="">Random graph models</p><div class="closesub i-akar-icons:chevron-right mainArrow" data-v-2966c002=""></div></div><!--[--><div class="normalSubs closesubs lasum" data-v-2966c002=""><a href="/complexSystem/random-graph-models/erdos-renyi-model" class="asub normalSub" data-v-2966c002="">Erdos-Renyi model</a></div><div class="normalSubs closesubs lasum" data-v-2966c002=""><a href="/complexSystem/random-graph-models/watts-strogatz-model-small-world-network" class="asub normalSub" data-v-2966c002="">Watts-Strogatz model : Small world network</a></div><div class="normalSubs closesubs lasum" data-v-2966c002=""><a href="/complexSystem/random-graph-models/graph-scale-free" class="asub normalSub" data-v-2966c002="">Graph scale free</a></div><div class="normalSubs closesubs lasum" data-v-2966c002=""><a href="/complexSystem/random-graph-models/histograms-of-the-degree-distribution" class="asub normalSub" data-v-2966c002="">Histograms of the degree distribution</a></div><div class="normalSubs closesubs lasum" data-v-2966c002=""><a href="/complexSystem/random-graph-models/scale-free-power-law-degree-distribution" class="asub normalSub" data-v-2966c002="">Scale free, power law degree distribution</a></div><div class="normalSubs closesubs lasum" data-v-2966c002=""><a href="/complexSystem/random-graph-models/erdos-renyi-average-length-as-function-of-p" class="asub normalSub" data-v-2966c002="">Erdos-Renyi, average length as function of p</a></div><div class="normalSubs closesubs lasum" data-v-2966c002=""><a href="/complexSystem/random-graph-models/erdos-renyi-clustering-coefficient-as-functions-of-p" class="asub normalSub" data-v-2966c002="">Erdos-Renyi, clustering coefficient as functions of p</a></div><!--]--></div><div class="container" data-v-90ec57cc="" data-v-2966c002=""><div class="normal mainSection" data-v-2966c002=""><p class="mainText" data-v-2966c002="">Voter model</p><div class="closesub i-akar-icons:chevron-right mainArrow" data-v-2966c002=""></div></div><!--[--><div class="normalSubs closesubs lasum" data-v-2966c002=""><a href="/complexSystem/voterModel/Representation" class="asub normalSub" data-v-2966c002="">Representation</a></div><div class="normalSubs closesubs lasum" data-v-2966c002=""><a href="/complexSystem/voterModel/influenceingScenarios" class="asub normalSub" data-v-2966c002="">Influenceing scenarios</a></div><!--]--></div><div class="container" data-v-90ec57cc="" data-v-2966c002=""><div class="normal mainSection" data-v-2966c002=""><p class="mainText" data-v-2966c002="">Epidemic models</p><div class="closesub i-akar-icons:chevron-right mainArrow" data-v-2966c002=""></div></div><!--[--><div class="normalSubs closesubs lasum" data-v-2966c002=""><a href="/complexSystem/epidemicModels/implementation" class="asub normalSub" data-v-2966c002="">Implementation</a></div><div class="normalSubs closesubs lasum" data-v-2966c002=""><a href="/complexSystem/epidemicModels/effectOfConfinePeople" class="asub normalSub" data-v-2966c002="">Effect of confine people</a></div><div class="normalSubs closesubs lasum" data-v-2966c002=""><a href="/complexSystem/epidemicModels/testAndIsolationStrategies" class="asub normalSub" data-v-2966c002="">Test and isolation strategies</a></div><!--]--></div></div><div class="footnav" data-v-90ec57cc=""><p data-v-90ec57cc="">Crafted with</p><div class="i-logos-vue px-xl" data-v-90ec57cc=""></div><p data-v-90ec57cc="">and</p><div class="i-noto:red-heart px-xl" data-v-90ec57cc=""></div></div></div><div class="prose prose-sm m-auto text-left routeVue" data-simplebar="" data-v-a0229b55=""><h1>Implementation</h1><p>Below you will find a function that simulate the spread of the epidemic in an SIR model. The evolution of the number of Susceptible, Infected and Recovered can be represented as a function of the time :</p><pre><code class="language-r"><div class="shiki-container"><pre class="shiki shiki-dark" style="background-color:#002b36"><code v-pre=""><span class="line"><span style="color:#268bd2">library</span><span style="color:#839496">(</span><span style="color:#268bd2">igraph</span><span style="color:#839496">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#268bd2">Erdos_Renyi_optimized</span><span style="color:#839496"> </span><span style="color:#859900">&lt;-</span><span style="color:#839496"> </span><span style="color:#859900">function</span><span style="color:#839496">(</span><span style="color:#268bd2">n</span><span style="color:#839496">,</span><span style="color:#268bd2">p</span><span style="color:#839496">)</span></span>
<span class="line"><span style="color:#839496">{</span></span>
<span class="line"><span style="color:#839496">  </span><span style="color:#268bd2">nb_tri</span><span style="color:#839496"> </span><span style="color:#859900">&lt;-</span><span style="color:#839496"> </span><span style="color:#268bd2">n</span><span style="color:#859900">*</span><span style="color:#839496">(</span><span style="color:#268bd2">n</span><span style="color:#859900">-</span><span style="color:#d33682">1</span><span style="color:#839496">)</span><span style="color:#859900">/</span><span style="color:#d33682">2</span></span>
<span class="line"><span style="color:#839496">  </span><span style="color:#268bd2">mat</span><span style="color:#839496"> </span><span style="color:#859900">&lt;-</span><span style="color:#839496"> </span><span style="color:#268bd2">diag</span><span style="color:#839496">(</span><span style="color:#d33682">0</span><span style="color:#839496">,nrow </span><span style="color:#859900">=</span><span style="color:#839496"> </span><span style="color:#268bd2">n</span><span style="color:#839496">, ncol </span><span style="color:#859900">=</span><span style="color:#839496"> </span><span style="color:#268bd2">n</span><span style="color:#839496">)</span></span>
<span class="line"><span style="color:#839496">  </span><span style="color:#268bd2">vect_rand</span><span style="color:#839496"> </span><span style="color:#859900">&lt;-</span><span style="color:#839496"> </span><span style="color:#268bd2">runif</span><span style="color:#839496">(</span><span style="color:#268bd2">nb_tri</span><span style="color:#839496"> , min </span><span style="color:#859900">=</span><span style="color:#839496"> </span><span style="color:#d33682">0</span><span style="color:#839496">, max </span><span style="color:#859900">=</span><span style="color:#839496"> </span><span style="color:#d33682">1</span><span style="color:#839496">) </span><span style="color:#859900">-</span><span style="color:#839496"> </span><span style="color:#268bd2">p</span></span>
<span class="line"><span style="color:#839496">  </span><span style="color:#859900">for</span><span style="color:#839496">(</span><span style="color:#268bd2">i</span><span style="color:#839496"> </span><span style="color:#859900">in</span><span style="color:#839496"> </span><span style="color:#d33682">1</span><span style="color:#859900">:</span><span style="color:#268bd2">nb_tri</span><span style="color:#839496">)</span></span>
<span class="line"><span style="color:#839496">  {</span></span>
<span class="line"><span style="color:#839496">    </span><span style="color:#859900">if</span><span style="color:#839496">(</span><span style="color:#268bd2">vect_rand</span><span style="color:#839496">[</span><span style="color:#268bd2">i</span><span style="color:#839496">]</span><span style="color:#859900">&gt;</span><span style="color:#d33682">0</span><span style="color:#839496">)</span></span>
<span class="line"><span style="color:#839496">    {</span></span>
<span class="line"><span style="color:#839496">      </span><span style="color:#268bd2">vect_rand</span><span style="color:#839496">[</span><span style="color:#268bd2">i</span><span style="color:#839496">] </span><span style="color:#859900">&lt;-</span><span style="color:#839496"> </span><span style="color:#d33682">0</span><span style="color:#839496"> </span></span>
<span class="line"><span style="color:#839496">    }</span></span>
<span class="line"><span style="color:#839496">    </span><span style="color:#859900">else</span></span>
<span class="line"><span style="color:#839496">    {</span></span>
<span class="line"><span style="color:#839496">      </span><span style="color:#268bd2">vect_rand</span><span style="color:#839496">[</span><span style="color:#268bd2">i</span><span style="color:#839496">] </span><span style="color:#859900">&lt;-</span><span style="color:#839496"> </span><span style="color:#d33682">1</span><span style="color:#839496"> </span></span>
<span class="line"><span style="color:#839496">    }</span></span>
<span class="line"><span style="color:#839496">  }</span></span>
<span class="line"><span style="color:#839496">  </span><span style="color:#268bd2">mat</span><span style="color:#839496">[</span><span style="color:#268bd2">lower.tri</span><span style="color:#839496">(</span><span style="color:#268bd2">mat</span><span style="color:#839496">)] </span><span style="color:#859900">&lt;-</span><span style="color:#839496"> </span><span style="color:#268bd2">vect_rand</span></span>
<span class="line"><span style="color:#839496">  </span><span style="color:#268bd2">mat</span><span style="color:#839496"> </span><span style="color:#859900">&lt;-</span><span style="color:#839496"> </span><span style="color:#268bd2">t</span><span style="color:#839496">(</span><span style="color:#268bd2">mat</span><span style="color:#839496">)</span></span>
<span class="line"><span style="color:#839496">  </span><span style="color:#268bd2">mat</span><span style="color:#839496">[</span><span style="color:#268bd2">lower.tri</span><span style="color:#839496">(</span><span style="color:#268bd2">mat</span><span style="color:#839496">)] </span><span style="color:#859900">&lt;-</span><span style="color:#839496"> </span><span style="color:#268bd2">vect_rand</span></span>
<span class="line"><span style="color:#839496">  </span><span style="color:#268bd2">igraph</span><span style="color:#839496"> </span><span style="color:#859900">&lt;-</span><span style="color:#839496"> graph_from_adjacency_matrix(</span><span style="color:#268bd2">mat</span><span style="color:#839496">,mode </span><span style="color:#859900">=</span><span style="color:#839496"> </span><span style="color:#268bd2">c</span><span style="color:#839496">(</span><span style="color:#2aa198">"undirected"</span><span style="color:#839496">))</span></span>
<span class="line"><span style="color:#839496">  </span><span style="color:#268bd2">igraph</span></span>
<span class="line"><span style="color:#839496">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#268bd2">plot_epidemic_curves</span><span style="color:#839496"> </span><span style="color:#859900">&lt;-</span><span style="color:#839496"> </span><span style="color:#859900">function</span><span style="color:#839496">(</span><span style="color:#268bd2">mat_res</span><span style="color:#839496">,</span><span style="color:#268bd2">time</span><span style="color:#839496">)</span></span>
<span class="line"><span style="color:#839496">{</span></span>
<span class="line"><span style="color:#839496">  </span><span style="color:#268bd2">plot</span><span style="color:#839496">( x </span><span style="color:#859900">=</span><span style="color:#839496"> </span><span style="color:#268bd2">c</span><span style="color:#839496">(</span><span style="color:#d33682">0</span><span style="color:#859900">:</span><span style="color:#268bd2">time</span><span style="color:#839496">), y </span><span style="color:#859900">=</span><span style="color:#839496"> </span><span style="color:#268bd2">mat_res</span><span style="color:#839496">[</span><span style="color:#d33682">2</span><span style="color:#839496">,],xlab</span><span style="color:#859900">=</span><span style="color:#2aa198">"days"</span><span style="color:#839496">,ylab</span><span style="color:#859900">=</span><span style="color:#2aa198">"Percentage of people"</span><span style="color:#839496">,type</span><span style="color:#859900">=</span><span style="color:#2aa198">"b"</span><span style="color:#839496">,col</span><span style="color:#859900">=</span><span style="color:#2aa198">"green"</span><span style="color:#839496">, ylim</span><span style="color:#859900">=</span><span style="color:#268bd2">c</span><span style="color:#839496">(</span><span style="color:#d33682">1</span><span style="color:#839496">,</span><span style="color:#d33682">100</span><span style="color:#839496">),main</span><span style="color:#859900">=</span><span style="color:#2aa198">"Evolution of SIR model epidemic"</span><span style="color:#839496">)</span></span>
<span class="line"><span style="color:#839496">  </span><span style="color:#268bd2">lines</span><span style="color:#839496">(x</span><span style="color:#859900">=</span><span style="color:#839496"> </span><span style="color:#268bd2">c</span><span style="color:#839496">(</span><span style="color:#d33682">0</span><span style="color:#859900">:</span><span style="color:#268bd2">time</span><span style="color:#839496">), y </span><span style="color:#859900">=</span><span style="color:#839496"> </span><span style="color:#268bd2">mat_res</span><span style="color:#839496">[</span><span style="color:#d33682">3</span><span style="color:#839496">,],type</span><span style="color:#859900">=</span><span style="color:#2aa198">"b"</span><span style="color:#839496">,col</span><span style="color:#859900">=</span><span style="color:#2aa198">"blue"</span><span style="color:#839496">)</span></span>
<span class="line"><span style="color:#839496">  </span><span style="color:#268bd2">lines</span><span style="color:#839496">(x</span><span style="color:#859900">=</span><span style="color:#839496"> </span><span style="color:#268bd2">c</span><span style="color:#839496">(</span><span style="color:#d33682">0</span><span style="color:#859900">:</span><span style="color:#268bd2">time</span><span style="color:#839496">), y </span><span style="color:#859900">=</span><span style="color:#839496"> </span><span style="color:#268bd2">mat_res</span><span style="color:#839496">[</span><span style="color:#d33682">1</span><span style="color:#839496">,],type</span><span style="color:#859900">=</span><span style="color:#2aa198">"b"</span><span style="color:#839496">,col</span><span style="color:#859900">=</span><span style="color:#2aa198">"red"</span><span style="color:#839496">)</span></span>
<span class="line"><span style="color:#839496">  </span><span style="color:#268bd2">legend</span><span style="color:#839496">( ( </span><span style="color:#268bd2">time</span><span style="color:#859900">-</span><span style="color:#839496">(</span><span style="color:#268bd2">time</span><span style="color:#859900">*</span><span style="color:#d33682">0.15</span><span style="color:#839496">) ), </span><span style="color:#d33682">90</span><span style="color:#839496">, legend</span><span style="color:#859900">=</span><span style="color:#268bd2">c</span><span style="color:#839496">(</span><span style="color:#2aa198">"Suceptible"</span><span style="color:#839496">, </span><span style="color:#2aa198">"Infected"</span><span style="color:#839496">,</span><span style="color:#2aa198">"Recovered"</span><span style="color:#839496">),</span></span>
<span class="line"><span style="color:#839496">          col</span><span style="color:#859900">=</span><span style="color:#268bd2">c</span><span style="color:#839496">(</span><span style="color:#2aa198">"green"</span><span style="color:#839496">,</span><span style="color:#2aa198">"blue"</span><span style="color:#839496">,</span><span style="color:#2aa198">"red"</span><span style="color:#839496">), lty</span><span style="color:#859900">=</span><span style="color:#d33682">1</span><span style="color:#859900">:</span><span style="color:#d33682">3</span><span style="color:#839496">, cex</span><span style="color:#859900">=</span><span style="color:#d33682">0.8</span><span style="color:#839496">)</span></span>
<span class="line"><span style="color:#839496">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#268bd2">epidemic_plot</span><span style="color:#839496"> </span><span style="color:#859900">&lt;-</span><span style="color:#839496"> </span><span style="color:#859900">function</span><span style="color:#839496">(</span><span style="color:#268bd2">igraph</span><span style="color:#839496">,</span><span style="color:#268bd2">mainstr</span><span style="color:#839496">)</span></span>
<span class="line"><span style="color:#839496">{</span></span>
<span class="line"><span style="color:#839496">  </span><span style="color:#268bd2">nb_node</span><span style="color:#839496"> </span><span style="color:#859900">&lt;-</span><span style="color:#839496"> vcount(</span><span style="color:#268bd2">igraph</span><span style="color:#839496">)</span></span>
<span class="line"><span style="color:#839496">  </span><span style="color:#859900">for</span><span style="color:#839496">(</span><span style="color:#268bd2">i</span><span style="color:#839496"> </span><span style="color:#859900">in</span><span style="color:#839496"> </span><span style="color:#d33682">1</span><span style="color:#859900">:</span><span style="color:#839496"> </span><span style="color:#268bd2">nb_node</span><span style="color:#839496">)</span></span>
<span class="line"><span style="color:#839496">  {</span></span>
<span class="line"><span style="color:#839496">    </span><span style="color:#268bd2">node_status</span><span style="color:#839496"> </span><span style="color:#859900">&lt;-</span><span style="color:#839496"> get.vertex.attribute(</span><span style="color:#268bd2">igraph</span><span style="color:#839496">,</span><span style="color:#2aa198">"epidemic"</span><span style="color:#839496">, </span><span style="color:#268bd2">i</span><span style="color:#839496">)</span></span>
<span class="line"><span style="color:#839496">    </span><span style="color:#859900">if</span><span style="color:#839496">( </span><span style="color:#268bd2">node_status</span><span style="color:#839496"> </span><span style="color:#859900">==</span><span style="color:#839496"> </span><span style="color:#2aa198">"i"</span><span style="color:#839496"> )</span></span>
<span class="line"><span style="color:#839496">    {</span></span>
<span class="line"><span style="color:#839496">      </span><span style="color:#268bd2">igraph</span><span style="color:#839496"> </span><span style="color:#859900">&lt;-</span><span style="color:#839496"> set.vertex.attribute(</span><span style="color:#268bd2">igraph</span><span style="color:#839496">, </span><span style="color:#2aa198">'color'</span><span style="color:#839496">, </span><span style="color:#268bd2">i</span><span style="color:#839496">, </span><span style="color:#268bd2">rgb</span><span style="color:#839496">(</span><span style="color:#d33682">1</span><span style="color:#839496">,</span><span style="color:#d33682">0</span><span style="color:#839496">,</span><span style="color:#d33682">0</span><span style="color:#839496">) )</span></span>
<span class="line"><span style="color:#839496">    }</span></span>
<span class="line"><span style="color:#839496">    </span><span style="color:#859900">else</span><span style="color:#839496"> </span><span style="color:#859900">if</span><span style="color:#839496"> (</span><span style="color:#268bd2">node_status</span><span style="color:#839496"> </span><span style="color:#859900">==</span><span style="color:#839496"> </span><span style="color:#2aa198">"s"</span><span style="color:#839496"> )</span></span>
<span class="line"><span style="color:#839496">    {</span></span>
<span class="line"><span style="color:#839496">      </span><span style="color:#268bd2">igraph</span><span style="color:#839496"> </span><span style="color:#859900">&lt;-</span><span style="color:#839496"> set.vertex.attribute(</span><span style="color:#268bd2">igraph</span><span style="color:#839496">, </span><span style="color:#2aa198">'color'</span><span style="color:#839496">, </span><span style="color:#268bd2">i</span><span style="color:#839496">, </span><span style="color:#268bd2">rgb</span><span style="color:#839496">(</span><span style="color:#d33682">0</span><span style="color:#839496">,</span><span style="color:#d33682">1</span><span style="color:#839496">,</span><span style="color:#d33682">0</span><span style="color:#839496">) )</span></span>
<span class="line"><span style="color:#839496">    }</span></span>
<span class="line"><span style="color:#839496">    </span><span style="color:#859900">else</span><span style="color:#839496"> </span><span style="color:#859900">if</span><span style="color:#839496">(</span><span style="color:#268bd2">node_status</span><span style="color:#839496"> </span><span style="color:#859900">==</span><span style="color:#839496"> </span><span style="color:#2aa198">"r"</span><span style="color:#839496"> )</span></span>
<span class="line"><span style="color:#839496">    {</span></span>
<span class="line"><span style="color:#839496">      </span><span style="color:#268bd2">igraph</span><span style="color:#839496"> </span><span style="color:#859900">&lt;-</span><span style="color:#839496"> set.vertex.attribute(</span><span style="color:#268bd2">igraph</span><span style="color:#839496">, </span><span style="color:#2aa198">'color'</span><span style="color:#839496">, </span><span style="color:#268bd2">i</span><span style="color:#839496">, </span><span style="color:#268bd2">rgb</span><span style="color:#839496">(</span><span style="color:#d33682">0</span><span style="color:#839496">,</span><span style="color:#d33682">0</span><span style="color:#839496">,</span><span style="color:#d33682">1</span><span style="color:#839496">) )</span></span>
<span class="line"><span style="color:#839496">    }</span></span>
<span class="line"><span style="color:#839496">    </span><span style="color:#859900">else</span><span style="color:#839496">{</span></span>
<span class="line"><span style="color:#839496">      </span><span style="color:#268bd2">print</span><span style="color:#839496">(</span><span style="color:#2aa198">"BUG PLOT attribute"</span><span style="color:#839496">)</span></span>
<span class="line"><span style="color:#839496">    }</span></span>
<span class="line"><span style="color:#839496">  }</span></span>
<span class="line"><span style="color:#839496">  </span><span style="color:#859900">for</span><span style="color:#839496">(</span><span style="color:#268bd2">i</span><span style="color:#839496"> </span><span style="color:#859900">in</span><span style="color:#839496"> </span><span style="color:#d33682">1</span><span style="color:#859900">:</span><span style="color:#839496"> </span><span style="color:#268bd2">nb_node</span><span style="color:#839496">)</span></span>
<span class="line"><span style="color:#839496">  {</span></span>
<span class="line"><span style="color:#839496">    </span><span style="color:#268bd2">node_status</span><span style="color:#839496"> </span><span style="color:#859900">&lt;-</span><span style="color:#839496"> get.vertex.attribute(</span><span style="color:#268bd2">igraph</span><span style="color:#839496">,</span><span style="color:#2aa198">"i_time"</span><span style="color:#839496">, </span><span style="color:#268bd2">i</span><span style="color:#839496">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#839496">    </span><span style="color:#859900">if</span><span style="color:#839496">( </span><span style="color:#268bd2">node_status</span><span style="color:#839496"> </span><span style="color:#859900">&gt;</span><span style="color:#839496"> </span><span style="color:#d33682">0</span><span style="color:#839496"> )</span></span>
<span class="line"><span style="color:#839496">    {</span></span>
<span class="line"><span style="color:#839496">      </span><span style="color:#268bd2">igraph</span><span style="color:#839496"> </span><span style="color:#859900">&lt;-</span><span style="color:#839496"> set.vertex.attribute(</span><span style="color:#268bd2">igraph</span><span style="color:#839496">, </span><span style="color:#2aa198">"label"</span><span style="color:#839496">, </span><span style="color:#268bd2">i</span><span style="color:#839496">, </span><span style="color:#268bd2">node_status</span><span style="color:#839496">  )</span></span>
<span class="line"><span style="color:#839496">    }</span><span style="color:#859900">else</span><span style="color:#839496"> </span><span style="color:#859900">if</span><span style="color:#839496">( </span><span style="color:#268bd2">node_status</span><span style="color:#839496"> </span><span style="color:#859900">==</span><span style="color:#839496"> </span><span style="color:#d33682">0</span><span style="color:#839496"> )</span></span>
<span class="line"><span style="color:#839496">    {</span></span>
<span class="line"><span style="color:#839496">      </span><span style="color:#268bd2">igraph</span><span style="color:#839496"> </span><span style="color:#859900">&lt;-</span><span style="color:#839496"> set.vertex.attribute(</span><span style="color:#268bd2">igraph</span><span style="color:#839496">, </span><span style="color:#2aa198">"label"</span><span style="color:#839496">, </span><span style="color:#268bd2">i</span><span style="color:#839496">, </span><span style="color:#2aa198">"R"</span><span style="color:#839496">  )</span></span>
<span class="line"><span style="color:#839496">      </span><span style="color:#268bd2">igraph</span><span style="color:#839496"> </span><span style="color:#859900">&lt;-</span><span style="color:#839496"> set.vertex.attribute(</span><span style="color:#268bd2">igraph</span><span style="color:#839496">, </span><span style="color:#2aa198">'color'</span><span style="color:#839496">, </span><span style="color:#268bd2">i</span><span style="color:#839496">, </span><span style="color:#268bd2">rgb</span><span style="color:#839496">(</span><span style="color:#d33682">0</span><span style="color:#839496">,</span><span style="color:#d33682">0</span><span style="color:#839496">,</span><span style="color:#d33682">1</span><span style="color:#839496">) )</span></span>
<span class="line"><span style="color:#839496">    }</span><span style="color:#859900">else</span></span>
<span class="line"><span style="color:#839496">    {</span></span>
<span class="line"><span style="color:#839496">      </span><span style="color:#268bd2">igraph</span><span style="color:#839496"> </span><span style="color:#859900">&lt;-</span><span style="color:#839496"> set.vertex.attribute(</span><span style="color:#268bd2">igraph</span><span style="color:#839496">, </span><span style="color:#2aa198">"label"</span><span style="color:#839496">, </span><span style="color:#268bd2">i</span><span style="color:#839496">, </span><span style="color:#2aa198">"S"</span><span style="color:#839496">  )</span></span>
<span class="line"><span style="color:#839496">    }</span></span>
<span class="line"><span style="color:#839496">  }</span></span>
<span class="line"><span style="color:#839496">  </span><span style="color:#268bd2">plot</span><span style="color:#839496">(</span><span style="color:#268bd2">igraph</span><span style="color:#839496">, main </span><span style="color:#859900">=</span><span style="color:#839496"> </span><span style="color:#268bd2">mainstr</span><span style="color:#839496"> )</span></span>
<span class="line"><span style="color:#839496">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#268bd2">is_unique</span><span style="color:#839496"> </span><span style="color:#859900">&lt;-</span><span style="color:#839496"> </span><span style="color:#859900">function</span><span style="color:#839496">(</span><span style="color:#268bd2">vect</span><span style="color:#839496">)</span></span>
<span class="line"><span style="color:#839496">{</span></span>
<span class="line"><span style="color:#839496">    </span><span style="color:#268bd2">isunique</span><span style="color:#839496"> </span><span style="color:#859900">&lt;-</span><span style="color:#839496"> </span><span style="color:#b58900">TRUE</span></span>
<span class="line"><span style="color:#839496">    </span><span style="color:#859900">for</span><span style="color:#839496">(</span><span style="color:#268bd2">i</span><span style="color:#839496"> </span><span style="color:#859900">in</span><span style="color:#839496"> </span><span style="color:#d33682">1</span><span style="color:#859900">:</span><span style="color:#839496"> </span><span style="color:#268bd2">length</span><span style="color:#839496">(</span><span style="color:#268bd2">vect</span><span style="color:#839496">))</span></span>
<span class="line"><span style="color:#839496">    {</span></span>
<span class="line"><span style="color:#839496">        </span><span style="color:#268bd2">iterator</span><span style="color:#839496"> </span><span style="color:#859900">&lt;-</span><span style="color:#839496"> </span><span style="color:#268bd2">vect</span><span style="color:#839496">[</span><span style="color:#268bd2">i</span><span style="color:#839496">]</span></span>
<span class="line"><span style="color:#839496">        </span><span style="color:#859900">for</span><span style="color:#839496">(</span><span style="color:#268bd2">j</span><span style="color:#839496"> </span><span style="color:#859900">in</span><span style="color:#839496"> </span><span style="color:#d33682">1</span><span style="color:#859900">:</span><span style="color:#268bd2">length</span><span style="color:#839496">(</span><span style="color:#268bd2">vect</span><span style="color:#839496">))</span></span>
<span class="line"><span style="color:#839496">        {</span></span>
<span class="line"><span style="color:#839496">            </span><span style="color:#859900">if</span><span style="color:#839496">(</span><span style="color:#268bd2">j</span><span style="color:#839496"> </span><span style="color:#859900">!=</span><span style="color:#839496"> </span><span style="color:#268bd2">i</span><span style="color:#839496">)</span></span>
<span class="line"><span style="color:#839496">            {</span></span>
<span class="line"><span style="color:#839496">                </span><span style="color:#859900">if</span><span style="color:#839496">(</span><span style="color:#268bd2">vect</span><span style="color:#839496">[</span><span style="color:#268bd2">j</span><span style="color:#839496">] </span><span style="color:#859900">==</span><span style="color:#839496"> </span><span style="color:#268bd2">vect</span><span style="color:#839496">[</span><span style="color:#268bd2">i</span><span style="color:#839496">])</span></span>
<span class="line"><span style="color:#839496">                {</span></span>
<span class="line"><span style="color:#839496">                    </span><span style="color:#268bd2">isunique</span><span style="color:#839496"> </span><span style="color:#859900">&lt;-</span><span style="color:#839496"> </span><span style="color:#b58900">FALSE</span></span>
<span class="line"><span style="color:#839496">                }</span></span>
<span class="line"><span style="color:#839496">            }</span></span>
<span class="line"><span style="color:#839496">        }</span></span>
<span class="line"><span style="color:#839496">    }</span></span>
<span class="line"><span style="color:#839496">    </span><span style="color:#268bd2">isunique</span></span>
<span class="line"><span style="color:#839496">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#586e75;font-style:italic"># The way we ensure uniqueness may be improuved with faster (and nicer) algorithm</span></span>
<span class="line"><span style="color:#268bd2">ensure_unique</span><span style="color:#839496"> </span><span style="color:#859900">&lt;-</span><span style="color:#839496"> </span><span style="color:#859900">function</span><span style="color:#839496">(</span><span style="color:#268bd2">vect</span><span style="color:#839496">){</span></span>
<span class="line"><span style="color:#839496">    </span><span style="color:#859900">while</span><span style="color:#839496">(is_unique(</span><span style="color:#268bd2">vect</span><span style="color:#839496">) </span><span style="color:#859900">!=</span><span style="color:#839496"> </span><span style="color:#b58900">TRUE</span><span style="color:#839496">)</span></span>
<span class="line"><span style="color:#839496">    {</span></span>
<span class="line"><span style="color:#839496">        </span><span style="color:#859900">for</span><span style="color:#839496">(</span><span style="color:#268bd2">i</span><span style="color:#839496"> </span><span style="color:#859900">in</span><span style="color:#839496"> </span><span style="color:#d33682">1</span><span style="color:#859900">:</span><span style="color:#839496"> </span><span style="color:#268bd2">length</span><span style="color:#839496">(</span><span style="color:#268bd2">vect</span><span style="color:#839496">))</span></span>
<span class="line"><span style="color:#839496">        {</span></span>
<span class="line"><span style="color:#839496">            </span><span style="color:#268bd2">iterator</span><span style="color:#839496"> </span><span style="color:#859900">&lt;-</span><span style="color:#839496"> </span><span style="color:#268bd2">vect</span><span style="color:#839496">[</span><span style="color:#268bd2">i</span><span style="color:#839496">]</span></span>
<span class="line"><span style="color:#839496">            </span><span style="color:#859900">for</span><span style="color:#839496">(</span><span style="color:#268bd2">j</span><span style="color:#839496"> </span><span style="color:#859900">in</span><span style="color:#839496"> </span><span style="color:#d33682">1</span><span style="color:#859900">:</span><span style="color:#268bd2">length</span><span style="color:#839496">(</span><span style="color:#268bd2">vect</span><span style="color:#839496">))</span></span>
<span class="line"><span style="color:#839496">            {</span></span>
<span class="line"><span style="color:#839496">                </span><span style="color:#859900">if</span><span style="color:#839496">(</span><span style="color:#268bd2">j</span><span style="color:#839496"> </span><span style="color:#859900">!=</span><span style="color:#839496"> </span><span style="color:#268bd2">i</span><span style="color:#839496">)</span></span>
<span class="line"><span style="color:#839496">                {</span></span>
<span class="line"><span style="color:#839496">                    </span><span style="color:#859900">if</span><span style="color:#839496">(</span><span style="color:#268bd2">iterator</span><span style="color:#839496"> </span><span style="color:#859900">==</span><span style="color:#839496"> </span><span style="color:#268bd2">vect</span><span style="color:#839496">[</span><span style="color:#268bd2">j</span><span style="color:#839496">] )</span></span>
<span class="line"><span style="color:#839496">                    {</span></span>
<span class="line"><span style="color:#839496">                        </span><span style="color:#268bd2">vect</span><span style="color:#839496">[</span><span style="color:#268bd2">j</span><span style="color:#839496">] </span><span style="color:#859900">&lt;-</span><span style="color:#839496"> </span><span style="color:#268bd2">floor</span><span style="color:#839496">(</span><span style="color:#268bd2">runif</span><span style="color:#839496">(</span><span style="color:#d33682">1</span><span style="color:#839496">,min</span><span style="color:#859900">=</span><span style="color:#d33682">1</span><span style="color:#839496">,max</span><span style="color:#859900">=</span><span style="color:#268bd2">length</span><span style="color:#839496">(</span><span style="color:#268bd2">vect</span><span style="color:#839496">)))</span></span>
<span class="line"><span style="color:#839496">                    }</span></span>
<span class="line"><span style="color:#839496">                }</span></span>
<span class="line"><span style="color:#839496">            }</span></span>
<span class="line"><span style="color:#839496">        }</span></span>
<span class="line"><span style="color:#839496">    }</span></span>
<span class="line"><span style="color:#839496">    </span><span style="color:#268bd2">vect</span></span>
<span class="line"><span style="color:#839496">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#268bd2">init_epidemic</span><span style="color:#839496"> </span><span style="color:#859900">&lt;-</span><span style="color:#839496"> </span><span style="color:#859900">function</span><span style="color:#839496">(</span><span style="color:#268bd2">igraph</span><span style="color:#839496">,</span><span style="color:#268bd2">n_0</span><span style="color:#839496">,</span><span style="color:#268bd2">n_d</span><span style="color:#839496">)</span></span>
<span class="line"><span style="color:#839496">{</span></span>
<span class="line"><span style="color:#839496">  </span><span style="color:#268bd2">nb_node</span><span style="color:#839496"> </span><span style="color:#859900">&lt;-</span><span style="color:#839496"> vcount(</span><span style="color:#268bd2">igraph</span><span style="color:#839496">)</span></span>
<span class="line"><span style="color:#839496">  </span><span style="color:#268bd2">Infected_vect</span><span style="color:#839496"> </span><span style="color:#859900">&lt;-</span><span style="color:#839496"> </span><span style="color:#268bd2">floor</span><span style="color:#839496">(</span><span style="color:#268bd2">runif</span><span style="color:#839496">(</span><span style="color:#268bd2">n_0</span><span style="color:#839496">,min</span><span style="color:#859900">=</span><span style="color:#d33682">1</span><span style="color:#839496">,max</span><span style="color:#859900">=</span><span style="color:#268bd2">nb_node</span><span style="color:#839496">))</span></span>
<span class="line"><span style="color:#839496">  </span><span style="color:#268bd2">Infected_vect</span><span style="color:#839496"> </span><span style="color:#859900">&lt;-</span><span style="color:#839496"> ensure_unique(</span><span style="color:#268bd2">Infected_vect</span><span style="color:#839496">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#839496">  </span><span style="color:#268bd2">igraph</span><span style="color:#839496"> </span><span style="color:#859900">&lt;-</span><span style="color:#839496"> set.vertex.attribute(</span><span style="color:#268bd2">igraph</span><span style="color:#839496">,</span><span style="color:#2aa198">"epidemic"</span><span style="color:#839496">, value</span><span style="color:#859900">=</span><span style="color:#2aa198">"s"</span><span style="color:#839496">)</span></span>
<span class="line"><span style="color:#839496">  </span><span style="color:#268bd2">igraph</span><span style="color:#839496"> </span><span style="color:#859900">&lt;-</span><span style="color:#839496"> set.vertex.attribute(</span><span style="color:#268bd2">igraph</span><span style="color:#839496">,</span><span style="color:#2aa198">"i_time"</span><span style="color:#839496">, value </span><span style="color:#859900">=</span><span style="color:#839496"> </span><span style="color:#859900">-</span><span style="color:#d33682">1</span><span style="color:#839496"> )</span></span>
<span class="line"><span style="color:#839496">  </span><span style="color:#859900">for</span><span style="color:#839496">( </span><span style="color:#268bd2">i</span><span style="color:#839496"> </span><span style="color:#859900">in</span><span style="color:#839496"> </span><span style="color:#d33682">1</span><span style="color:#839496"> </span><span style="color:#859900">:</span><span style="color:#839496"> </span><span style="color:#268bd2">n_0</span><span style="color:#839496"> )</span></span>
<span class="line"><span style="color:#839496">  {</span></span>
<span class="line"><span style="color:#839496">    </span><span style="color:#268bd2">igraph</span><span style="color:#839496"> </span><span style="color:#859900">&lt;-</span><span style="color:#839496"> set.vertex.attribute(</span><span style="color:#268bd2">igraph</span><span style="color:#839496">,</span><span style="color:#2aa198">"epidemic"</span><span style="color:#839496">, </span><span style="color:#268bd2">Infected_vect</span><span style="color:#839496">[</span><span style="color:#268bd2">i</span><span style="color:#839496">] ,value</span><span style="color:#859900">=</span><span style="color:#2aa198">"i"</span><span style="color:#839496">)</span></span>
<span class="line"><span style="color:#839496">    </span><span style="color:#268bd2">igraph</span><span style="color:#839496"> </span><span style="color:#859900">&lt;-</span><span style="color:#839496"> set.vertex.attribute(</span><span style="color:#268bd2">igraph</span><span style="color:#839496">,</span><span style="color:#2aa198">"i_time"</span><span style="color:#839496">, </span><span style="color:#268bd2">Infected_vect</span><span style="color:#839496">[</span><span style="color:#268bd2">i</span><span style="color:#839496">] ,value</span><span style="color:#859900">=</span><span style="color:#839496"> </span><span style="color:#268bd2">n_d</span><span style="color:#839496"> )</span></span>
<span class="line"><span style="color:#839496">  }</span></span>
<span class="line"><span style="color:#839496">  stat_days(</span><span style="color:#268bd2">igraph</span><span style="color:#839496">)</span></span>
<span class="line"><span style="color:#839496">  </span><span style="color:#268bd2">igraph</span></span>
<span class="line"><span style="color:#839496">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#268bd2">infected_heal</span><span style="color:#839496"> </span><span style="color:#859900">&lt;-</span><span style="color:#839496"> </span><span style="color:#859900">function</span><span style="color:#839496">(</span><span style="color:#268bd2">igraph</span><span style="color:#839496">)</span></span>
<span class="line"><span style="color:#839496">{</span></span>
<span class="line"><span style="color:#839496">  </span><span style="color:#268bd2">nb_node</span><span style="color:#839496"> </span><span style="color:#859900">&lt;-</span><span style="color:#839496"> vcount(</span><span style="color:#268bd2">igraph</span><span style="color:#839496">)</span></span>
<span class="line"><span style="color:#839496">  </span><span style="color:#859900">for</span><span style="color:#839496">( </span><span style="color:#268bd2">i</span><span style="color:#839496"> </span><span style="color:#859900">in</span><span style="color:#839496"> </span><span style="color:#d33682">1</span><span style="color:#859900">:</span><span style="color:#839496"> </span><span style="color:#268bd2">nb_node</span><span style="color:#839496">)</span></span>
<span class="line"><span style="color:#839496">  {</span></span>
<span class="line"><span style="color:#839496">    </span><span style="color:#268bd2">node_time_status</span><span style="color:#839496"> </span><span style="color:#859900">&lt;-</span><span style="color:#839496"> get.vertex.attribute(</span><span style="color:#268bd2">igraph</span><span style="color:#839496">,</span><span style="color:#2aa198">"i_time"</span><span style="color:#839496">, </span><span style="color:#268bd2">i</span><span style="color:#839496">)</span></span>
<span class="line"><span style="color:#839496">    </span><span style="color:#859900">if</span><span style="color:#839496">( </span><span style="color:#268bd2">node_time_status</span><span style="color:#839496"> </span><span style="color:#859900">&gt;</span><span style="color:#839496"> </span><span style="color:#d33682">0</span><span style="color:#839496"> )</span></span>
<span class="line"><span style="color:#839496">    {</span></span>
<span class="line"><span style="color:#839496">      </span><span style="color:#268bd2">igraph</span><span style="color:#839496"> </span><span style="color:#859900">&lt;-</span><span style="color:#839496"> set.vertex.attribute(</span><span style="color:#268bd2">igraph</span><span style="color:#839496">,</span><span style="color:#2aa198">"i_time"</span><span style="color:#839496">, </span><span style="color:#268bd2">i</span><span style="color:#839496"> ,value</span><span style="color:#859900">=</span><span style="color:#839496"> (</span><span style="color:#268bd2">node_time_status</span><span style="color:#839496"> </span><span style="color:#859900">-</span><span style="color:#839496"> </span><span style="color:#d33682">1</span><span style="color:#839496">) )</span></span>
<span class="line"><span style="color:#839496">    }</span></span>
<span class="line"><span style="color:#839496">    </span><span style="color:#859900">if</span><span style="color:#839496">( </span><span style="color:#268bd2">node_time_status</span><span style="color:#839496"> </span><span style="color:#859900">==</span><span style="color:#839496"> </span><span style="color:#d33682">1</span><span style="color:#839496"> )</span></span>
<span class="line"><span style="color:#839496">    {</span></span>
<span class="line"><span style="color:#839496">      </span><span style="color:#268bd2">igraph</span><span style="color:#839496"> </span><span style="color:#859900">&lt;-</span><span style="color:#839496"> set.vertex.attribute(</span><span style="color:#268bd2">igraph</span><span style="color:#839496">,</span><span style="color:#2aa198">"epidemic"</span><span style="color:#839496">, </span><span style="color:#268bd2">i</span><span style="color:#839496"> ,value</span><span style="color:#859900">=</span><span style="color:#2aa198">"r"</span><span style="color:#839496">)</span></span>
<span class="line"><span style="color:#839496">    }</span></span>
<span class="line"><span style="color:#839496">  }</span></span>
<span class="line"><span style="color:#839496">  </span><span style="color:#268bd2">igraph</span></span>
<span class="line"><span style="color:#839496">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#268bd2">transmission</span><span style="color:#839496"> </span><span style="color:#859900">&lt;-</span><span style="color:#839496"> </span><span style="color:#859900">function</span><span style="color:#839496">(</span><span style="color:#268bd2">igraph</span><span style="color:#839496">,</span><span style="color:#268bd2">p_epidemic</span><span style="color:#839496">,</span><span style="color:#268bd2">n_d</span><span style="color:#839496">)</span></span>
<span class="line"><span style="color:#839496">{</span></span>
<span class="line"><span style="color:#839496">  </span><span style="color:#268bd2">igraph</span><span style="color:#839496"> </span><span style="color:#859900">&lt;-</span><span style="color:#839496"> infected_heal(</span><span style="color:#268bd2">igraph</span><span style="color:#839496">)</span></span>
<span class="line"><span style="color:#839496">  </span><span style="color:#268bd2">nb_node</span><span style="color:#839496"> </span><span style="color:#859900">&lt;-</span><span style="color:#839496"> vcount(</span><span style="color:#268bd2">igraph</span><span style="color:#839496">)</span></span>
<span class="line"><span style="color:#839496">  </span><span style="color:#268bd2">adj_mat</span><span style="color:#839496"> </span><span style="color:#859900">&lt;-</span><span style="color:#839496"> as_adjacency_matrix(</span><span style="color:#268bd2">igraph</span><span style="color:#839496">, type </span><span style="color:#859900">=</span><span style="color:#839496"> </span><span style="color:#268bd2">c</span><span style="color:#839496">(</span><span style="color:#2aa198">"both"</span><span style="color:#839496">))</span></span>
<span class="line"><span style="color:#839496">  </span><span style="color:#268bd2">vect_i</span><span style="color:#839496"> </span><span style="color:#859900">&lt;-</span><span style="color:#839496"> </span><span style="color:#268bd2">vector</span><span style="color:#839496">(mode </span><span style="color:#859900">=</span><span style="color:#839496"> </span><span style="color:#2aa198">"numeric"</span><span style="color:#839496">,</span><span style="color:#268bd2">nb_node</span><span style="color:#839496">)</span></span>
<span class="line"><span style="color:#839496">  </span><span style="color:#268bd2">vect_i_opo</span><span style="color:#839496"> </span><span style="color:#859900">&lt;-</span><span style="color:#839496"> </span><span style="color:#268bd2">vector</span><span style="color:#839496">(mode </span><span style="color:#859900">=</span><span style="color:#839496"> </span><span style="color:#2aa198">"numeric"</span><span style="color:#839496">,</span><span style="color:#268bd2">nb_node</span><span style="color:#839496">)</span></span>
<span class="line"><span style="color:#839496">  </span><span style="color:#859900">for</span><span style="color:#839496">(</span><span style="color:#268bd2">i</span><span style="color:#839496"> </span><span style="color:#859900">in</span><span style="color:#839496"> </span><span style="color:#d33682">1</span><span style="color:#859900">:</span><span style="color:#268bd2">nb_node</span><span style="color:#839496">)</span></span>
<span class="line"><span style="color:#839496">  {</span></span>
<span class="line"><span style="color:#839496">    </span><span style="color:#268bd2">node_status</span><span style="color:#839496"> </span><span style="color:#859900">&lt;-</span><span style="color:#839496"> get.vertex.attribute(</span><span style="color:#268bd2">igraph</span><span style="color:#839496">,</span><span style="color:#2aa198">"epidemic"</span><span style="color:#839496">, </span><span style="color:#268bd2">i</span><span style="color:#839496">)</span></span>
<span class="line"><span style="color:#839496">    </span><span style="color:#859900">if</span><span style="color:#839496">( </span><span style="color:#268bd2">node_status</span><span style="color:#839496"> </span><span style="color:#859900">==</span><span style="color:#839496"> </span><span style="color:#2aa198">"i"</span><span style="color:#839496"> )</span></span>
<span class="line"><span style="color:#839496">    {</span></span>
<span class="line"><span style="color:#839496">      </span><span style="color:#268bd2">vect_i</span><span style="color:#839496">[</span><span style="color:#268bd2">i</span><span style="color:#839496">] </span><span style="color:#859900">&lt;-</span><span style="color:#839496"> </span><span style="color:#d33682">1</span></span>
<span class="line"><span style="color:#839496">      </span><span style="color:#268bd2">vect_i_opo</span><span style="color:#839496">[</span><span style="color:#268bd2">i</span><span style="color:#839496">] </span><span style="color:#859900">&lt;-</span><span style="color:#839496"> </span><span style="color:#d33682">0</span></span>
<span class="line"><span style="color:#839496">    }</span></span>
<span class="line"><span style="color:#839496">    </span><span style="color:#859900">else</span></span>
<span class="line"><span style="color:#839496">    {</span></span>
<span class="line"><span style="color:#839496">      </span><span style="color:#268bd2">vect_i</span><span style="color:#839496">[</span><span style="color:#268bd2">i</span><span style="color:#839496">] </span><span style="color:#859900">&lt;-</span><span style="color:#839496"> </span><span style="color:#d33682">0</span></span>
<span class="line"><span style="color:#839496">      </span><span style="color:#268bd2">vect_i_opo</span><span style="color:#839496">[</span><span style="color:#268bd2">i</span><span style="color:#839496">] </span><span style="color:#859900">&lt;-</span><span style="color:#839496"> </span><span style="color:#d33682">1</span></span>
<span class="line"><span style="color:#839496">    }</span></span>
<span class="line"><span style="color:#839496">  }</span></span>
<span class="line"><span style="color:#839496">  </span><span style="color:#268bd2">vect_r_op</span><span style="color:#839496"> </span><span style="color:#859900">&lt;-</span><span style="color:#839496"> </span><span style="color:#268bd2">vector</span><span style="color:#839496">(mode </span><span style="color:#859900">=</span><span style="color:#839496"> </span><span style="color:#2aa198">"numeric"</span><span style="color:#839496">,</span><span style="color:#268bd2">nb_node</span><span style="color:#839496">)</span></span>
<span class="line"><span style="color:#839496">  </span><span style="color:#859900">for</span><span style="color:#839496">(</span><span style="color:#268bd2">i</span><span style="color:#839496"> </span><span style="color:#859900">in</span><span style="color:#839496"> </span><span style="color:#d33682">1</span><span style="color:#859900">:</span><span style="color:#268bd2">nb_node</span><span style="color:#839496">)</span></span>
<span class="line"><span style="color:#839496">  {</span></span>
<span class="line"><span style="color:#839496">    </span><span style="color:#268bd2">node_status</span><span style="color:#839496"> </span><span style="color:#859900">&lt;-</span><span style="color:#839496"> get.vertex.attribute(</span><span style="color:#268bd2">igraph</span><span style="color:#839496">,</span><span style="color:#2aa198">"epidemic"</span><span style="color:#839496">, </span><span style="color:#268bd2">i</span><span style="color:#839496">)</span></span>
<span class="line"><span style="color:#839496">    </span><span style="color:#859900">if</span><span style="color:#839496">( </span><span style="color:#268bd2">node_status</span><span style="color:#839496"> </span><span style="color:#859900">==</span><span style="color:#839496"> </span><span style="color:#2aa198">"r"</span><span style="color:#839496"> )</span></span>
<span class="line"><span style="color:#839496">    {</span></span>
<span class="line"><span style="color:#839496">      </span><span style="color:#268bd2">vect_r_op</span><span style="color:#839496">[</span><span style="color:#268bd2">i</span><span style="color:#839496">] </span><span style="color:#859900">&lt;-</span><span style="color:#839496"> </span><span style="color:#d33682">0</span></span>
<span class="line"><span style="color:#839496">    }</span></span>
<span class="line"><span style="color:#839496">    </span><span style="color:#859900">else</span></span>
<span class="line"><span style="color:#839496">    {</span></span>
<span class="line"><span style="color:#839496">      </span><span style="color:#268bd2">vect_r_op</span><span style="color:#839496">[</span><span style="color:#268bd2">i</span><span style="color:#839496">] </span><span style="color:#859900">&lt;-</span><span style="color:#839496"> </span><span style="color:#d33682">1</span></span>
<span class="line"><span style="color:#839496">    }</span></span>
<span class="line"><span style="color:#839496">  }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#839496">  </span><span style="color:#268bd2">neigbour_infected_vect</span><span style="color:#839496"> </span><span style="color:#859900">&lt;-</span><span style="color:#839496"> </span><span style="color:#268bd2">adj_mat</span><span style="color:#859900">%*%</span><span style="color:#268bd2">vect_i</span></span>
<span class="line"><span style="color:#839496">  </span><span style="color:#268bd2">try_infect</span><span style="color:#839496"> </span><span style="color:#859900">&lt;-</span><span style="color:#839496"> </span><span style="color:#268bd2">as.vector</span><span style="color:#839496">(</span><span style="color:#268bd2">neigbour_infected_vect</span><span style="color:#839496">)</span><span style="color:#859900">*</span><span style="color:#268bd2">vect_r_op</span><span style="color:#859900">*</span><span style="color:#268bd2">vect_i_opo</span></span>
<span class="line"><span style="color:#839496">  </span><span style="color:#859900">for</span><span style="color:#839496">(</span><span style="color:#268bd2">i</span><span style="color:#839496"> </span><span style="color:#859900">in</span><span style="color:#839496"> </span><span style="color:#d33682">1</span><span style="color:#859900">:</span><span style="color:#268bd2">nb_node</span><span style="color:#839496">)</span></span>
<span class="line"><span style="color:#839496">  {</span></span>
<span class="line"><span style="color:#839496">    </span><span style="color:#859900">if</span><span style="color:#839496">(</span><span style="color:#268bd2">try_infect</span><span style="color:#839496">[</span><span style="color:#268bd2">i</span><span style="color:#839496">] </span><span style="color:#859900">&gt;</span><span style="color:#839496"> </span><span style="color:#d33682">0</span><span style="color:#839496"> )</span></span>
<span class="line"><span style="color:#839496">    {</span></span>
<span class="line"><span style="color:#839496">      </span><span style="color:#859900">for</span><span style="color:#839496">(</span><span style="color:#268bd2">j</span><span style="color:#839496"> </span><span style="color:#859900">in</span><span style="color:#839496"> </span><span style="color:#d33682">1</span><span style="color:#859900">:</span><span style="color:#268bd2">try_infect</span><span style="color:#839496">[</span><span style="color:#268bd2">i</span><span style="color:#839496">] )</span></span>
<span class="line"><span style="color:#839496">      {</span></span>
<span class="line"><span style="color:#839496">        </span><span style="color:#859900">if</span><span style="color:#839496">(</span><span style="color:#268bd2">runif</span><span style="color:#839496">(</span><span style="color:#d33682">1</span><span style="color:#839496">) </span><span style="color:#859900">&lt;</span><span style="color:#839496"> </span><span style="color:#268bd2">p_epidemic</span><span style="color:#839496">)</span></span>
<span class="line"><span style="color:#839496">        {</span></span>
<span class="line"><span style="color:#839496">          </span><span style="color:#268bd2">igraph</span><span style="color:#839496"> </span><span style="color:#859900">&lt;-</span><span style="color:#839496"> set.vertex.attribute(</span><span style="color:#268bd2">igraph</span><span style="color:#839496">,</span><span style="color:#2aa198">"epidemic"</span><span style="color:#839496">, </span><span style="color:#268bd2">i</span><span style="color:#839496"> ,value</span><span style="color:#859900">=</span><span style="color:#2aa198">"i"</span><span style="color:#839496">)</span></span>
<span class="line"><span style="color:#839496">          </span><span style="color:#268bd2">igraph</span><span style="color:#839496"> </span><span style="color:#859900">&lt;-</span><span style="color:#839496"> set.vertex.attribute(</span><span style="color:#268bd2">igraph</span><span style="color:#839496">,</span><span style="color:#2aa198">"i_time"</span><span style="color:#839496">, </span><span style="color:#268bd2">i</span><span style="color:#839496"> ,value</span><span style="color:#859900">=</span><span style="color:#839496"> </span><span style="color:#268bd2">n_d</span><span style="color:#839496"> )</span></span>
<span class="line"><span style="color:#839496">        }</span></span>
<span class="line"><span style="color:#839496">      }</span></span>
<span class="line"><span style="color:#839496">    }</span></span>
<span class="line"><span style="color:#839496">  }</span></span>
<span class="line"><span style="color:#839496">  </span><span style="color:#859900">for</span><span style="color:#839496">(</span><span style="color:#268bd2">i</span><span style="color:#839496"> </span><span style="color:#859900">in</span><span style="color:#839496"> </span><span style="color:#d33682">1</span><span style="color:#859900">:</span><span style="color:#268bd2">nb_node</span><span style="color:#839496">)</span></span>
<span class="line"><span style="color:#839496">  {</span></span>
<span class="line"><span style="color:#839496">    </span><span style="color:#859900">if</span><span style="color:#839496">(</span><span style="color:#268bd2">try_infect</span><span style="color:#839496">[</span><span style="color:#268bd2">i</span><span style="color:#839496">] </span><span style="color:#859900">&gt;</span><span style="color:#839496"> </span><span style="color:#d33682">0</span><span style="color:#839496"> )</span></span>
<span class="line"><span style="color:#839496">    {</span></span>
<span class="line"><span style="color:#839496">      </span><span style="color:#859900">for</span><span style="color:#839496">(</span><span style="color:#268bd2">j</span><span style="color:#839496"> </span><span style="color:#859900">in</span><span style="color:#839496"> </span><span style="color:#d33682">1</span><span style="color:#859900">:</span><span style="color:#268bd2">try_infect</span><span style="color:#839496">[</span><span style="color:#268bd2">i</span><span style="color:#839496">] )</span></span>
<span class="line"><span style="color:#839496">      {</span></span>
<span class="line"><span style="color:#839496">        </span><span style="color:#859900">if</span><span style="color:#839496">(</span><span style="color:#268bd2">runif</span><span style="color:#839496">(</span><span style="color:#d33682">1</span><span style="color:#839496">) </span><span style="color:#859900">&lt;</span><span style="color:#839496"> </span><span style="color:#268bd2">p_epidemic</span><span style="color:#839496">)</span></span>
<span class="line"><span style="color:#839496">        {</span></span>
<span class="line"><span style="color:#839496">          </span><span style="color:#268bd2">igraph</span><span style="color:#839496"> </span><span style="color:#859900">&lt;-</span><span style="color:#839496"> set.vertex.attribute(</span><span style="color:#268bd2">igraph</span><span style="color:#839496">,</span><span style="color:#2aa198">"epidemic"</span><span style="color:#839496">, </span><span style="color:#268bd2">i</span><span style="color:#839496"> ,value</span><span style="color:#859900">=</span><span style="color:#2aa198">"i"</span><span style="color:#839496">)</span></span>
<span class="line"><span style="color:#839496">          </span><span style="color:#268bd2">igraph</span><span style="color:#839496"> </span><span style="color:#859900">&lt;-</span><span style="color:#839496"> set.vertex.attribute(</span><span style="color:#268bd2">igraph</span><span style="color:#839496">,</span><span style="color:#2aa198">"i_time"</span><span style="color:#839496">, </span><span style="color:#268bd2">i</span><span style="color:#839496"> ,value</span><span style="color:#859900">=</span><span style="color:#839496"> </span><span style="color:#268bd2">n_d</span><span style="color:#839496"> )</span></span>
<span class="line"><span style="color:#839496">        }</span></span>
<span class="line"><span style="color:#839496">      }</span></span>
<span class="line"><span style="color:#839496">    }</span></span>
<span class="line"><span style="color:#839496">  }</span></span>
<span class="line"><span style="color:#839496">  </span><span style="color:#268bd2">igraph</span></span>
<span class="line"><span style="color:#839496">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#268bd2">stat_days</span><span style="color:#839496"> </span><span style="color:#859900">&lt;-</span><span style="color:#839496"> </span><span style="color:#859900">function</span><span style="color:#839496">(</span><span style="color:#268bd2">igraph</span><span style="color:#839496">)</span></span>
<span class="line"><span style="color:#839496">{</span></span>
<span class="line"><span style="color:#839496">  </span><span style="color:#268bd2">nb_node</span><span style="color:#839496"> </span><span style="color:#859900">&lt;-</span><span style="color:#839496"> vcount(</span><span style="color:#268bd2">igraph</span><span style="color:#839496">)</span></span>
<span class="line"><span style="color:#839496">  </span><span style="color:#268bd2">tot_i</span><span style="color:#839496"> </span><span style="color:#859900">&lt;-</span><span style="color:#839496"> </span><span style="color:#d33682">0</span></span>
<span class="line"><span style="color:#839496">  </span><span style="color:#268bd2">tot_s</span><span style="color:#839496"> </span><span style="color:#859900">&lt;-</span><span style="color:#839496"> </span><span style="color:#d33682">0</span></span>
<span class="line"><span style="color:#839496">  </span><span style="color:#268bd2">tot_r</span><span style="color:#839496"> </span><span style="color:#859900">&lt;-</span><span style="color:#839496"> </span><span style="color:#d33682">0</span></span>
<span class="line"><span style="color:#839496">  </span><span style="color:#268bd2">res</span><span style="color:#839496"> </span><span style="color:#859900">&lt;-</span><span style="color:#839496"> </span><span style="color:#268bd2">vector</span><span style="color:#839496">(mode </span><span style="color:#859900">=</span><span style="color:#839496"> </span><span style="color:#2aa198">"numeric"</span><span style="color:#839496">)</span></span>
<span class="line"><span style="color:#839496">  </span><span style="color:#859900">for</span><span style="color:#839496">(</span><span style="color:#268bd2">i</span><span style="color:#839496"> </span><span style="color:#859900">in</span><span style="color:#839496"> </span><span style="color:#d33682">1</span><span style="color:#859900">:</span><span style="color:#268bd2">nb_node</span><span style="color:#839496">)</span></span>
<span class="line"><span style="color:#839496">  {</span></span>
<span class="line"><span style="color:#839496">    </span><span style="color:#268bd2">epi</span><span style="color:#839496"> </span><span style="color:#859900">&lt;-</span><span style="color:#839496"> get.vertex.attribute(</span><span style="color:#268bd2">igraph</span><span style="color:#839496">,</span><span style="color:#2aa198">"epidemic"</span><span style="color:#839496">, </span><span style="color:#268bd2">i</span><span style="color:#839496"> )</span></span>
<span class="line"><span style="color:#839496">    </span><span style="color:#859900">if</span><span style="color:#839496">(</span><span style="color:#268bd2">epi</span><span style="color:#839496"> </span><span style="color:#859900">==</span><span style="color:#839496"> </span><span style="color:#2aa198">"i"</span><span style="color:#839496"> )</span></span>
<span class="line"><span style="color:#839496">    {</span></span>
<span class="line"><span style="color:#839496">      </span><span style="color:#268bd2">tot_i</span><span style="color:#839496"> </span><span style="color:#859900">&lt;-</span><span style="color:#839496"> </span><span style="color:#268bd2">tot_i</span><span style="color:#839496"> </span><span style="color:#859900">+</span><span style="color:#839496"> </span><span style="color:#d33682">1</span></span>
<span class="line"><span style="color:#839496">    }</span></span>
<span class="line"><span style="color:#839496">    </span><span style="color:#859900">if</span><span style="color:#839496">(</span><span style="color:#268bd2">epi</span><span style="color:#839496"> </span><span style="color:#859900">==</span><span style="color:#839496"> </span><span style="color:#2aa198">"s"</span><span style="color:#839496"> )</span></span>
<span class="line"><span style="color:#839496">    {</span></span>
<span class="line"><span style="color:#839496">      </span><span style="color:#268bd2">tot_s</span><span style="color:#839496"> </span><span style="color:#859900">&lt;-</span><span style="color:#839496"> </span><span style="color:#268bd2">tot_s</span><span style="color:#839496"> </span><span style="color:#859900">+</span><span style="color:#839496"> </span><span style="color:#d33682">1</span></span>
<span class="line"><span style="color:#839496">    }</span></span>
<span class="line"><span style="color:#839496">    </span><span style="color:#859900">if</span><span style="color:#839496">(</span><span style="color:#268bd2">epi</span><span style="color:#839496"> </span><span style="color:#859900">==</span><span style="color:#839496"> </span><span style="color:#2aa198">"r"</span><span style="color:#839496"> )</span></span>
<span class="line"><span style="color:#839496">    {</span></span>
<span class="line"><span style="color:#839496">      </span><span style="color:#268bd2">tot_r</span><span style="color:#839496"> </span><span style="color:#859900">&lt;-</span><span style="color:#839496"> </span><span style="color:#268bd2">tot_r</span><span style="color:#839496"> </span><span style="color:#859900">+</span><span style="color:#839496"> </span><span style="color:#d33682">1</span></span>
<span class="line"><span style="color:#839496">    }</span></span>
<span class="line"><span style="color:#839496">  }</span></span>
<span class="line"><span style="color:#839496">  </span><span style="color:#268bd2">res</span><span style="color:#839496">[</span><span style="color:#d33682">1</span><span style="color:#839496">] </span><span style="color:#859900">&lt;-</span><span style="color:#839496"> </span><span style="color:#268bd2">tot_i</span></span>
<span class="line"><span style="color:#839496">  </span><span style="color:#268bd2">res</span><span style="color:#839496">[</span><span style="color:#d33682">2</span><span style="color:#839496">] </span><span style="color:#859900">&lt;-</span><span style="color:#839496"> </span><span style="color:#268bd2">tot_s</span></span>
<span class="line"><span style="color:#839496">  </span><span style="color:#268bd2">res</span><span style="color:#839496">[</span><span style="color:#d33682">3</span><span style="color:#839496">] </span><span style="color:#859900">&lt;-</span><span style="color:#839496"> </span><span style="color:#268bd2">tot_r</span></span>
<span class="line"><span style="color:#839496">  </span><span style="color:#268bd2">cat</span><span style="color:#839496">(</span><span style="color:#2aa198">"Sucesptible: "</span><span style="color:#839496">,</span><span style="color:#268bd2">res</span><span style="color:#839496">[</span><span style="color:#d33682">2</span><span style="color:#839496">],</span><span style="color:#2aa198">" Infected: "</span><span style="color:#839496">,</span><span style="color:#268bd2">res</span><span style="color:#839496">[</span><span style="color:#d33682">1</span><span style="color:#839496">],</span><span style="color:#2aa198">"Recoverd: "</span><span style="color:#839496">,</span><span style="color:#268bd2">res</span><span style="color:#839496">[</span><span style="color:#d33682">3</span><span style="color:#839496">],</span><span style="color:#2aa198">"</span><span style="color:#cb4b16">\n</span><span style="color:#2aa198">"</span><span style="color:#839496">)</span></span>
<span class="line"><span style="color:#839496">  </span><span style="color:#268bd2">res</span></span>
<span class="line"><span style="color:#839496">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#268bd2">simulation</span><span style="color:#839496"> </span><span style="color:#859900">&lt;-</span><span style="color:#839496"> </span><span style="color:#859900">function</span><span style="color:#839496">(</span><span style="color:#268bd2">igraph</span><span style="color:#839496">,</span><span style="color:#268bd2">p_epidemic</span><span style="color:#839496">,</span><span style="color:#268bd2">n_d</span><span style="color:#839496">,</span><span style="color:#268bd2">time</span><span style="color:#839496">,</span><span style="color:#268bd2">confinement_high</span><span style="color:#839496">,</span><span style="color:#268bd2">confinement_low</span><span style="color:#839496">,</span><span style="color:#268bd2">restriction_percentages</span><span style="color:#839496">,</span><span style="color:#268bd2">travel_limitation</span><span style="color:#839496">)</span></span>
<span class="line"><span style="color:#839496">{</span></span>
<span class="line"><span style="color:#839496">  </span><span style="color:#268bd2">cat</span><span style="color:#839496">(</span><span style="color:#2aa198">"Begin simulation </span><span style="color:#cb4b16">\n</span><span style="color:#2aa198">"</span><span style="color:#839496">)</span></span>
<span class="line"><span style="color:#839496">  </span><span style="color:#268bd2">init_graph</span><span style="color:#839496"> </span><span style="color:#859900">&lt;-</span><span style="color:#839496"> </span><span style="color:#268bd2">igraph</span></span>
<span class="line"><span style="color:#839496">  </span><span style="color:#268bd2">mat_res</span><span style="color:#839496"> </span><span style="color:#859900">&lt;-</span><span style="color:#839496"> </span><span style="color:#268bd2">matrix</span><span style="color:#839496">(ncol </span><span style="color:#859900">=</span><span style="color:#839496"> </span><span style="color:#268bd2">time</span><span style="color:#859900">+</span><span style="color:#d33682">1</span><span style="color:#839496">,nrow </span><span style="color:#859900">=</span><span style="color:#839496"> </span><span style="color:#d33682">3</span><span style="color:#839496"> )</span></span>
<span class="line"><span style="color:#839496">  </span><span style="color:#268bd2">mat_res</span><span style="color:#839496">[,</span><span style="color:#d33682">1</span><span style="color:#839496"> ] </span><span style="color:#859900">&lt;-</span><span style="color:#839496"> stat_days(</span><span style="color:#268bd2">igraph</span><span style="color:#839496">)</span></span>
<span class="line"><span style="color:#839496">  </span><span style="color:#859900">if</span><span style="color:#839496">(</span><span style="color:#268bd2">travel_limitation</span><span style="color:#839496"> </span><span style="color:#859900">==</span><span style="color:#839496"> </span><span style="color:#b58900">TRUE</span><span style="color:#839496"> )</span></span>
<span class="line"><span style="color:#839496">  {</span></span>
<span class="line"><span style="color:#839496">    </span><span style="color:#268bd2">restrictions</span><span style="color:#839496"> </span><span style="color:#859900">&lt;-</span><span style="color:#839496"> </span><span style="color:#b58900">FALSE</span></span>
<span class="line"><span style="color:#839496">    </span><span style="color:#859900">for</span><span style="color:#839496">(</span><span style="color:#268bd2">i</span><span style="color:#839496"> </span><span style="color:#859900">in</span><span style="color:#839496"> </span><span style="color:#d33682">1</span><span style="color:#859900">:</span><span style="color:#268bd2">time</span><span style="color:#839496"> )</span></span>
<span class="line"><span style="color:#839496">    {</span></span>
<span class="line"><span style="color:#839496">      </span><span style="color:#268bd2">strday</span><span style="color:#839496"> </span><span style="color:#859900">&lt;-</span><span style="color:#839496"> </span><span style="color:#268bd2">c</span><span style="color:#839496">(</span><span style="color:#2aa198">"Day N"</span><span style="color:#839496">,</span><span style="color:#268bd2">toString</span><span style="color:#839496">(</span><span style="color:#268bd2">i</span><span style="color:#839496">))</span></span>
<span class="line"><span style="color:#839496">      </span><span style="color:#268bd2">cat</span><span style="color:#839496">(</span><span style="color:#268bd2">strday</span><span style="color:#839496">,</span><span style="color:#2aa198">"</span><span style="color:#cb4b16">\n</span><span style="color:#2aa198">"</span><span style="color:#839496">)</span></span>
<span class="line"><span style="color:#839496">      </span><span style="color:#268bd2">igraph</span><span style="color:#839496"> </span><span style="color:#859900">&lt;-</span><span style="color:#839496"> transmission(</span><span style="color:#268bd2">igraph</span><span style="color:#839496">,</span><span style="color:#268bd2">p_epidemic</span><span style="color:#839496">,</span><span style="color:#268bd2">n_d</span><span style="color:#839496">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#839496">      </span><span style="color:#859900">if</span><span style="color:#839496">(</span><span style="color:#268bd2">restrictions</span><span style="color:#839496"> </span><span style="color:#859900">==</span><span style="color:#839496"> </span><span style="color:#b58900">FALSE</span><span style="color:#839496"> </span><span style="color:#859900">&amp;&amp;</span><span style="color:#839496"> confine_required(</span><span style="color:#268bd2">igraph</span><span style="color:#839496">,</span><span style="color:#268bd2">confinement_high</span><span style="color:#839496">,</span><span style="color:#268bd2">confinement_low</span><span style="color:#839496">,</span><span style="color:#268bd2">restrictions</span><span style="color:#839496">) </span><span style="color:#859900">==</span><span style="color:#839496"> </span><span style="color:#b58900">TRUE</span><span style="color:#839496">  )</span></span>
<span class="line"><span style="color:#839496">      {</span></span>
<span class="line"><span style="color:#839496">        </span><span style="color:#268bd2">cat</span><span style="color:#839496">(</span><span style="color:#2aa198">"Day of limitations implemention</span><span style="color:#cb4b16">\n</span><span style="color:#2aa198">"</span><span style="color:#839496">)</span></span>
<span class="line"><span style="color:#839496">        </span><span style="color:#268bd2">igraph</span><span style="color:#839496"> </span><span style="color:#859900">&lt;-</span><span style="color:#839496"> graph_with_restrictions(</span><span style="color:#268bd2">igraph</span><span style="color:#839496">,</span><span style="color:#268bd2">restriction_percentages</span><span style="color:#839496">)</span></span>
<span class="line"><span style="color:#839496">        </span><span style="color:#268bd2">restrictions</span><span style="color:#839496"> </span><span style="color:#859900">&lt;-</span><span style="color:#839496"> </span><span style="color:#b58900">TRUE</span></span>
<span class="line"><span style="color:#839496">      }</span></span>
<span class="line"><span style="color:#839496">      </span><span style="color:#859900">if</span><span style="color:#839496">(</span><span style="color:#268bd2">restrictions</span><span style="color:#839496"> </span><span style="color:#859900">==</span><span style="color:#839496"> </span><span style="color:#b58900">TRUE</span><span style="color:#839496"> </span><span style="color:#859900">&amp;&amp;</span><span style="color:#839496"> confine_required(</span><span style="color:#268bd2">igraph</span><span style="color:#839496">,</span><span style="color:#268bd2">confinement_high</span><span style="color:#839496">,</span><span style="color:#268bd2">confinement_low</span><span style="color:#839496">,</span><span style="color:#268bd2">restrictions</span><span style="color:#839496">) </span><span style="color:#859900">==</span><span style="color:#839496"> </span><span style="color:#b58900">FALSE</span><span style="color:#839496">  )</span></span>
<span class="line"><span style="color:#839496">      {</span></span>
<span class="line"><span style="color:#839496">        </span><span style="color:#268bd2">cat</span><span style="color:#839496">(</span><span style="color:#2aa198">"Day of UNDO limitations implemention</span><span style="color:#cb4b16">\n</span><span style="color:#2aa198">"</span><span style="color:#839496">)</span></span>
<span class="line"><span style="color:#839496">        </span><span style="color:#268bd2">igraph</span><span style="color:#839496"> </span><span style="color:#859900">&lt;-</span><span style="color:#839496"> undo_graph_with_restrictions(</span><span style="color:#268bd2">igraph</span><span style="color:#839496">,</span><span style="color:#268bd2">init_graph</span><span style="color:#839496">)</span></span>
<span class="line"><span style="color:#839496">        </span><span style="color:#268bd2">restrictions</span><span style="color:#839496"> </span><span style="color:#859900">&lt;-</span><span style="color:#839496"> </span><span style="color:#b58900">FALSE</span></span>
<span class="line"><span style="color:#839496">      }</span></span>
<span class="line"><span style="color:#839496">      </span><span style="color:#268bd2">restrans</span><span style="color:#839496"> </span><span style="color:#859900">&lt;-</span><span style="color:#839496"> stat_days(</span><span style="color:#268bd2">igraph</span><span style="color:#839496">)</span></span>
<span class="line"><span style="color:#839496">      </span><span style="color:#268bd2">mat_res</span><span style="color:#839496">[, (</span><span style="color:#268bd2">i</span><span style="color:#859900">+</span><span style="color:#d33682">1</span><span style="color:#839496">) ] </span><span style="color:#859900">&lt;-</span><span style="color:#839496"> </span><span style="color:#268bd2">restrans</span></span>
<span class="line"><span style="color:#839496">    }</span></span>
<span class="line"><span style="color:#839496">  }</span><span style="color:#859900">else</span><span style="color:#839496"> </span><span style="color:#859900">if</span><span style="color:#839496">(</span><span style="color:#268bd2">travel_limitation</span><span style="color:#839496"> </span><span style="color:#859900">==</span><span style="color:#839496"> </span><span style="color:#b58900">FALSE</span><span style="color:#839496"> ){</span></span>
<span class="line"><span style="color:#839496">    </span><span style="color:#859900">for</span><span style="color:#839496">(</span><span style="color:#268bd2">i</span><span style="color:#839496"> </span><span style="color:#859900">in</span><span style="color:#839496"> </span><span style="color:#d33682">1</span><span style="color:#859900">:</span><span style="color:#268bd2">time</span><span style="color:#839496"> )</span></span>
<span class="line"><span style="color:#839496">    {</span></span>
<span class="line"><span style="color:#839496">      </span><span style="color:#268bd2">strday</span><span style="color:#839496"> </span><span style="color:#859900">&lt;-</span><span style="color:#839496"> </span><span style="color:#268bd2">c</span><span style="color:#839496">(</span><span style="color:#2aa198">"Day N"</span><span style="color:#839496">,</span><span style="color:#268bd2">toString</span><span style="color:#839496">(</span><span style="color:#268bd2">i</span><span style="color:#839496">))</span></span>
<span class="line"><span style="color:#839496">      </span><span style="color:#268bd2">cat</span><span style="color:#839496">(</span><span style="color:#268bd2">strday</span><span style="color:#839496">,</span><span style="color:#2aa198">"</span><span style="color:#cb4b16">\n</span><span style="color:#2aa198">"</span><span style="color:#839496">)</span></span>
<span class="line"><span style="color:#839496">      </span><span style="color:#268bd2">igraph</span><span style="color:#839496"> </span><span style="color:#859900">&lt;-</span><span style="color:#839496"> transmission(</span><span style="color:#268bd2">igraph</span><span style="color:#839496">,</span><span style="color:#268bd2">p_epidemic</span><span style="color:#839496">,</span><span style="color:#268bd2">n_d</span><span style="color:#839496">)</span></span>
<span class="line"><span style="color:#839496">      </span><span style="color:#268bd2">restrans</span><span style="color:#839496"> </span><span style="color:#859900">&lt;-</span><span style="color:#839496"> stat_days(</span><span style="color:#268bd2">igraph</span><span style="color:#839496">)</span></span>
<span class="line"><span style="color:#839496">      </span><span style="color:#268bd2">mat_res</span><span style="color:#839496">[, (</span><span style="color:#268bd2">i</span><span style="color:#859900">+</span><span style="color:#d33682">1</span><span style="color:#839496">) ] </span><span style="color:#859900">&lt;-</span><span style="color:#839496"> </span><span style="color:#268bd2">restrans</span></span>
<span class="line"><span style="color:#839496">    }</span></span>
<span class="line"><span style="color:#839496">  }</span></span>
<span class="line"><span style="color:#839496">  </span><span style="color:#268bd2">mat_res</span></span>
<span class="line"><span style="color:#839496">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#268bd2">undo_graph_with_restrictions</span><span style="color:#839496"> </span><span style="color:#859900">&lt;-</span><span style="color:#839496"> </span><span style="color:#859900">function</span><span style="color:#839496">(</span><span style="color:#268bd2">graph_now</span><span style="color:#839496">,</span><span style="color:#268bd2">graph_init</span><span style="color:#839496">){</span></span>
<span class="line"><span style="color:#839496">  </span><span style="color:#268bd2">nb_node</span><span style="color:#839496"> </span><span style="color:#859900">&lt;-</span><span style="color:#839496"> vcount(</span><span style="color:#268bd2">graph_now</span><span style="color:#839496">)</span></span>
<span class="line"><span style="color:#839496">  </span><span style="color:#859900">for</span><span style="color:#839496">( </span><span style="color:#268bd2">i</span><span style="color:#839496"> </span><span style="color:#859900">in</span><span style="color:#839496"> </span><span style="color:#d33682">1</span><span style="color:#859900">:</span><span style="color:#839496"> </span><span style="color:#268bd2">nb_node</span><span style="color:#839496">)</span></span>
<span class="line"><span style="color:#839496">  {</span></span>
<span class="line"><span style="color:#839496">    </span><span style="color:#268bd2">epi</span><span style="color:#839496"> </span><span style="color:#859900">&lt;-</span><span style="color:#839496"> get.vertex.attribute(</span><span style="color:#268bd2">graph_now</span><span style="color:#839496">,</span><span style="color:#2aa198">"epidemic"</span><span style="color:#839496">, </span><span style="color:#268bd2">i</span><span style="color:#839496"> )</span></span>
<span class="line"><span style="color:#839496">    </span><span style="color:#268bd2">itime</span><span style="color:#839496"> </span><span style="color:#859900">&lt;-</span><span style="color:#839496"> get.vertex.attribute(</span><span style="color:#268bd2">graph_now</span><span style="color:#839496">,</span><span style="color:#2aa198">"i_time"</span><span style="color:#839496">, </span><span style="color:#268bd2">i</span><span style="color:#839496"> )</span></span>
<span class="line"><span style="color:#839496">    </span><span style="color:#268bd2">graph_init</span><span style="color:#839496"> </span><span style="color:#859900">&lt;-</span><span style="color:#839496"> set.vertex.attribute(</span><span style="color:#268bd2">graph_init</span><span style="color:#839496">,</span><span style="color:#2aa198">"epidemic"</span><span style="color:#839496">, </span><span style="color:#268bd2">i</span><span style="color:#839496"> ,value</span><span style="color:#859900">=</span><span style="color:#268bd2">epi</span><span style="color:#839496">)</span></span>
<span class="line"><span style="color:#839496">    </span><span style="color:#268bd2">graph_init</span><span style="color:#839496"> </span><span style="color:#859900">&lt;-</span><span style="color:#839496"> set.vertex.attribute(</span><span style="color:#268bd2">graph_init</span><span style="color:#839496">,</span><span style="color:#2aa198">"i_time"</span><span style="color:#839496">, </span><span style="color:#268bd2">i</span><span style="color:#839496"> ,value</span><span style="color:#859900">=</span><span style="color:#268bd2">itime</span><span style="color:#839496">)</span></span>
<span class="line"><span style="color:#839496">  }</span></span>
<span class="line"><span style="color:#839496">  </span><span style="color:#268bd2">graph_init</span></span>
<span class="line"><span style="color:#839496">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#268bd2">graph_with_restrictions</span><span style="color:#839496"> </span><span style="color:#859900">&lt;-</span><span style="color:#839496"> </span><span style="color:#859900">function</span><span style="color:#839496">(</span><span style="color:#268bd2">igraph</span><span style="color:#839496">,</span><span style="color:#268bd2">restriction_percentages</span><span style="color:#839496">){</span></span>
<span class="line"><span style="color:#839496">  </span><span style="color:#268bd2">edge_lst</span><span style="color:#839496"> </span><span style="color:#859900">&lt;-</span><span style="color:#839496"> as_edgelist(</span><span style="color:#268bd2">igraph</span><span style="color:#839496">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#839496">  </span><span style="color:#268bd2">delete_vect</span><span style="color:#839496"> </span><span style="color:#859900">&lt;-</span><span style="color:#839496"> </span><span style="color:#268bd2">runif</span><span style="color:#839496">(</span><span style="color:#268bd2">nrow</span><span style="color:#839496">(</span><span style="color:#268bd2">edge_lst</span><span style="color:#839496">))</span></span>
<span class="line"><span style="color:#839496">  </span><span style="color:#268bd2">vect_bind</span><span style="color:#839496"> </span><span style="color:#859900">&lt;-</span><span style="color:#839496"> </span><span style="color:#268bd2">vector</span><span style="color:#839496">(mode </span><span style="color:#859900">=</span><span style="color:#839496"> </span><span style="color:#2aa198">"numeric"</span><span style="color:#839496">,</span><span style="color:#268bd2">nrow</span><span style="color:#839496">(</span><span style="color:#268bd2">edge_lst</span><span style="color:#839496">))</span></span>
<span class="line"><span style="color:#839496">  </span><span style="color:#859900">for</span><span style="color:#839496">(</span><span style="color:#268bd2">i</span><span style="color:#839496"> </span><span style="color:#859900">in</span><span style="color:#839496"> </span><span style="color:#268bd2">nrow</span><span style="color:#839496">(</span><span style="color:#268bd2">edge_lst</span><span style="color:#839496">)</span><span style="color:#859900">:</span><span style="color:#d33682">1</span><span style="color:#839496"> )</span></span>
<span class="line"><span style="color:#839496">  {</span></span>
<span class="line"><span style="color:#839496">    </span><span style="color:#859900">if</span><span style="color:#839496">( </span><span style="color:#268bd2">delete_vect</span><span style="color:#839496">[</span><span style="color:#268bd2">i</span><span style="color:#839496">] </span><span style="color:#859900">&gt;</span><span style="color:#839496"> (</span><span style="color:#268bd2">restriction_percentages</span><span style="color:#859900">/</span><span style="color:#d33682">100</span><span style="color:#839496">)  )</span></span>
<span class="line"><span style="color:#839496">    {</span></span>
<span class="line"><span style="color:#839496">       </span><span style="color:#586e75;font-style:italic">#edge_lst[i,3] &lt;- 0</span></span>
<span class="line"><span style="color:#839496">      </span><span style="color:#268bd2">vect_bind</span><span style="color:#839496">[</span><span style="color:#268bd2">i</span><span style="color:#839496">] </span><span style="color:#859900">&lt;-</span><span style="color:#839496"> </span><span style="color:#d33682">0</span></span>
<span class="line"><span style="color:#839496">    }</span><span style="color:#859900">else</span><span style="color:#839496">{</span></span>
<span class="line"><span style="color:#839496">      </span><span style="color:#268bd2">vect_bind</span><span style="color:#839496">[</span><span style="color:#268bd2">i</span><span style="color:#839496">] </span><span style="color:#859900">&lt;-</span><span style="color:#839496"> </span><span style="color:#d33682">1</span></span>
<span class="line"><span style="color:#839496">      </span><span style="color:#586e75;font-style:italic">#edge_lst[i,3] &lt;- 1</span></span>
<span class="line"><span style="color:#839496">    }</span></span>
<span class="line"><span style="color:#839496">  }</span></span>
<span class="line"><span style="color:#839496">  </span><span style="color:#268bd2">edge_lst</span><span style="color:#839496"> </span><span style="color:#859900">&lt;-</span><span style="color:#839496"> </span><span style="color:#268bd2">cbind</span><span style="color:#839496">(</span><span style="color:#268bd2">edge_lst</span><span style="color:#839496">,</span><span style="color:#268bd2">vect_bind</span><span style="color:#839496">)</span></span>
<span class="line"><span style="color:#839496">  </span><span style="color:#859900">for</span><span style="color:#839496">(</span><span style="color:#268bd2">i</span><span style="color:#839496"> </span><span style="color:#859900">in</span><span style="color:#839496"> </span><span style="color:#268bd2">nrow</span><span style="color:#839496">(</span><span style="color:#268bd2">edge_lst</span><span style="color:#839496">)</span><span style="color:#859900">:</span><span style="color:#d33682">1</span><span style="color:#839496"> )</span></span>
<span class="line"><span style="color:#839496">  {</span></span>
<span class="line"><span style="color:#839496">    </span><span style="color:#586e75;font-style:italic">#cat("del? \t",i,"\t",edge_lst[i,3])</span></span>
<span class="line"><span style="color:#839496">    </span><span style="color:#859900">if</span><span style="color:#839496">(</span><span style="color:#268bd2">edge_lst</span><span style="color:#839496">[</span><span style="color:#268bd2">i</span><span style="color:#839496">,</span><span style="color:#d33682">3</span><span style="color:#839496">] </span><span style="color:#859900">==</span><span style="color:#839496"> </span><span style="color:#d33682">1</span><span style="color:#839496">)</span></span>
<span class="line"><span style="color:#839496">    {</span></span>
<span class="line"><span style="color:#839496">      </span><span style="color:#586e75;font-style:italic">#cat("We sup\n")</span></span>
<span class="line"><span style="color:#839496">      </span><span style="color:#268bd2">edge_lst</span><span style="color:#839496"> </span><span style="color:#859900">&lt;-</span><span style="color:#839496"> </span><span style="color:#268bd2">edge_lst</span><span style="color:#839496">[</span><span style="color:#859900">-</span><span style="color:#268bd2">i</span><span style="color:#839496">,]</span></span>
<span class="line"><span style="color:#839496">    }</span><span style="color:#859900">else</span><span style="color:#839496">{</span></span>
<span class="line"><span style="color:#839496">      </span><span style="color:#586e75;font-style:italic">#cat("\n")</span></span>
<span class="line"><span style="color:#839496">    }</span></span>
<span class="line"><span style="color:#839496">  }</span></span>
<span class="line"><span style="color:#839496">  </span><span style="color:#268bd2">edge_lst</span><span style="color:#839496"> </span><span style="color:#859900">&lt;-</span><span style="color:#839496"> </span><span style="color:#268bd2">edge_lst</span><span style="color:#839496">[,</span><span style="color:#859900">-</span><span style="color:#d33682">3</span><span style="color:#839496">]</span></span>
<span class="line"><span style="color:#839496">  </span><span style="color:#268bd2">limited_graph</span><span style="color:#839496"> </span><span style="color:#859900">&lt;-</span><span style="color:#839496"> graph_from_edgelist(</span><span style="color:#268bd2">edge_lst</span><span style="color:#839496">, directed </span><span style="color:#859900">=</span><span style="color:#839496"> </span><span style="color:#b58900">FALSE</span><span style="color:#839496">)</span></span>
<span class="line"><span style="color:#839496">  </span><span style="color:#268bd2">nb_node</span><span style="color:#839496"> </span><span style="color:#859900">&lt;-</span><span style="color:#839496"> vcount(</span><span style="color:#268bd2">igraph</span><span style="color:#839496">)</span></span>
<span class="line"><span style="color:#839496">  </span><span style="color:#859900">for</span><span style="color:#839496">( </span><span style="color:#268bd2">i</span><span style="color:#839496"> </span><span style="color:#859900">in</span><span style="color:#839496"> </span><span style="color:#d33682">1</span><span style="color:#859900">:</span><span style="color:#839496"> </span><span style="color:#268bd2">nb_node</span><span style="color:#839496">)</span></span>
<span class="line"><span style="color:#839496">  {</span></span>
<span class="line"><span style="color:#839496">    </span><span style="color:#268bd2">epi</span><span style="color:#839496"> </span><span style="color:#859900">&lt;-</span><span style="color:#839496"> get.vertex.attribute(</span><span style="color:#268bd2">igraph</span><span style="color:#839496">,</span><span style="color:#2aa198">"epidemic"</span><span style="color:#839496">, </span><span style="color:#268bd2">i</span><span style="color:#839496"> )</span></span>
<span class="line"><span style="color:#839496">    </span><span style="color:#268bd2">itime</span><span style="color:#839496"> </span><span style="color:#859900">&lt;-</span><span style="color:#839496"> get.vertex.attribute(</span><span style="color:#268bd2">igraph</span><span style="color:#839496">,</span><span style="color:#2aa198">"i_time"</span><span style="color:#839496">, </span><span style="color:#268bd2">i</span><span style="color:#839496"> )</span></span>
<span class="line"><span style="color:#839496">    </span><span style="color:#268bd2">limited_graph</span><span style="color:#839496"> </span><span style="color:#859900">&lt;-</span><span style="color:#839496"> set.vertex.attribute(</span><span style="color:#268bd2">limited_graph</span><span style="color:#839496">,</span><span style="color:#2aa198">"epidemic"</span><span style="color:#839496">, </span><span style="color:#268bd2">i</span><span style="color:#839496"> ,value</span><span style="color:#859900">=</span><span style="color:#268bd2">epi</span><span style="color:#839496">)</span></span>
<span class="line"><span style="color:#839496">    </span><span style="color:#268bd2">limited_graph</span><span style="color:#839496"> </span><span style="color:#859900">&lt;-</span><span style="color:#839496"> set.vertex.attribute(</span><span style="color:#268bd2">limited_graph</span><span style="color:#839496">,</span><span style="color:#2aa198">"i_time"</span><span style="color:#839496">, </span><span style="color:#268bd2">i</span><span style="color:#839496"> ,value</span><span style="color:#859900">=</span><span style="color:#268bd2">itime</span><span style="color:#839496">)</span></span>
<span class="line"><span style="color:#839496">  }</span></span>
<span class="line"><span style="color:#839496">  </span><span style="color:#268bd2">limited_graph</span></span>
<span class="line"><span style="color:#839496">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#268bd2">confine_required</span><span style="color:#839496"> </span><span style="color:#859900">&lt;-</span><span style="color:#839496"> </span><span style="color:#859900">function</span><span style="color:#839496">(</span><span style="color:#268bd2">igraph</span><span style="color:#839496">,</span><span style="color:#268bd2">confinement_high</span><span style="color:#839496">,</span><span style="color:#268bd2">confinement_low</span><span style="color:#839496">,</span><span style="color:#268bd2">restrictions</span><span style="color:#839496">)</span></span>
<span class="line"><span style="color:#839496">{</span></span>
<span class="line"><span style="color:#839496">  </span><span style="color:#268bd2">nb_node</span><span style="color:#839496"> </span><span style="color:#859900">&lt;-</span><span style="color:#839496"> vcount(</span><span style="color:#268bd2">igraph</span><span style="color:#839496">)</span></span>
<span class="line"><span style="color:#839496">  </span><span style="color:#268bd2">nb_i</span><span style="color:#839496"> </span><span style="color:#859900">&lt;-</span><span style="color:#839496"> </span><span style="color:#d33682">0</span></span>
<span class="line"><span style="color:#839496">  </span><span style="color:#859900">for</span><span style="color:#839496">(</span><span style="color:#268bd2">i</span><span style="color:#839496"> </span><span style="color:#859900">in</span><span style="color:#839496"> </span><span style="color:#d33682">1</span><span style="color:#859900">:</span><span style="color:#268bd2">nb_node</span><span style="color:#839496">)</span></span>
<span class="line"><span style="color:#839496">  {</span></span>
<span class="line"><span style="color:#839496">    </span><span style="color:#268bd2">node_status</span><span style="color:#839496"> </span><span style="color:#859900">&lt;-</span><span style="color:#839496"> get.vertex.attribute(</span><span style="color:#268bd2">igraph</span><span style="color:#839496">,</span><span style="color:#2aa198">"epidemic"</span><span style="color:#839496">, </span><span style="color:#268bd2">i</span><span style="color:#839496">)</span></span>
<span class="line"><span style="color:#839496">    </span><span style="color:#859900">if</span><span style="color:#839496">( </span><span style="color:#268bd2">node_status</span><span style="color:#839496"> </span><span style="color:#859900">==</span><span style="color:#839496"> </span><span style="color:#2aa198">"i"</span><span style="color:#839496"> )</span></span>
<span class="line"><span style="color:#839496">    {</span></span>
<span class="line"><span style="color:#839496">      </span><span style="color:#268bd2">nb_i</span><span style="color:#839496"> </span><span style="color:#859900">&lt;-</span><span style="color:#839496"> </span><span style="color:#268bd2">nb_i</span><span style="color:#859900">+</span><span style="color:#d33682">1</span></span>
<span class="line"><span style="color:#839496">    }</span></span>
<span class="line"><span style="color:#839496">  }</span></span>
<span class="line"><span style="color:#839496">  </span><span style="color:#859900">if</span><span style="color:#839496">(</span><span style="color:#268bd2">restrictions</span><span style="color:#839496"> </span><span style="color:#859900">==</span><span style="color:#839496"> </span><span style="color:#b58900">FALSE</span><span style="color:#839496">)</span></span>
<span class="line"><span style="color:#839496">  {</span></span>
<span class="line"><span style="color:#839496">    </span><span style="color:#859900">if</span><span style="color:#839496">(</span><span style="color:#268bd2">nb_i</span><span style="color:#839496"> </span><span style="color:#859900">&gt;</span><span style="color:#839496"> </span><span style="color:#268bd2">confinement_high</span><span style="color:#839496">)</span></span>
<span class="line"><span style="color:#839496">    {</span></span>
<span class="line"><span style="color:#839496">      </span><span style="color:#268bd2">restrictions</span><span style="color:#839496"> </span><span style="color:#859900">&lt;-</span><span style="color:#839496"> </span><span style="color:#b58900">TRUE</span></span>
<span class="line"><span style="color:#839496">    }</span></span>
<span class="line"><span style="color:#839496">  }</span><span style="color:#859900">else</span><span style="color:#839496"> </span><span style="color:#859900">if</span><span style="color:#839496">( </span><span style="color:#268bd2">restrictions</span><span style="color:#839496"> </span><span style="color:#859900">==</span><span style="color:#839496"> </span><span style="color:#b58900">TRUE</span><span style="color:#839496"> )</span></span>
<span class="line"><span style="color:#839496">  {</span></span>
<span class="line"><span style="color:#839496">    </span><span style="color:#859900">if</span><span style="color:#839496">( </span><span style="color:#268bd2">nb_i</span><span style="color:#839496"> </span><span style="color:#859900">&lt;</span><span style="color:#839496"> </span><span style="color:#268bd2">confinement_low</span><span style="color:#839496"> )</span></span>
<span class="line"><span style="color:#839496">    {</span></span>
<span class="line"><span style="color:#839496">      </span><span style="color:#268bd2">restrictions</span><span style="color:#839496"> </span><span style="color:#859900">&lt;-</span><span style="color:#839496"> </span><span style="color:#b58900">FALSE</span></span>
<span class="line"><span style="color:#839496">    }</span></span>
<span class="line"><span style="color:#839496">  }</span></span>
<span class="line"><span style="color:#839496">  </span><span style="color:#268bd2">restrictions</span></span>
<span class="line"><span style="color:#839496">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#268bd2">R0_calc</span><span style="color:#839496"> </span><span style="color:#859900">&lt;-</span><span style="color:#839496"> </span><span style="color:#859900">function</span><span style="color:#839496">(</span><span style="color:#268bd2">result_mat</span><span style="color:#839496">,</span><span style="color:#268bd2">nb_node</span><span style="color:#839496">, </span><span style="color:#268bd2">n_d</span><span style="color:#839496">)</span></span>
<span class="line"><span style="color:#839496">{</span></span>
<span class="line"><span style="color:#839496">  </span><span style="color:#268bd2">nb_day</span><span style="color:#839496"> </span><span style="color:#859900">&lt;-</span><span style="color:#839496"> </span><span style="color:#268bd2">ncol</span><span style="color:#839496">(</span><span style="color:#268bd2">result_mat</span><span style="color:#839496">)</span></span>
<span class="line"><span style="color:#839496">  </span><span style="color:#268bd2">gam</span><span style="color:#839496"> </span><span style="color:#859900">&lt;-</span><span style="color:#839496"> </span><span style="color:#d33682">1</span><span style="color:#859900">/</span><span style="color:#268bd2">n_d</span></span>
<span class="line"><span style="color:#839496">  </span><span style="color:#268bd2">outmat</span><span style="color:#839496"> </span><span style="color:#859900">&lt;-</span><span style="color:#839496"> </span><span style="color:#268bd2">matrix</span><span style="color:#839496">(nrow </span><span style="color:#859900">=</span><span style="color:#839496"> </span><span style="color:#d33682">6</span><span style="color:#839496">, ncol </span><span style="color:#859900">=</span><span style="color:#839496"> </span><span style="color:#268bd2">nb_day</span><span style="color:#839496">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#839496">  </span><span style="color:#268bd2">x</span><span style="color:#839496"> </span><span style="color:#859900">&lt;-</span><span style="color:#839496"> </span><span style="color:#268bd2">result_mat</span><span style="color:#839496">[</span><span style="color:#d33682">1</span><span style="color:#839496">,]</span><span style="color:#859900">/</span><span style="color:#268bd2">nb_node</span></span>
<span class="line"><span style="color:#839496">  </span><span style="color:#268bd2">s</span><span style="color:#839496"> </span><span style="color:#859900">&lt;-</span><span style="color:#839496"> </span><span style="color:#268bd2">result_mat</span><span style="color:#839496">[</span><span style="color:#d33682">2</span><span style="color:#839496">,]</span><span style="color:#859900">/</span><span style="color:#268bd2">nb_node</span></span>
<span class="line"><span style="color:#839496">  </span><span style="color:#268bd2">r</span><span style="color:#839496"> </span><span style="color:#859900">&lt;-</span><span style="color:#839496"> </span><span style="color:#268bd2">result_mat</span><span style="color:#839496">[</span><span style="color:#d33682">3</span><span style="color:#839496">,]</span><span style="color:#859900">/</span><span style="color:#268bd2">nb_node</span></span>
<span class="line"></span>
<span class="line"><span style="color:#839496">  </span><span style="color:#268bd2">d_x</span><span style="color:#839496"> </span><span style="color:#859900">&lt;-</span><span style="color:#839496"> </span><span style="color:#268bd2">vector</span><span style="color:#839496">(mode </span><span style="color:#859900">=</span><span style="color:#839496"> </span><span style="color:#2aa198">"numeric"</span><span style="color:#839496">,</span><span style="color:#268bd2">nb_day</span><span style="color:#839496">)</span></span>
<span class="line"><span style="color:#839496">  </span><span style="color:#268bd2">d_s</span><span style="color:#839496"> </span><span style="color:#859900">&lt;-</span><span style="color:#839496"> </span><span style="color:#268bd2">vector</span><span style="color:#839496">(mode </span><span style="color:#859900">=</span><span style="color:#839496"> </span><span style="color:#2aa198">"numeric"</span><span style="color:#839496">,</span><span style="color:#268bd2">nb_day</span><span style="color:#839496">)</span></span>
<span class="line"><span style="color:#839496">  </span><span style="color:#268bd2">d_r</span><span style="color:#839496"> </span><span style="color:#859900">&lt;-</span><span style="color:#839496"> </span><span style="color:#268bd2">vector</span><span style="color:#839496">(mode </span><span style="color:#859900">=</span><span style="color:#839496"> </span><span style="color:#2aa198">"numeric"</span><span style="color:#839496">,</span><span style="color:#268bd2">nb_day</span><span style="color:#839496">)</span></span>
<span class="line"><span style="color:#839496">  </span><span style="color:#268bd2">beta</span><span style="color:#839496"> </span><span style="color:#859900">&lt;-</span><span style="color:#839496"> </span><span style="color:#268bd2">vector</span><span style="color:#839496">(mode </span><span style="color:#859900">=</span><span style="color:#839496"> </span><span style="color:#2aa198">"numeric"</span><span style="color:#839496">,</span><span style="color:#268bd2">nb_day</span><span style="color:#839496">)</span></span>
<span class="line"><span style="color:#839496">  </span><span style="color:#268bd2">gamma</span><span style="color:#839496"> </span><span style="color:#859900">&lt;-</span><span style="color:#839496"> </span><span style="color:#268bd2">vector</span><span style="color:#839496">(mode </span><span style="color:#859900">=</span><span style="color:#839496"> </span><span style="color:#2aa198">"numeric"</span><span style="color:#839496">,</span><span style="color:#268bd2">nb_day</span><span style="color:#839496">)</span></span>
<span class="line"><span style="color:#839496">  </span><span style="color:#859900">for</span><span style="color:#839496">(</span><span style="color:#268bd2">i</span><span style="color:#839496"> </span><span style="color:#859900">in</span><span style="color:#839496"> </span><span style="color:#d33682">2</span><span style="color:#859900">:</span><span style="color:#268bd2">nb_day</span><span style="color:#839496"> )</span></span>
<span class="line"><span style="color:#839496">  {</span></span>
<span class="line"><span style="color:#839496">    </span><span style="color:#268bd2">d_x</span><span style="color:#839496">[</span><span style="color:#268bd2">i</span><span style="color:#839496">] </span><span style="color:#859900">&lt;-</span><span style="color:#839496"> </span><span style="color:#268bd2">x</span><span style="color:#839496">[</span><span style="color:#268bd2">i</span><span style="color:#839496">] </span><span style="color:#859900">-</span><span style="color:#839496"> </span><span style="color:#268bd2">x</span><span style="color:#839496">[</span><span style="color:#268bd2">i</span><span style="color:#859900">-</span><span style="color:#d33682">1</span><span style="color:#839496">]</span></span>
<span class="line"><span style="color:#839496">    </span><span style="color:#268bd2">d_s</span><span style="color:#839496">[</span><span style="color:#268bd2">i</span><span style="color:#839496">] </span><span style="color:#859900">&lt;-</span><span style="color:#839496"> </span><span style="color:#268bd2">s</span><span style="color:#839496">[</span><span style="color:#268bd2">i</span><span style="color:#839496">] </span><span style="color:#859900">-</span><span style="color:#839496"> </span><span style="color:#268bd2">s</span><span style="color:#839496">[</span><span style="color:#268bd2">i</span><span style="color:#859900">-</span><span style="color:#d33682">1</span><span style="color:#839496">]</span></span>
<span class="line"><span style="color:#839496">    </span><span style="color:#268bd2">d_r</span><span style="color:#839496">[</span><span style="color:#268bd2">i</span><span style="color:#839496">] </span><span style="color:#859900">&lt;-</span><span style="color:#839496"> </span><span style="color:#268bd2">r</span><span style="color:#839496">[</span><span style="color:#268bd2">i</span><span style="color:#839496">] </span><span style="color:#859900">-</span><span style="color:#839496"> </span><span style="color:#268bd2">r</span><span style="color:#839496">[</span><span style="color:#268bd2">i</span><span style="color:#859900">-</span><span style="color:#d33682">1</span><span style="color:#839496">]</span></span>
<span class="line"><span style="color:#839496">  }</span></span>
<span class="line"><span style="color:#839496">  </span><span style="color:#859900">for</span><span style="color:#839496">(</span><span style="color:#268bd2">i</span><span style="color:#839496"> </span><span style="color:#859900">in</span><span style="color:#839496"> </span><span style="color:#d33682">2</span><span style="color:#859900">:</span><span style="color:#268bd2">nb_day</span><span style="color:#839496"> )</span></span>
<span class="line"><span style="color:#839496">  {</span></span>
<span class="line"><span style="color:#839496">    </span><span style="color:#268bd2">beta</span><span style="color:#839496">[</span><span style="color:#268bd2">i</span><span style="color:#839496">] </span><span style="color:#859900">&lt;-</span><span style="color:#839496"> </span><span style="color:#268bd2">d_s</span><span style="color:#839496">[</span><span style="color:#268bd2">i</span><span style="color:#839496">]</span><span style="color:#859900">/</span><span style="color:#839496">(</span><span style="color:#268bd2">s</span><span style="color:#839496">[</span><span style="color:#268bd2">i</span><span style="color:#839496">]</span><span style="color:#859900">*</span><span style="color:#268bd2">x</span><span style="color:#839496">[</span><span style="color:#268bd2">i</span><span style="color:#839496">])</span></span>
<span class="line"><span style="color:#839496">  }</span></span>
<span class="line"><span style="color:#839496">  </span><span style="color:#268bd2">print</span><span style="color:#839496">(</span><span style="color:#268bd2">beta</span><span style="color:#859900">/</span><span style="color:#d33682">0.1</span><span style="color:#839496">)</span></span>
<span class="line"><span style="color:#839496">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#268bd2">n</span><span style="color:#839496"> </span><span style="color:#859900">&lt;-</span><span style="color:#839496"> </span><span style="color:#d33682">2000</span></span>
<span class="line"><span style="color:#268bd2">p</span><span style="color:#839496"> </span><span style="color:#859900">&lt;-</span><span style="color:#839496"> </span><span style="color:#d33682">0.01</span></span>
<span class="line"></span>
<span class="line"><span style="color:#268bd2">p_epidemic</span><span style="color:#839496"> </span><span style="color:#859900">&lt;-</span><span style="color:#839496"> </span><span style="color:#d33682">0.01</span></span>
<span class="line"><span style="color:#268bd2">time</span><span style="color:#839496"> </span><span style="color:#859900">&lt;-</span><span style="color:#839496"> </span><span style="color:#d33682">70</span></span>
<span class="line"></span>
<span class="line"><span style="color:#268bd2">n_0</span><span style="color:#839496"> </span><span style="color:#859900">&lt;-</span><span style="color:#839496"> </span><span style="color:#d33682">10</span></span>
<span class="line"><span style="color:#268bd2">n_d</span><span style="color:#839496"> </span><span style="color:#859900">&lt;-</span><span style="color:#839496"> </span><span style="color:#d33682">10</span></span>
<span class="line"></span>
<span class="line"><span style="color:#268bd2">travel_limitation</span><span style="color:#839496"> </span><span style="color:#859900">&lt;-</span><span style="color:#839496"> </span><span style="color:#b58900">FALSE</span></span>
<span class="line"><span style="color:#268bd2">confinement_high</span><span style="color:#839496"> </span><span style="color:#859900">&lt;-</span><span style="color:#839496"> </span><span style="color:#d33682">50</span></span>
<span class="line"><span style="color:#268bd2">confinement_low</span><span style="color:#839496"> </span><span style="color:#859900">&lt;-</span><span style="color:#839496"> </span><span style="color:#d33682">10</span></span>
<span class="line"><span style="color:#268bd2">restriction_percentages</span><span style="color:#839496"> </span><span style="color:#859900">&lt;-</span><span style="color:#839496"> </span><span style="color:#d33682">80</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#268bd2">ig</span><span style="color:#839496"> </span><span style="color:#859900">&lt;-</span><span style="color:#839496"> Erdos_Renyi_optimized(</span><span style="color:#268bd2">n</span><span style="color:#839496">,</span><span style="color:#268bd2">p</span><span style="color:#839496">)</span></span>
<span class="line"><span style="color:#268bd2">cat</span><span style="color:#839496">(</span><span style="color:#2aa198">"Erdos Renyi created</span><span style="color:#cb4b16">\n</span><span style="color:#2aa198">"</span><span style="color:#839496">)</span></span>
<span class="line"><span style="color:#268bd2">ig</span><span style="color:#839496"> </span><span style="color:#859900">&lt;-</span><span style="color:#839496"> init_epidemic(</span><span style="color:#268bd2">ig</span><span style="color:#839496">,</span><span style="color:#268bd2">n_0</span><span style="color:#839496">,</span><span style="color:#268bd2">n_d</span><span style="color:#839496">)</span></span>
<span class="line"><span style="color:#586e75;font-style:italic">#epidemic_plot(ig,"Day One")</span></span>
<span class="line"><span style="color:#268bd2">cat</span><span style="color:#839496">(</span><span style="color:#2aa198">"Infection initialized </span><span style="color:#cb4b16">\n</span><span style="color:#2aa198">"</span><span style="color:#839496">)</span></span>
<span class="line"><span style="color:#268bd2">res</span><span style="color:#839496"> </span><span style="color:#859900">&lt;-</span><span style="color:#839496"> simulation(</span><span style="color:#268bd2">ig</span><span style="color:#839496">,</span><span style="color:#268bd2">p_epidemic</span><span style="color:#839496">,</span><span style="color:#268bd2">n_d</span><span style="color:#839496">,</span><span style="color:#268bd2">time</span><span style="color:#839496">,</span><span style="color:#268bd2">confinement_high</span><span style="color:#839496">,</span><span style="color:#268bd2">confinement_low</span><span style="color:#839496">,</span><span style="color:#268bd2">restriction_percentages</span><span style="color:#839496">,</span><span style="color:#268bd2">travel_limitation</span><span style="color:#839496">)</span></span>
<span class="line"><span style="color:#839496">plot_epidemic_curves(</span><span style="color:#d33682">100</span><span style="color:#859900">*</span><span style="color:#268bd2">res</span><span style="color:#859900">/</span><span style="color:#268bd2">n</span><span style="color:#839496">,</span><span style="color:#268bd2">time</span><span style="color:#839496">)</span></span>
<span class="line"></span></code></pre><pre class="shiki shiki-light" style="background-color:#fdf6e3"><code v-pre=""><span class="line"><span style="color:#268bd2">library</span><span style="color:#657b83">(</span><span style="color:#268bd2">igraph</span><span style="color:#657b83">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#268bd2">Erdos_Renyi_optimized</span><span style="color:#657b83"> </span><span style="color:#859900">&lt;-</span><span style="color:#657b83"> </span><span style="color:#859900">function</span><span style="color:#657b83">(</span><span style="color:#268bd2">n</span><span style="color:#657b83">,</span><span style="color:#268bd2">p</span><span style="color:#657b83">)</span></span>
<span class="line"><span style="color:#657b83">{</span></span>
<span class="line"><span style="color:#657b83">  </span><span style="color:#268bd2">nb_tri</span><span style="color:#657b83"> </span><span style="color:#859900">&lt;-</span><span style="color:#657b83"> </span><span style="color:#268bd2">n</span><span style="color:#859900">*</span><span style="color:#657b83">(</span><span style="color:#268bd2">n</span><span style="color:#859900">-</span><span style="color:#d33682">1</span><span style="color:#657b83">)</span><span style="color:#859900">/</span><span style="color:#d33682">2</span></span>
<span class="line"><span style="color:#657b83">  </span><span style="color:#268bd2">mat</span><span style="color:#657b83"> </span><span style="color:#859900">&lt;-</span><span style="color:#657b83"> </span><span style="color:#268bd2">diag</span><span style="color:#657b83">(</span><span style="color:#d33682">0</span><span style="color:#657b83">,nrow </span><span style="color:#859900">=</span><span style="color:#657b83"> </span><span style="color:#268bd2">n</span><span style="color:#657b83">, ncol </span><span style="color:#859900">=</span><span style="color:#657b83"> </span><span style="color:#268bd2">n</span><span style="color:#657b83">)</span></span>
<span class="line"><span style="color:#657b83">  </span><span style="color:#268bd2">vect_rand</span><span style="color:#657b83"> </span><span style="color:#859900">&lt;-</span><span style="color:#657b83"> </span><span style="color:#268bd2">runif</span><span style="color:#657b83">(</span><span style="color:#268bd2">nb_tri</span><span style="color:#657b83"> , min </span><span style="color:#859900">=</span><span style="color:#657b83"> </span><span style="color:#d33682">0</span><span style="color:#657b83">, max </span><span style="color:#859900">=</span><span style="color:#657b83"> </span><span style="color:#d33682">1</span><span style="color:#657b83">) </span><span style="color:#859900">-</span><span style="color:#657b83"> </span><span style="color:#268bd2">p</span></span>
<span class="line"><span style="color:#657b83">  </span><span style="color:#859900">for</span><span style="color:#657b83">(</span><span style="color:#268bd2">i</span><span style="color:#657b83"> </span><span style="color:#859900">in</span><span style="color:#657b83"> </span><span style="color:#d33682">1</span><span style="color:#859900">:</span><span style="color:#268bd2">nb_tri</span><span style="color:#657b83">)</span></span>
<span class="line"><span style="color:#657b83">  {</span></span>
<span class="line"><span style="color:#657b83">    </span><span style="color:#859900">if</span><span style="color:#657b83">(</span><span style="color:#268bd2">vect_rand</span><span style="color:#657b83">[</span><span style="color:#268bd2">i</span><span style="color:#657b83">]</span><span style="color:#859900">&gt;</span><span style="color:#d33682">0</span><span style="color:#657b83">)</span></span>
<span class="line"><span style="color:#657b83">    {</span></span>
<span class="line"><span style="color:#657b83">      </span><span style="color:#268bd2">vect_rand</span><span style="color:#657b83">[</span><span style="color:#268bd2">i</span><span style="color:#657b83">] </span><span style="color:#859900">&lt;-</span><span style="color:#657b83"> </span><span style="color:#d33682">0</span><span style="color:#657b83"> </span></span>
<span class="line"><span style="color:#657b83">    }</span></span>
<span class="line"><span style="color:#657b83">    </span><span style="color:#859900">else</span></span>
<span class="line"><span style="color:#657b83">    {</span></span>
<span class="line"><span style="color:#657b83">      </span><span style="color:#268bd2">vect_rand</span><span style="color:#657b83">[</span><span style="color:#268bd2">i</span><span style="color:#657b83">] </span><span style="color:#859900">&lt;-</span><span style="color:#657b83"> </span><span style="color:#d33682">1</span><span style="color:#657b83"> </span></span>
<span class="line"><span style="color:#657b83">    }</span></span>
<span class="line"><span style="color:#657b83">  }</span></span>
<span class="line"><span style="color:#657b83">  </span><span style="color:#268bd2">mat</span><span style="color:#657b83">[</span><span style="color:#268bd2">lower.tri</span><span style="color:#657b83">(</span><span style="color:#268bd2">mat</span><span style="color:#657b83">)] </span><span style="color:#859900">&lt;-</span><span style="color:#657b83"> </span><span style="color:#268bd2">vect_rand</span></span>
<span class="line"><span style="color:#657b83">  </span><span style="color:#268bd2">mat</span><span style="color:#657b83"> </span><span style="color:#859900">&lt;-</span><span style="color:#657b83"> </span><span style="color:#268bd2">t</span><span style="color:#657b83">(</span><span style="color:#268bd2">mat</span><span style="color:#657b83">)</span></span>
<span class="line"><span style="color:#657b83">  </span><span style="color:#268bd2">mat</span><span style="color:#657b83">[</span><span style="color:#268bd2">lower.tri</span><span style="color:#657b83">(</span><span style="color:#268bd2">mat</span><span style="color:#657b83">)] </span><span style="color:#859900">&lt;-</span><span style="color:#657b83"> </span><span style="color:#268bd2">vect_rand</span></span>
<span class="line"><span style="color:#657b83">  </span><span style="color:#268bd2">igraph</span><span style="color:#657b83"> </span><span style="color:#859900">&lt;-</span><span style="color:#657b83"> graph_from_adjacency_matrix(</span><span style="color:#268bd2">mat</span><span style="color:#657b83">,mode </span><span style="color:#859900">=</span><span style="color:#657b83"> </span><span style="color:#268bd2">c</span><span style="color:#657b83">(</span><span style="color:#2aa198">"undirected"</span><span style="color:#657b83">))</span></span>
<span class="line"><span style="color:#657b83">  </span><span style="color:#268bd2">igraph</span></span>
<span class="line"><span style="color:#657b83">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#268bd2">plot_epidemic_curves</span><span style="color:#657b83"> </span><span style="color:#859900">&lt;-</span><span style="color:#657b83"> </span><span style="color:#859900">function</span><span style="color:#657b83">(</span><span style="color:#268bd2">mat_res</span><span style="color:#657b83">,</span><span style="color:#268bd2">time</span><span style="color:#657b83">)</span></span>
<span class="line"><span style="color:#657b83">{</span></span>
<span class="line"><span style="color:#657b83">  </span><span style="color:#268bd2">plot</span><span style="color:#657b83">( x </span><span style="color:#859900">=</span><span style="color:#657b83"> </span><span style="color:#268bd2">c</span><span style="color:#657b83">(</span><span style="color:#d33682">0</span><span style="color:#859900">:</span><span style="color:#268bd2">time</span><span style="color:#657b83">), y </span><span style="color:#859900">=</span><span style="color:#657b83"> </span><span style="color:#268bd2">mat_res</span><span style="color:#657b83">[</span><span style="color:#d33682">2</span><span style="color:#657b83">,],xlab</span><span style="color:#859900">=</span><span style="color:#2aa198">"days"</span><span style="color:#657b83">,ylab</span><span style="color:#859900">=</span><span style="color:#2aa198">"Percentage of people"</span><span style="color:#657b83">,type</span><span style="color:#859900">=</span><span style="color:#2aa198">"b"</span><span style="color:#657b83">,col</span><span style="color:#859900">=</span><span style="color:#2aa198">"green"</span><span style="color:#657b83">, ylim</span><span style="color:#859900">=</span><span style="color:#268bd2">c</span><span style="color:#657b83">(</span><span style="color:#d33682">1</span><span style="color:#657b83">,</span><span style="color:#d33682">100</span><span style="color:#657b83">),main</span><span style="color:#859900">=</span><span style="color:#2aa198">"Evolution of SIR model epidemic"</span><span style="color:#657b83">)</span></span>
<span class="line"><span style="color:#657b83">  </span><span style="color:#268bd2">lines</span><span style="color:#657b83">(x</span><span style="color:#859900">=</span><span style="color:#657b83"> </span><span style="color:#268bd2">c</span><span style="color:#657b83">(</span><span style="color:#d33682">0</span><span style="color:#859900">:</span><span style="color:#268bd2">time</span><span style="color:#657b83">), y </span><span style="color:#859900">=</span><span style="color:#657b83"> </span><span style="color:#268bd2">mat_res</span><span style="color:#657b83">[</span><span style="color:#d33682">3</span><span style="color:#657b83">,],type</span><span style="color:#859900">=</span><span style="color:#2aa198">"b"</span><span style="color:#657b83">,col</span><span style="color:#859900">=</span><span style="color:#2aa198">"blue"</span><span style="color:#657b83">)</span></span>
<span class="line"><span style="color:#657b83">  </span><span style="color:#268bd2">lines</span><span style="color:#657b83">(x</span><span style="color:#859900">=</span><span style="color:#657b83"> </span><span style="color:#268bd2">c</span><span style="color:#657b83">(</span><span style="color:#d33682">0</span><span style="color:#859900">:</span><span style="color:#268bd2">time</span><span style="color:#657b83">), y </span><span style="color:#859900">=</span><span style="color:#657b83"> </span><span style="color:#268bd2">mat_res</span><span style="color:#657b83">[</span><span style="color:#d33682">1</span><span style="color:#657b83">,],type</span><span style="color:#859900">=</span><span style="color:#2aa198">"b"</span><span style="color:#657b83">,col</span><span style="color:#859900">=</span><span style="color:#2aa198">"red"</span><span style="color:#657b83">)</span></span>
<span class="line"><span style="color:#657b83">  </span><span style="color:#268bd2">legend</span><span style="color:#657b83">( ( </span><span style="color:#268bd2">time</span><span style="color:#859900">-</span><span style="color:#657b83">(</span><span style="color:#268bd2">time</span><span style="color:#859900">*</span><span style="color:#d33682">0.15</span><span style="color:#657b83">) ), </span><span style="color:#d33682">90</span><span style="color:#657b83">, legend</span><span style="color:#859900">=</span><span style="color:#268bd2">c</span><span style="color:#657b83">(</span><span style="color:#2aa198">"Suceptible"</span><span style="color:#657b83">, </span><span style="color:#2aa198">"Infected"</span><span style="color:#657b83">,</span><span style="color:#2aa198">"Recovered"</span><span style="color:#657b83">),</span></span>
<span class="line"><span style="color:#657b83">          col</span><span style="color:#859900">=</span><span style="color:#268bd2">c</span><span style="color:#657b83">(</span><span style="color:#2aa198">"green"</span><span style="color:#657b83">,</span><span style="color:#2aa198">"blue"</span><span style="color:#657b83">,</span><span style="color:#2aa198">"red"</span><span style="color:#657b83">), lty</span><span style="color:#859900">=</span><span style="color:#d33682">1</span><span style="color:#859900">:</span><span style="color:#d33682">3</span><span style="color:#657b83">, cex</span><span style="color:#859900">=</span><span style="color:#d33682">0.8</span><span style="color:#657b83">)</span></span>
<span class="line"><span style="color:#657b83">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#268bd2">epidemic_plot</span><span style="color:#657b83"> </span><span style="color:#859900">&lt;-</span><span style="color:#657b83"> </span><span style="color:#859900">function</span><span style="color:#657b83">(</span><span style="color:#268bd2">igraph</span><span style="color:#657b83">,</span><span style="color:#268bd2">mainstr</span><span style="color:#657b83">)</span></span>
<span class="line"><span style="color:#657b83">{</span></span>
<span class="line"><span style="color:#657b83">  </span><span style="color:#268bd2">nb_node</span><span style="color:#657b83"> </span><span style="color:#859900">&lt;-</span><span style="color:#657b83"> vcount(</span><span style="color:#268bd2">igraph</span><span style="color:#657b83">)</span></span>
<span class="line"><span style="color:#657b83">  </span><span style="color:#859900">for</span><span style="color:#657b83">(</span><span style="color:#268bd2">i</span><span style="color:#657b83"> </span><span style="color:#859900">in</span><span style="color:#657b83"> </span><span style="color:#d33682">1</span><span style="color:#859900">:</span><span style="color:#657b83"> </span><span style="color:#268bd2">nb_node</span><span style="color:#657b83">)</span></span>
<span class="line"><span style="color:#657b83">  {</span></span>
<span class="line"><span style="color:#657b83">    </span><span style="color:#268bd2">node_status</span><span style="color:#657b83"> </span><span style="color:#859900">&lt;-</span><span style="color:#657b83"> get.vertex.attribute(</span><span style="color:#268bd2">igraph</span><span style="color:#657b83">,</span><span style="color:#2aa198">"epidemic"</span><span style="color:#657b83">, </span><span style="color:#268bd2">i</span><span style="color:#657b83">)</span></span>
<span class="line"><span style="color:#657b83">    </span><span style="color:#859900">if</span><span style="color:#657b83">( </span><span style="color:#268bd2">node_status</span><span style="color:#657b83"> </span><span style="color:#859900">==</span><span style="color:#657b83"> </span><span style="color:#2aa198">"i"</span><span style="color:#657b83"> )</span></span>
<span class="line"><span style="color:#657b83">    {</span></span>
<span class="line"><span style="color:#657b83">      </span><span style="color:#268bd2">igraph</span><span style="color:#657b83"> </span><span style="color:#859900">&lt;-</span><span style="color:#657b83"> set.vertex.attribute(</span><span style="color:#268bd2">igraph</span><span style="color:#657b83">, </span><span style="color:#2aa198">'color'</span><span style="color:#657b83">, </span><span style="color:#268bd2">i</span><span style="color:#657b83">, </span><span style="color:#268bd2">rgb</span><span style="color:#657b83">(</span><span style="color:#d33682">1</span><span style="color:#657b83">,</span><span style="color:#d33682">0</span><span style="color:#657b83">,</span><span style="color:#d33682">0</span><span style="color:#657b83">) )</span></span>
<span class="line"><span style="color:#657b83">    }</span></span>
<span class="line"><span style="color:#657b83">    </span><span style="color:#859900">else</span><span style="color:#657b83"> </span><span style="color:#859900">if</span><span style="color:#657b83"> (</span><span style="color:#268bd2">node_status</span><span style="color:#657b83"> </span><span style="color:#859900">==</span><span style="color:#657b83"> </span><span style="color:#2aa198">"s"</span><span style="color:#657b83"> )</span></span>
<span class="line"><span style="color:#657b83">    {</span></span>
<span class="line"><span style="color:#657b83">      </span><span style="color:#268bd2">igraph</span><span style="color:#657b83"> </span><span style="color:#859900">&lt;-</span><span style="color:#657b83"> set.vertex.attribute(</span><span style="color:#268bd2">igraph</span><span style="color:#657b83">, </span><span style="color:#2aa198">'color'</span><span style="color:#657b83">, </span><span style="color:#268bd2">i</span><span style="color:#657b83">, </span><span style="color:#268bd2">rgb</span><span style="color:#657b83">(</span><span style="color:#d33682">0</span><span style="color:#657b83">,</span><span style="color:#d33682">1</span><span style="color:#657b83">,</span><span style="color:#d33682">0</span><span style="color:#657b83">) )</span></span>
<span class="line"><span style="color:#657b83">    }</span></span>
<span class="line"><span style="color:#657b83">    </span><span style="color:#859900">else</span><span style="color:#657b83"> </span><span style="color:#859900">if</span><span style="color:#657b83">(</span><span style="color:#268bd2">node_status</span><span style="color:#657b83"> </span><span style="color:#859900">==</span><span style="color:#657b83"> </span><span style="color:#2aa198">"r"</span><span style="color:#657b83"> )</span></span>
<span class="line"><span style="color:#657b83">    {</span></span>
<span class="line"><span style="color:#657b83">      </span><span style="color:#268bd2">igraph</span><span style="color:#657b83"> </span><span style="color:#859900">&lt;-</span><span style="color:#657b83"> set.vertex.attribute(</span><span style="color:#268bd2">igraph</span><span style="color:#657b83">, </span><span style="color:#2aa198">'color'</span><span style="color:#657b83">, </span><span style="color:#268bd2">i</span><span style="color:#657b83">, </span><span style="color:#268bd2">rgb</span><span style="color:#657b83">(</span><span style="color:#d33682">0</span><span style="color:#657b83">,</span><span style="color:#d33682">0</span><span style="color:#657b83">,</span><span style="color:#d33682">1</span><span style="color:#657b83">) )</span></span>
<span class="line"><span style="color:#657b83">    }</span></span>
<span class="line"><span style="color:#657b83">    </span><span style="color:#859900">else</span><span style="color:#657b83">{</span></span>
<span class="line"><span style="color:#657b83">      </span><span style="color:#268bd2">print</span><span style="color:#657b83">(</span><span style="color:#2aa198">"BUG PLOT attribute"</span><span style="color:#657b83">)</span></span>
<span class="line"><span style="color:#657b83">    }</span></span>
<span class="line"><span style="color:#657b83">  }</span></span>
<span class="line"><span style="color:#657b83">  </span><span style="color:#859900">for</span><span style="color:#657b83">(</span><span style="color:#268bd2">i</span><span style="color:#657b83"> </span><span style="color:#859900">in</span><span style="color:#657b83"> </span><span style="color:#d33682">1</span><span style="color:#859900">:</span><span style="color:#657b83"> </span><span style="color:#268bd2">nb_node</span><span style="color:#657b83">)</span></span>
<span class="line"><span style="color:#657b83">  {</span></span>
<span class="line"><span style="color:#657b83">    </span><span style="color:#268bd2">node_status</span><span style="color:#657b83"> </span><span style="color:#859900">&lt;-</span><span style="color:#657b83"> get.vertex.attribute(</span><span style="color:#268bd2">igraph</span><span style="color:#657b83">,</span><span style="color:#2aa198">"i_time"</span><span style="color:#657b83">, </span><span style="color:#268bd2">i</span><span style="color:#657b83">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#657b83">    </span><span style="color:#859900">if</span><span style="color:#657b83">( </span><span style="color:#268bd2">node_status</span><span style="color:#657b83"> </span><span style="color:#859900">&gt;</span><span style="color:#657b83"> </span><span style="color:#d33682">0</span><span style="color:#657b83"> )</span></span>
<span class="line"><span style="color:#657b83">    {</span></span>
<span class="line"><span style="color:#657b83">      </span><span style="color:#268bd2">igraph</span><span style="color:#657b83"> </span><span style="color:#859900">&lt;-</span><span style="color:#657b83"> set.vertex.attribute(</span><span style="color:#268bd2">igraph</span><span style="color:#657b83">, </span><span style="color:#2aa198">"label"</span><span style="color:#657b83">, </span><span style="color:#268bd2">i</span><span style="color:#657b83">, </span><span style="color:#268bd2">node_status</span><span style="color:#657b83">  )</span></span>
<span class="line"><span style="color:#657b83">    }</span><span style="color:#859900">else</span><span style="color:#657b83"> </span><span style="color:#859900">if</span><span style="color:#657b83">( </span><span style="color:#268bd2">node_status</span><span style="color:#657b83"> </span><span style="color:#859900">==</span><span style="color:#657b83"> </span><span style="color:#d33682">0</span><span style="color:#657b83"> )</span></span>
<span class="line"><span style="color:#657b83">    {</span></span>
<span class="line"><span style="color:#657b83">      </span><span style="color:#268bd2">igraph</span><span style="color:#657b83"> </span><span style="color:#859900">&lt;-</span><span style="color:#657b83"> set.vertex.attribute(</span><span style="color:#268bd2">igraph</span><span style="color:#657b83">, </span><span style="color:#2aa198">"label"</span><span style="color:#657b83">, </span><span style="color:#268bd2">i</span><span style="color:#657b83">, </span><span style="color:#2aa198">"R"</span><span style="color:#657b83">  )</span></span>
<span class="line"><span style="color:#657b83">      </span><span style="color:#268bd2">igraph</span><span style="color:#657b83"> </span><span style="color:#859900">&lt;-</span><span style="color:#657b83"> set.vertex.attribute(</span><span style="color:#268bd2">igraph</span><span style="color:#657b83">, </span><span style="color:#2aa198">'color'</span><span style="color:#657b83">, </span><span style="color:#268bd2">i</span><span style="color:#657b83">, </span><span style="color:#268bd2">rgb</span><span style="color:#657b83">(</span><span style="color:#d33682">0</span><span style="color:#657b83">,</span><span style="color:#d33682">0</span><span style="color:#657b83">,</span><span style="color:#d33682">1</span><span style="color:#657b83">) )</span></span>
<span class="line"><span style="color:#657b83">    }</span><span style="color:#859900">else</span></span>
<span class="line"><span style="color:#657b83">    {</span></span>
<span class="line"><span style="color:#657b83">      </span><span style="color:#268bd2">igraph</span><span style="color:#657b83"> </span><span style="color:#859900">&lt;-</span><span style="color:#657b83"> set.vertex.attribute(</span><span style="color:#268bd2">igraph</span><span style="color:#657b83">, </span><span style="color:#2aa198">"label"</span><span style="color:#657b83">, </span><span style="color:#268bd2">i</span><span style="color:#657b83">, </span><span style="color:#2aa198">"S"</span><span style="color:#657b83">  )</span></span>
<span class="line"><span style="color:#657b83">    }</span></span>
<span class="line"><span style="color:#657b83">  }</span></span>
<span class="line"><span style="color:#657b83">  </span><span style="color:#268bd2">plot</span><span style="color:#657b83">(</span><span style="color:#268bd2">igraph</span><span style="color:#657b83">, main </span><span style="color:#859900">=</span><span style="color:#657b83"> </span><span style="color:#268bd2">mainstr</span><span style="color:#657b83"> )</span></span>
<span class="line"><span style="color:#657b83">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#268bd2">is_unique</span><span style="color:#657b83"> </span><span style="color:#859900">&lt;-</span><span style="color:#657b83"> </span><span style="color:#859900">function</span><span style="color:#657b83">(</span><span style="color:#268bd2">vect</span><span style="color:#657b83">)</span></span>
<span class="line"><span style="color:#657b83">{</span></span>
<span class="line"><span style="color:#657b83">    </span><span style="color:#268bd2">isunique</span><span style="color:#657b83"> </span><span style="color:#859900">&lt;-</span><span style="color:#657b83"> </span><span style="color:#b58900">TRUE</span></span>
<span class="line"><span style="color:#657b83">    </span><span style="color:#859900">for</span><span style="color:#657b83">(</span><span style="color:#268bd2">i</span><span style="color:#657b83"> </span><span style="color:#859900">in</span><span style="color:#657b83"> </span><span style="color:#d33682">1</span><span style="color:#859900">:</span><span style="color:#657b83"> </span><span style="color:#268bd2">length</span><span style="color:#657b83">(</span><span style="color:#268bd2">vect</span><span style="color:#657b83">))</span></span>
<span class="line"><span style="color:#657b83">    {</span></span>
<span class="line"><span style="color:#657b83">        </span><span style="color:#268bd2">iterator</span><span style="color:#657b83"> </span><span style="color:#859900">&lt;-</span><span style="color:#657b83"> </span><span style="color:#268bd2">vect</span><span style="color:#657b83">[</span><span style="color:#268bd2">i</span><span style="color:#657b83">]</span></span>
<span class="line"><span style="color:#657b83">        </span><span style="color:#859900">for</span><span style="color:#657b83">(</span><span style="color:#268bd2">j</span><span style="color:#657b83"> </span><span style="color:#859900">in</span><span style="color:#657b83"> </span><span style="color:#d33682">1</span><span style="color:#859900">:</span><span style="color:#268bd2">length</span><span style="color:#657b83">(</span><span style="color:#268bd2">vect</span><span style="color:#657b83">))</span></span>
<span class="line"><span style="color:#657b83">        {</span></span>
<span class="line"><span style="color:#657b83">            </span><span style="color:#859900">if</span><span style="color:#657b83">(</span><span style="color:#268bd2">j</span><span style="color:#657b83"> </span><span style="color:#859900">!=</span><span style="color:#657b83"> </span><span style="color:#268bd2">i</span><span style="color:#657b83">)</span></span>
<span class="line"><span style="color:#657b83">            {</span></span>
<span class="line"><span style="color:#657b83">                </span><span style="color:#859900">if</span><span style="color:#657b83">(</span><span style="color:#268bd2">vect</span><span style="color:#657b83">[</span><span style="color:#268bd2">j</span><span style="color:#657b83">] </span><span style="color:#859900">==</span><span style="color:#657b83"> </span><span style="color:#268bd2">vect</span><span style="color:#657b83">[</span><span style="color:#268bd2">i</span><span style="color:#657b83">])</span></span>
<span class="line"><span style="color:#657b83">                {</span></span>
<span class="line"><span style="color:#657b83">                    </span><span style="color:#268bd2">isunique</span><span style="color:#657b83"> </span><span style="color:#859900">&lt;-</span><span style="color:#657b83"> </span><span style="color:#b58900">FALSE</span></span>
<span class="line"><span style="color:#657b83">                }</span></span>
<span class="line"><span style="color:#657b83">            }</span></span>
<span class="line"><span style="color:#657b83">        }</span></span>
<span class="line"><span style="color:#657b83">    }</span></span>
<span class="line"><span style="color:#657b83">    </span><span style="color:#268bd2">isunique</span></span>
<span class="line"><span style="color:#657b83">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#93a1a1;font-style:italic"># The way we ensure uniqueness may be improuved with faster (and nicer) algorithm</span></span>
<span class="line"><span style="color:#268bd2">ensure_unique</span><span style="color:#657b83"> </span><span style="color:#859900">&lt;-</span><span style="color:#657b83"> </span><span style="color:#859900">function</span><span style="color:#657b83">(</span><span style="color:#268bd2">vect</span><span style="color:#657b83">){</span></span>
<span class="line"><span style="color:#657b83">    </span><span style="color:#859900">while</span><span style="color:#657b83">(is_unique(</span><span style="color:#268bd2">vect</span><span style="color:#657b83">) </span><span style="color:#859900">!=</span><span style="color:#657b83"> </span><span style="color:#b58900">TRUE</span><span style="color:#657b83">)</span></span>
<span class="line"><span style="color:#657b83">    {</span></span>
<span class="line"><span style="color:#657b83">        </span><span style="color:#859900">for</span><span style="color:#657b83">(</span><span style="color:#268bd2">i</span><span style="color:#657b83"> </span><span style="color:#859900">in</span><span style="color:#657b83"> </span><span style="color:#d33682">1</span><span style="color:#859900">:</span><span style="color:#657b83"> </span><span style="color:#268bd2">length</span><span style="color:#657b83">(</span><span style="color:#268bd2">vect</span><span style="color:#657b83">))</span></span>
<span class="line"><span style="color:#657b83">        {</span></span>
<span class="line"><span style="color:#657b83">            </span><span style="color:#268bd2">iterator</span><span style="color:#657b83"> </span><span style="color:#859900">&lt;-</span><span style="color:#657b83"> </span><span style="color:#268bd2">vect</span><span style="color:#657b83">[</span><span style="color:#268bd2">i</span><span style="color:#657b83">]</span></span>
<span class="line"><span style="color:#657b83">            </span><span style="color:#859900">for</span><span style="color:#657b83">(</span><span style="color:#268bd2">j</span><span style="color:#657b83"> </span><span style="color:#859900">in</span><span style="color:#657b83"> </span><span style="color:#d33682">1</span><span style="color:#859900">:</span><span style="color:#268bd2">length</span><span style="color:#657b83">(</span><span style="color:#268bd2">vect</span><span style="color:#657b83">))</span></span>
<span class="line"><span style="color:#657b83">            {</span></span>
<span class="line"><span style="color:#657b83">                </span><span style="color:#859900">if</span><span style="color:#657b83">(</span><span style="color:#268bd2">j</span><span style="color:#657b83"> </span><span style="color:#859900">!=</span><span style="color:#657b83"> </span><span style="color:#268bd2">i</span><span style="color:#657b83">)</span></span>
<span class="line"><span style="color:#657b83">                {</span></span>
<span class="line"><span style="color:#657b83">                    </span><span style="color:#859900">if</span><span style="color:#657b83">(</span><span style="color:#268bd2">iterator</span><span style="color:#657b83"> </span><span style="color:#859900">==</span><span style="color:#657b83"> </span><span style="color:#268bd2">vect</span><span style="color:#657b83">[</span><span style="color:#268bd2">j</span><span style="color:#657b83">] )</span></span>
<span class="line"><span style="color:#657b83">                    {</span></span>
<span class="line"><span style="color:#657b83">                        </span><span style="color:#268bd2">vect</span><span style="color:#657b83">[</span><span style="color:#268bd2">j</span><span style="color:#657b83">] </span><span style="color:#859900">&lt;-</span><span style="color:#657b83"> </span><span style="color:#268bd2">floor</span><span style="color:#657b83">(</span><span style="color:#268bd2">runif</span><span style="color:#657b83">(</span><span style="color:#d33682">1</span><span style="color:#657b83">,min</span><span style="color:#859900">=</span><span style="color:#d33682">1</span><span style="color:#657b83">,max</span><span style="color:#859900">=</span><span style="color:#268bd2">length</span><span style="color:#657b83">(</span><span style="color:#268bd2">vect</span><span style="color:#657b83">)))</span></span>
<span class="line"><span style="color:#657b83">                    }</span></span>
<span class="line"><span style="color:#657b83">                }</span></span>
<span class="line"><span style="color:#657b83">            }</span></span>
<span class="line"><span style="color:#657b83">        }</span></span>
<span class="line"><span style="color:#657b83">    }</span></span>
<span class="line"><span style="color:#657b83">    </span><span style="color:#268bd2">vect</span></span>
<span class="line"><span style="color:#657b83">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#268bd2">init_epidemic</span><span style="color:#657b83"> </span><span style="color:#859900">&lt;-</span><span style="color:#657b83"> </span><span style="color:#859900">function</span><span style="color:#657b83">(</span><span style="color:#268bd2">igraph</span><span style="color:#657b83">,</span><span style="color:#268bd2">n_0</span><span style="color:#657b83">,</span><span style="color:#268bd2">n_d</span><span style="color:#657b83">)</span></span>
<span class="line"><span style="color:#657b83">{</span></span>
<span class="line"><span style="color:#657b83">  </span><span style="color:#268bd2">nb_node</span><span style="color:#657b83"> </span><span style="color:#859900">&lt;-</span><span style="color:#657b83"> vcount(</span><span style="color:#268bd2">igraph</span><span style="color:#657b83">)</span></span>
<span class="line"><span style="color:#657b83">  </span><span style="color:#268bd2">Infected_vect</span><span style="color:#657b83"> </span><span style="color:#859900">&lt;-</span><span style="color:#657b83"> </span><span style="color:#268bd2">floor</span><span style="color:#657b83">(</span><span style="color:#268bd2">runif</span><span style="color:#657b83">(</span><span style="color:#268bd2">n_0</span><span style="color:#657b83">,min</span><span style="color:#859900">=</span><span style="color:#d33682">1</span><span style="color:#657b83">,max</span><span style="color:#859900">=</span><span style="color:#268bd2">nb_node</span><span style="color:#657b83">))</span></span>
<span class="line"><span style="color:#657b83">  </span><span style="color:#268bd2">Infected_vect</span><span style="color:#657b83"> </span><span style="color:#859900">&lt;-</span><span style="color:#657b83"> ensure_unique(</span><span style="color:#268bd2">Infected_vect</span><span style="color:#657b83">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#657b83">  </span><span style="color:#268bd2">igraph</span><span style="color:#657b83"> </span><span style="color:#859900">&lt;-</span><span style="color:#657b83"> set.vertex.attribute(</span><span style="color:#268bd2">igraph</span><span style="color:#657b83">,</span><span style="color:#2aa198">"epidemic"</span><span style="color:#657b83">, value</span><span style="color:#859900">=</span><span style="color:#2aa198">"s"</span><span style="color:#657b83">)</span></span>
<span class="line"><span style="color:#657b83">  </span><span style="color:#268bd2">igraph</span><span style="color:#657b83"> </span><span style="color:#859900">&lt;-</span><span style="color:#657b83"> set.vertex.attribute(</span><span style="color:#268bd2">igraph</span><span style="color:#657b83">,</span><span style="color:#2aa198">"i_time"</span><span style="color:#657b83">, value </span><span style="color:#859900">=</span><span style="color:#657b83"> </span><span style="color:#859900">-</span><span style="color:#d33682">1</span><span style="color:#657b83"> )</span></span>
<span class="line"><span style="color:#657b83">  </span><span style="color:#859900">for</span><span style="color:#657b83">( </span><span style="color:#268bd2">i</span><span style="color:#657b83"> </span><span style="color:#859900">in</span><span style="color:#657b83"> </span><span style="color:#d33682">1</span><span style="color:#657b83"> </span><span style="color:#859900">:</span><span style="color:#657b83"> </span><span style="color:#268bd2">n_0</span><span style="color:#657b83"> )</span></span>
<span class="line"><span style="color:#657b83">  {</span></span>
<span class="line"><span style="color:#657b83">    </span><span style="color:#268bd2">igraph</span><span style="color:#657b83"> </span><span style="color:#859900">&lt;-</span><span style="color:#657b83"> set.vertex.attribute(</span><span style="color:#268bd2">igraph</span><span style="color:#657b83">,</span><span style="color:#2aa198">"epidemic"</span><span style="color:#657b83">, </span><span style="color:#268bd2">Infected_vect</span><span style="color:#657b83">[</span><span style="color:#268bd2">i</span><span style="color:#657b83">] ,value</span><span style="color:#859900">=</span><span style="color:#2aa198">"i"</span><span style="color:#657b83">)</span></span>
<span class="line"><span style="color:#657b83">    </span><span style="color:#268bd2">igraph</span><span style="color:#657b83"> </span><span style="color:#859900">&lt;-</span><span style="color:#657b83"> set.vertex.attribute(</span><span style="color:#268bd2">igraph</span><span style="color:#657b83">,</span><span style="color:#2aa198">"i_time"</span><span style="color:#657b83">, </span><span style="color:#268bd2">Infected_vect</span><span style="color:#657b83">[</span><span style="color:#268bd2">i</span><span style="color:#657b83">] ,value</span><span style="color:#859900">=</span><span style="color:#657b83"> </span><span style="color:#268bd2">n_d</span><span style="color:#657b83"> )</span></span>
<span class="line"><span style="color:#657b83">  }</span></span>
<span class="line"><span style="color:#657b83">  stat_days(</span><span style="color:#268bd2">igraph</span><span style="color:#657b83">)</span></span>
<span class="line"><span style="color:#657b83">  </span><span style="color:#268bd2">igraph</span></span>
<span class="line"><span style="color:#657b83">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#268bd2">infected_heal</span><span style="color:#657b83"> </span><span style="color:#859900">&lt;-</span><span style="color:#657b83"> </span><span style="color:#859900">function</span><span style="color:#657b83">(</span><span style="color:#268bd2">igraph</span><span style="color:#657b83">)</span></span>
<span class="line"><span style="color:#657b83">{</span></span>
<span class="line"><span style="color:#657b83">  </span><span style="color:#268bd2">nb_node</span><span style="color:#657b83"> </span><span style="color:#859900">&lt;-</span><span style="color:#657b83"> vcount(</span><span style="color:#268bd2">igraph</span><span style="color:#657b83">)</span></span>
<span class="line"><span style="color:#657b83">  </span><span style="color:#859900">for</span><span style="color:#657b83">( </span><span style="color:#268bd2">i</span><span style="color:#657b83"> </span><span style="color:#859900">in</span><span style="color:#657b83"> </span><span style="color:#d33682">1</span><span style="color:#859900">:</span><span style="color:#657b83"> </span><span style="color:#268bd2">nb_node</span><span style="color:#657b83">)</span></span>
<span class="line"><span style="color:#657b83">  {</span></span>
<span class="line"><span style="color:#657b83">    </span><span style="color:#268bd2">node_time_status</span><span style="color:#657b83"> </span><span style="color:#859900">&lt;-</span><span style="color:#657b83"> get.vertex.attribute(</span><span style="color:#268bd2">igraph</span><span style="color:#657b83">,</span><span style="color:#2aa198">"i_time"</span><span style="color:#657b83">, </span><span style="color:#268bd2">i</span><span style="color:#657b83">)</span></span>
<span class="line"><span style="color:#657b83">    </span><span style="color:#859900">if</span><span style="color:#657b83">( </span><span style="color:#268bd2">node_time_status</span><span style="color:#657b83"> </span><span style="color:#859900">&gt;</span><span style="color:#657b83"> </span><span style="color:#d33682">0</span><span style="color:#657b83"> )</span></span>
<span class="line"><span style="color:#657b83">    {</span></span>
<span class="line"><span style="color:#657b83">      </span><span style="color:#268bd2">igraph</span><span style="color:#657b83"> </span><span style="color:#859900">&lt;-</span><span style="color:#657b83"> set.vertex.attribute(</span><span style="color:#268bd2">igraph</span><span style="color:#657b83">,</span><span style="color:#2aa198">"i_time"</span><span style="color:#657b83">, </span><span style="color:#268bd2">i</span><span style="color:#657b83"> ,value</span><span style="color:#859900">=</span><span style="color:#657b83"> (</span><span style="color:#268bd2">node_time_status</span><span style="color:#657b83"> </span><span style="color:#859900">-</span><span style="color:#657b83"> </span><span style="color:#d33682">1</span><span style="color:#657b83">) )</span></span>
<span class="line"><span style="color:#657b83">    }</span></span>
<span class="line"><span style="color:#657b83">    </span><span style="color:#859900">if</span><span style="color:#657b83">( </span><span style="color:#268bd2">node_time_status</span><span style="color:#657b83"> </span><span style="color:#859900">==</span><span style="color:#657b83"> </span><span style="color:#d33682">1</span><span style="color:#657b83"> )</span></span>
<span class="line"><span style="color:#657b83">    {</span></span>
<span class="line"><span style="color:#657b83">      </span><span style="color:#268bd2">igraph</span><span style="color:#657b83"> </span><span style="color:#859900">&lt;-</span><span style="color:#657b83"> set.vertex.attribute(</span><span style="color:#268bd2">igraph</span><span style="color:#657b83">,</span><span style="color:#2aa198">"epidemic"</span><span style="color:#657b83">, </span><span style="color:#268bd2">i</span><span style="color:#657b83"> ,value</span><span style="color:#859900">=</span><span style="color:#2aa198">"r"</span><span style="color:#657b83">)</span></span>
<span class="line"><span style="color:#657b83">    }</span></span>
<span class="line"><span style="color:#657b83">  }</span></span>
<span class="line"><span style="color:#657b83">  </span><span style="color:#268bd2">igraph</span></span>
<span class="line"><span style="color:#657b83">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#268bd2">transmission</span><span style="color:#657b83"> </span><span style="color:#859900">&lt;-</span><span style="color:#657b83"> </span><span style="color:#859900">function</span><span style="color:#657b83">(</span><span style="color:#268bd2">igraph</span><span style="color:#657b83">,</span><span style="color:#268bd2">p_epidemic</span><span style="color:#657b83">,</span><span style="color:#268bd2">n_d</span><span style="color:#657b83">)</span></span>
<span class="line"><span style="color:#657b83">{</span></span>
<span class="line"><span style="color:#657b83">  </span><span style="color:#268bd2">igraph</span><span style="color:#657b83"> </span><span style="color:#859900">&lt;-</span><span style="color:#657b83"> infected_heal(</span><span style="color:#268bd2">igraph</span><span style="color:#657b83">)</span></span>
<span class="line"><span style="color:#657b83">  </span><span style="color:#268bd2">nb_node</span><span style="color:#657b83"> </span><span style="color:#859900">&lt;-</span><span style="color:#657b83"> vcount(</span><span style="color:#268bd2">igraph</span><span style="color:#657b83">)</span></span>
<span class="line"><span style="color:#657b83">  </span><span style="color:#268bd2">adj_mat</span><span style="color:#657b83"> </span><span style="color:#859900">&lt;-</span><span style="color:#657b83"> as_adjacency_matrix(</span><span style="color:#268bd2">igraph</span><span style="color:#657b83">, type </span><span style="color:#859900">=</span><span style="color:#657b83"> </span><span style="color:#268bd2">c</span><span style="color:#657b83">(</span><span style="color:#2aa198">"both"</span><span style="color:#657b83">))</span></span>
<span class="line"><span style="color:#657b83">  </span><span style="color:#268bd2">vect_i</span><span style="color:#657b83"> </span><span style="color:#859900">&lt;-</span><span style="color:#657b83"> </span><span style="color:#268bd2">vector</span><span style="color:#657b83">(mode </span><span style="color:#859900">=</span><span style="color:#657b83"> </span><span style="color:#2aa198">"numeric"</span><span style="color:#657b83">,</span><span style="color:#268bd2">nb_node</span><span style="color:#657b83">)</span></span>
<span class="line"><span style="color:#657b83">  </span><span style="color:#268bd2">vect_i_opo</span><span style="color:#657b83"> </span><span style="color:#859900">&lt;-</span><span style="color:#657b83"> </span><span style="color:#268bd2">vector</span><span style="color:#657b83">(mode </span><span style="color:#859900">=</span><span style="color:#657b83"> </span><span style="color:#2aa198">"numeric"</span><span style="color:#657b83">,</span><span style="color:#268bd2">nb_node</span><span style="color:#657b83">)</span></span>
<span class="line"><span style="color:#657b83">  </span><span style="color:#859900">for</span><span style="color:#657b83">(</span><span style="color:#268bd2">i</span><span style="color:#657b83"> </span><span style="color:#859900">in</span><span style="color:#657b83"> </span><span style="color:#d33682">1</span><span style="color:#859900">:</span><span style="color:#268bd2">nb_node</span><span style="color:#657b83">)</span></span>
<span class="line"><span style="color:#657b83">  {</span></span>
<span class="line"><span style="color:#657b83">    </span><span style="color:#268bd2">node_status</span><span style="color:#657b83"> </span><span style="color:#859900">&lt;-</span><span style="color:#657b83"> get.vertex.attribute(</span><span style="color:#268bd2">igraph</span><span style="color:#657b83">,</span><span style="color:#2aa198">"epidemic"</span><span style="color:#657b83">, </span><span style="color:#268bd2">i</span><span style="color:#657b83">)</span></span>
<span class="line"><span style="color:#657b83">    </span><span style="color:#859900">if</span><span style="color:#657b83">( </span><span style="color:#268bd2">node_status</span><span style="color:#657b83"> </span><span style="color:#859900">==</span><span style="color:#657b83"> </span><span style="color:#2aa198">"i"</span><span style="color:#657b83"> )</span></span>
<span class="line"><span style="color:#657b83">    {</span></span>
<span class="line"><span style="color:#657b83">      </span><span style="color:#268bd2">vect_i</span><span style="color:#657b83">[</span><span style="color:#268bd2">i</span><span style="color:#657b83">] </span><span style="color:#859900">&lt;-</span><span style="color:#657b83"> </span><span style="color:#d33682">1</span></span>
<span class="line"><span style="color:#657b83">      </span><span style="color:#268bd2">vect_i_opo</span><span style="color:#657b83">[</span><span style="color:#268bd2">i</span><span style="color:#657b83">] </span><span style="color:#859900">&lt;-</span><span style="color:#657b83"> </span><span style="color:#d33682">0</span></span>
<span class="line"><span style="color:#657b83">    }</span></span>
<span class="line"><span style="color:#657b83">    </span><span style="color:#859900">else</span></span>
<span class="line"><span style="color:#657b83">    {</span></span>
<span class="line"><span style="color:#657b83">      </span><span style="color:#268bd2">vect_i</span><span style="color:#657b83">[</span><span style="color:#268bd2">i</span><span style="color:#657b83">] </span><span style="color:#859900">&lt;-</span><span style="color:#657b83"> </span><span style="color:#d33682">0</span></span>
<span class="line"><span style="color:#657b83">      </span><span style="color:#268bd2">vect_i_opo</span><span style="color:#657b83">[</span><span style="color:#268bd2">i</span><span style="color:#657b83">] </span><span style="color:#859900">&lt;-</span><span style="color:#657b83"> </span><span style="color:#d33682">1</span></span>
<span class="line"><span style="color:#657b83">    }</span></span>
<span class="line"><span style="color:#657b83">  }</span></span>
<span class="line"><span style="color:#657b83">  </span><span style="color:#268bd2">vect_r_op</span><span style="color:#657b83"> </span><span style="color:#859900">&lt;-</span><span style="color:#657b83"> </span><span style="color:#268bd2">vector</span><span style="color:#657b83">(mode </span><span style="color:#859900">=</span><span style="color:#657b83"> </span><span style="color:#2aa198">"numeric"</span><span style="color:#657b83">,</span><span style="color:#268bd2">nb_node</span><span style="color:#657b83">)</span></span>
<span class="line"><span style="color:#657b83">  </span><span style="color:#859900">for</span><span style="color:#657b83">(</span><span style="color:#268bd2">i</span><span style="color:#657b83"> </span><span style="color:#859900">in</span><span style="color:#657b83"> </span><span style="color:#d33682">1</span><span style="color:#859900">:</span><span style="color:#268bd2">nb_node</span><span style="color:#657b83">)</span></span>
<span class="line"><span style="color:#657b83">  {</span></span>
<span class="line"><span style="color:#657b83">    </span><span style="color:#268bd2">node_status</span><span style="color:#657b83"> </span><span style="color:#859900">&lt;-</span><span style="color:#657b83"> get.vertex.attribute(</span><span style="color:#268bd2">igraph</span><span style="color:#657b83">,</span><span style="color:#2aa198">"epidemic"</span><span style="color:#657b83">, </span><span style="color:#268bd2">i</span><span style="color:#657b83">)</span></span>
<span class="line"><span style="color:#657b83">    </span><span style="color:#859900">if</span><span style="color:#657b83">( </span><span style="color:#268bd2">node_status</span><span style="color:#657b83"> </span><span style="color:#859900">==</span><span style="color:#657b83"> </span><span style="color:#2aa198">"r"</span><span style="color:#657b83"> )</span></span>
<span class="line"><span style="color:#657b83">    {</span></span>
<span class="line"><span style="color:#657b83">      </span><span style="color:#268bd2">vect_r_op</span><span style="color:#657b83">[</span><span style="color:#268bd2">i</span><span style="color:#657b83">] </span><span style="color:#859900">&lt;-</span><span style="color:#657b83"> </span><span style="color:#d33682">0</span></span>
<span class="line"><span style="color:#657b83">    }</span></span>
<span class="line"><span style="color:#657b83">    </span><span style="color:#859900">else</span></span>
<span class="line"><span style="color:#657b83">    {</span></span>
<span class="line"><span style="color:#657b83">      </span><span style="color:#268bd2">vect_r_op</span><span style="color:#657b83">[</span><span style="color:#268bd2">i</span><span style="color:#657b83">] </span><span style="color:#859900">&lt;-</span><span style="color:#657b83"> </span><span style="color:#d33682">1</span></span>
<span class="line"><span style="color:#657b83">    }</span></span>
<span class="line"><span style="color:#657b83">  }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#657b83">  </span><span style="color:#268bd2">neigbour_infected_vect</span><span style="color:#657b83"> </span><span style="color:#859900">&lt;-</span><span style="color:#657b83"> </span><span style="color:#268bd2">adj_mat</span><span style="color:#859900">%*%</span><span style="color:#268bd2">vect_i</span></span>
<span class="line"><span style="color:#657b83">  </span><span style="color:#268bd2">try_infect</span><span style="color:#657b83"> </span><span style="color:#859900">&lt;-</span><span style="color:#657b83"> </span><span style="color:#268bd2">as.vector</span><span style="color:#657b83">(</span><span style="color:#268bd2">neigbour_infected_vect</span><span style="color:#657b83">)</span><span style="color:#859900">*</span><span style="color:#268bd2">vect_r_op</span><span style="color:#859900">*</span><span style="color:#268bd2">vect_i_opo</span></span>
<span class="line"><span style="color:#657b83">  </span><span style="color:#859900">for</span><span style="color:#657b83">(</span><span style="color:#268bd2">i</span><span style="color:#657b83"> </span><span style="color:#859900">in</span><span style="color:#657b83"> </span><span style="color:#d33682">1</span><span style="color:#859900">:</span><span style="color:#268bd2">nb_node</span><span style="color:#657b83">)</span></span>
<span class="line"><span style="color:#657b83">  {</span></span>
<span class="line"><span style="color:#657b83">    </span><span style="color:#859900">if</span><span style="color:#657b83">(</span><span style="color:#268bd2">try_infect</span><span style="color:#657b83">[</span><span style="color:#268bd2">i</span><span style="color:#657b83">] </span><span style="color:#859900">&gt;</span><span style="color:#657b83"> </span><span style="color:#d33682">0</span><span style="color:#657b83"> )</span></span>
<span class="line"><span style="color:#657b83">    {</span></span>
<span class="line"><span style="color:#657b83">      </span><span style="color:#859900">for</span><span style="color:#657b83">(</span><span style="color:#268bd2">j</span><span style="color:#657b83"> </span><span style="color:#859900">in</span><span style="color:#657b83"> </span><span style="color:#d33682">1</span><span style="color:#859900">:</span><span style="color:#268bd2">try_infect</span><span style="color:#657b83">[</span><span style="color:#268bd2">i</span><span style="color:#657b83">] )</span></span>
<span class="line"><span style="color:#657b83">      {</span></span>
<span class="line"><span style="color:#657b83">        </span><span style="color:#859900">if</span><span style="color:#657b83">(</span><span style="color:#268bd2">runif</span><span style="color:#657b83">(</span><span style="color:#d33682">1</span><span style="color:#657b83">) </span><span style="color:#859900">&lt;</span><span style="color:#657b83"> </span><span style="color:#268bd2">p_epidemic</span><span style="color:#657b83">)</span></span>
<span class="line"><span style="color:#657b83">        {</span></span>
<span class="line"><span style="color:#657b83">          </span><span style="color:#268bd2">igraph</span><span style="color:#657b83"> </span><span style="color:#859900">&lt;-</span><span style="color:#657b83"> set.vertex.attribute(</span><span style="color:#268bd2">igraph</span><span style="color:#657b83">,</span><span style="color:#2aa198">"epidemic"</span><span style="color:#657b83">, </span><span style="color:#268bd2">i</span><span style="color:#657b83"> ,value</span><span style="color:#859900">=</span><span style="color:#2aa198">"i"</span><span style="color:#657b83">)</span></span>
<span class="line"><span style="color:#657b83">          </span><span style="color:#268bd2">igraph</span><span style="color:#657b83"> </span><span style="color:#859900">&lt;-</span><span style="color:#657b83"> set.vertex.attribute(</span><span style="color:#268bd2">igraph</span><span style="color:#657b83">,</span><span style="color:#2aa198">"i_time"</span><span style="color:#657b83">, </span><span style="color:#268bd2">i</span><span style="color:#657b83"> ,value</span><span style="color:#859900">=</span><span style="color:#657b83"> </span><span style="color:#268bd2">n_d</span><span style="color:#657b83"> )</span></span>
<span class="line"><span style="color:#657b83">        }</span></span>
<span class="line"><span style="color:#657b83">      }</span></span>
<span class="line"><span style="color:#657b83">    }</span></span>
<span class="line"><span style="color:#657b83">  }</span></span>
<span class="line"><span style="color:#657b83">  </span><span style="color:#859900">for</span><span style="color:#657b83">(</span><span style="color:#268bd2">i</span><span style="color:#657b83"> </span><span style="color:#859900">in</span><span style="color:#657b83"> </span><span style="color:#d33682">1</span><span style="color:#859900">:</span><span style="color:#268bd2">nb_node</span><span style="color:#657b83">)</span></span>
<span class="line"><span style="color:#657b83">  {</span></span>
<span class="line"><span style="color:#657b83">    </span><span style="color:#859900">if</span><span style="color:#657b83">(</span><span style="color:#268bd2">try_infect</span><span style="color:#657b83">[</span><span style="color:#268bd2">i</span><span style="color:#657b83">] </span><span style="color:#859900">&gt;</span><span style="color:#657b83"> </span><span style="color:#d33682">0</span><span style="color:#657b83"> )</span></span>
<span class="line"><span style="color:#657b83">    {</span></span>
<span class="line"><span style="color:#657b83">      </span><span style="color:#859900">for</span><span style="color:#657b83">(</span><span style="color:#268bd2">j</span><span style="color:#657b83"> </span><span style="color:#859900">in</span><span style="color:#657b83"> </span><span style="color:#d33682">1</span><span style="color:#859900">:</span><span style="color:#268bd2">try_infect</span><span style="color:#657b83">[</span><span style="color:#268bd2">i</span><span style="color:#657b83">] )</span></span>
<span class="line"><span style="color:#657b83">      {</span></span>
<span class="line"><span style="color:#657b83">        </span><span style="color:#859900">if</span><span style="color:#657b83">(</span><span style="color:#268bd2">runif</span><span style="color:#657b83">(</span><span style="color:#d33682">1</span><span style="color:#657b83">) </span><span style="color:#859900">&lt;</span><span style="color:#657b83"> </span><span style="color:#268bd2">p_epidemic</span><span style="color:#657b83">)</span></span>
<span class="line"><span style="color:#657b83">        {</span></span>
<span class="line"><span style="color:#657b83">          </span><span style="color:#268bd2">igraph</span><span style="color:#657b83"> </span><span style="color:#859900">&lt;-</span><span style="color:#657b83"> set.vertex.attribute(</span><span style="color:#268bd2">igraph</span><span style="color:#657b83">,</span><span style="color:#2aa198">"epidemic"</span><span style="color:#657b83">, </span><span style="color:#268bd2">i</span><span style="color:#657b83"> ,value</span><span style="color:#859900">=</span><span style="color:#2aa198">"i"</span><span style="color:#657b83">)</span></span>
<span class="line"><span style="color:#657b83">          </span><span style="color:#268bd2">igraph</span><span style="color:#657b83"> </span><span style="color:#859900">&lt;-</span><span style="color:#657b83"> set.vertex.attribute(</span><span style="color:#268bd2">igraph</span><span style="color:#657b83">,</span><span style="color:#2aa198">"i_time"</span><span style="color:#657b83">, </span><span style="color:#268bd2">i</span><span style="color:#657b83"> ,value</span><span style="color:#859900">=</span><span style="color:#657b83"> </span><span style="color:#268bd2">n_d</span><span style="color:#657b83"> )</span></span>
<span class="line"><span style="color:#657b83">        }</span></span>
<span class="line"><span style="color:#657b83">      }</span></span>
<span class="line"><span style="color:#657b83">    }</span></span>
<span class="line"><span style="color:#657b83">  }</span></span>
<span class="line"><span style="color:#657b83">  </span><span style="color:#268bd2">igraph</span></span>
<span class="line"><span style="color:#657b83">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#268bd2">stat_days</span><span style="color:#657b83"> </span><span style="color:#859900">&lt;-</span><span style="color:#657b83"> </span><span style="color:#859900">function</span><span style="color:#657b83">(</span><span style="color:#268bd2">igraph</span><span style="color:#657b83">)</span></span>
<span class="line"><span style="color:#657b83">{</span></span>
<span class="line"><span style="color:#657b83">  </span><span style="color:#268bd2">nb_node</span><span style="color:#657b83"> </span><span style="color:#859900">&lt;-</span><span style="color:#657b83"> vcount(</span><span style="color:#268bd2">igraph</span><span style="color:#657b83">)</span></span>
<span class="line"><span style="color:#657b83">  </span><span style="color:#268bd2">tot_i</span><span style="color:#657b83"> </span><span style="color:#859900">&lt;-</span><span style="color:#657b83"> </span><span style="color:#d33682">0</span></span>
<span class="line"><span style="color:#657b83">  </span><span style="color:#268bd2">tot_s</span><span style="color:#657b83"> </span><span style="color:#859900">&lt;-</span><span style="color:#657b83"> </span><span style="color:#d33682">0</span></span>
<span class="line"><span style="color:#657b83">  </span><span style="color:#268bd2">tot_r</span><span style="color:#657b83"> </span><span style="color:#859900">&lt;-</span><span style="color:#657b83"> </span><span style="color:#d33682">0</span></span>
<span class="line"><span style="color:#657b83">  </span><span style="color:#268bd2">res</span><span style="color:#657b83"> </span><span style="color:#859900">&lt;-</span><span style="color:#657b83"> </span><span style="color:#268bd2">vector</span><span style="color:#657b83">(mode </span><span style="color:#859900">=</span><span style="color:#657b83"> </span><span style="color:#2aa198">"numeric"</span><span style="color:#657b83">)</span></span>
<span class="line"><span style="color:#657b83">  </span><span style="color:#859900">for</span><span style="color:#657b83">(</span><span style="color:#268bd2">i</span><span style="color:#657b83"> </span><span style="color:#859900">in</span><span style="color:#657b83"> </span><span style="color:#d33682">1</span><span style="color:#859900">:</span><span style="color:#268bd2">nb_node</span><span style="color:#657b83">)</span></span>
<span class="line"><span style="color:#657b83">  {</span></span>
<span class="line"><span style="color:#657b83">    </span><span style="color:#268bd2">epi</span><span style="color:#657b83"> </span><span style="color:#859900">&lt;-</span><span style="color:#657b83"> get.vertex.attribute(</span><span style="color:#268bd2">igraph</span><span style="color:#657b83">,</span><span style="color:#2aa198">"epidemic"</span><span style="color:#657b83">, </span><span style="color:#268bd2">i</span><span style="color:#657b83"> )</span></span>
<span class="line"><span style="color:#657b83">    </span><span style="color:#859900">if</span><span style="color:#657b83">(</span><span style="color:#268bd2">epi</span><span style="color:#657b83"> </span><span style="color:#859900">==</span><span style="color:#657b83"> </span><span style="color:#2aa198">"i"</span><span style="color:#657b83"> )</span></span>
<span class="line"><span style="color:#657b83">    {</span></span>
<span class="line"><span style="color:#657b83">      </span><span style="color:#268bd2">tot_i</span><span style="color:#657b83"> </span><span style="color:#859900">&lt;-</span><span style="color:#657b83"> </span><span style="color:#268bd2">tot_i</span><span style="color:#657b83"> </span><span style="color:#859900">+</span><span style="color:#657b83"> </span><span style="color:#d33682">1</span></span>
<span class="line"><span style="color:#657b83">    }</span></span>
<span class="line"><span style="color:#657b83">    </span><span style="color:#859900">if</span><span style="color:#657b83">(</span><span style="color:#268bd2">epi</span><span style="color:#657b83"> </span><span style="color:#859900">==</span><span style="color:#657b83"> </span><span style="color:#2aa198">"s"</span><span style="color:#657b83"> )</span></span>
<span class="line"><span style="color:#657b83">    {</span></span>
<span class="line"><span style="color:#657b83">      </span><span style="color:#268bd2">tot_s</span><span style="color:#657b83"> </span><span style="color:#859900">&lt;-</span><span style="color:#657b83"> </span><span style="color:#268bd2">tot_s</span><span style="color:#657b83"> </span><span style="color:#859900">+</span><span style="color:#657b83"> </span><span style="color:#d33682">1</span></span>
<span class="line"><span style="color:#657b83">    }</span></span>
<span class="line"><span style="color:#657b83">    </span><span style="color:#859900">if</span><span style="color:#657b83">(</span><span style="color:#268bd2">epi</span><span style="color:#657b83"> </span><span style="color:#859900">==</span><span style="color:#657b83"> </span><span style="color:#2aa198">"r"</span><span style="color:#657b83"> )</span></span>
<span class="line"><span style="color:#657b83">    {</span></span>
<span class="line"><span style="color:#657b83">      </span><span style="color:#268bd2">tot_r</span><span style="color:#657b83"> </span><span style="color:#859900">&lt;-</span><span style="color:#657b83"> </span><span style="color:#268bd2">tot_r</span><span style="color:#657b83"> </span><span style="color:#859900">+</span><span style="color:#657b83"> </span><span style="color:#d33682">1</span></span>
<span class="line"><span style="color:#657b83">    }</span></span>
<span class="line"><span style="color:#657b83">  }</span></span>
<span class="line"><span style="color:#657b83">  </span><span style="color:#268bd2">res</span><span style="color:#657b83">[</span><span style="color:#d33682">1</span><span style="color:#657b83">] </span><span style="color:#859900">&lt;-</span><span style="color:#657b83"> </span><span style="color:#268bd2">tot_i</span></span>
<span class="line"><span style="color:#657b83">  </span><span style="color:#268bd2">res</span><span style="color:#657b83">[</span><span style="color:#d33682">2</span><span style="color:#657b83">] </span><span style="color:#859900">&lt;-</span><span style="color:#657b83"> </span><span style="color:#268bd2">tot_s</span></span>
<span class="line"><span style="color:#657b83">  </span><span style="color:#268bd2">res</span><span style="color:#657b83">[</span><span style="color:#d33682">3</span><span style="color:#657b83">] </span><span style="color:#859900">&lt;-</span><span style="color:#657b83"> </span><span style="color:#268bd2">tot_r</span></span>
<span class="line"><span style="color:#657b83">  </span><span style="color:#268bd2">cat</span><span style="color:#657b83">(</span><span style="color:#2aa198">"Sucesptible: "</span><span style="color:#657b83">,</span><span style="color:#268bd2">res</span><span style="color:#657b83">[</span><span style="color:#d33682">2</span><span style="color:#657b83">],</span><span style="color:#2aa198">" Infected: "</span><span style="color:#657b83">,</span><span style="color:#268bd2">res</span><span style="color:#657b83">[</span><span style="color:#d33682">1</span><span style="color:#657b83">],</span><span style="color:#2aa198">"Recoverd: "</span><span style="color:#657b83">,</span><span style="color:#268bd2">res</span><span style="color:#657b83">[</span><span style="color:#d33682">3</span><span style="color:#657b83">],</span><span style="color:#2aa198">"</span><span style="color:#cb4b16">\n</span><span style="color:#2aa198">"</span><span style="color:#657b83">)</span></span>
<span class="line"><span style="color:#657b83">  </span><span style="color:#268bd2">res</span></span>
<span class="line"><span style="color:#657b83">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#268bd2">simulation</span><span style="color:#657b83"> </span><span style="color:#859900">&lt;-</span><span style="color:#657b83"> </span><span style="color:#859900">function</span><span style="color:#657b83">(</span><span style="color:#268bd2">igraph</span><span style="color:#657b83">,</span><span style="color:#268bd2">p_epidemic</span><span style="color:#657b83">,</span><span style="color:#268bd2">n_d</span><span style="color:#657b83">,</span><span style="color:#268bd2">time</span><span style="color:#657b83">,</span><span style="color:#268bd2">confinement_high</span><span style="color:#657b83">,</span><span style="color:#268bd2">confinement_low</span><span style="color:#657b83">,</span><span style="color:#268bd2">restriction_percentages</span><span style="color:#657b83">,</span><span style="color:#268bd2">travel_limitation</span><span style="color:#657b83">)</span></span>
<span class="line"><span style="color:#657b83">{</span></span>
<span class="line"><span style="color:#657b83">  </span><span style="color:#268bd2">cat</span><span style="color:#657b83">(</span><span style="color:#2aa198">"Begin simulation </span><span style="color:#cb4b16">\n</span><span style="color:#2aa198">"</span><span style="color:#657b83">)</span></span>
<span class="line"><span style="color:#657b83">  </span><span style="color:#268bd2">init_graph</span><span style="color:#657b83"> </span><span style="color:#859900">&lt;-</span><span style="color:#657b83"> </span><span style="color:#268bd2">igraph</span></span>
<span class="line"><span style="color:#657b83">  </span><span style="color:#268bd2">mat_res</span><span style="color:#657b83"> </span><span style="color:#859900">&lt;-</span><span style="color:#657b83"> </span><span style="color:#268bd2">matrix</span><span style="color:#657b83">(ncol </span><span style="color:#859900">=</span><span style="color:#657b83"> </span><span style="color:#268bd2">time</span><span style="color:#859900">+</span><span style="color:#d33682">1</span><span style="color:#657b83">,nrow </span><span style="color:#859900">=</span><span style="color:#657b83"> </span><span style="color:#d33682">3</span><span style="color:#657b83"> )</span></span>
<span class="line"><span style="color:#657b83">  </span><span style="color:#268bd2">mat_res</span><span style="color:#657b83">[,</span><span style="color:#d33682">1</span><span style="color:#657b83"> ] </span><span style="color:#859900">&lt;-</span><span style="color:#657b83"> stat_days(</span><span style="color:#268bd2">igraph</span><span style="color:#657b83">)</span></span>
<span class="line"><span style="color:#657b83">  </span><span style="color:#859900">if</span><span style="color:#657b83">(</span><span style="color:#268bd2">travel_limitation</span><span style="color:#657b83"> </span><span style="color:#859900">==</span><span style="color:#657b83"> </span><span style="color:#b58900">TRUE</span><span style="color:#657b83"> )</span></span>
<span class="line"><span style="color:#657b83">  {</span></span>
<span class="line"><span style="color:#657b83">    </span><span style="color:#268bd2">restrictions</span><span style="color:#657b83"> </span><span style="color:#859900">&lt;-</span><span style="color:#657b83"> </span><span style="color:#b58900">FALSE</span></span>
<span class="line"><span style="color:#657b83">    </span><span style="color:#859900">for</span><span style="color:#657b83">(</span><span style="color:#268bd2">i</span><span style="color:#657b83"> </span><span style="color:#859900">in</span><span style="color:#657b83"> </span><span style="color:#d33682">1</span><span style="color:#859900">:</span><span style="color:#268bd2">time</span><span style="color:#657b83"> )</span></span>
<span class="line"><span style="color:#657b83">    {</span></span>
<span class="line"><span style="color:#657b83">      </span><span style="color:#268bd2">strday</span><span style="color:#657b83"> </span><span style="color:#859900">&lt;-</span><span style="color:#657b83"> </span><span style="color:#268bd2">c</span><span style="color:#657b83">(</span><span style="color:#2aa198">"Day N"</span><span style="color:#657b83">,</span><span style="color:#268bd2">toString</span><span style="color:#657b83">(</span><span style="color:#268bd2">i</span><span style="color:#657b83">))</span></span>
<span class="line"><span style="color:#657b83">      </span><span style="color:#268bd2">cat</span><span style="color:#657b83">(</span><span style="color:#268bd2">strday</span><span style="color:#657b83">,</span><span style="color:#2aa198">"</span><span style="color:#cb4b16">\n</span><span style="color:#2aa198">"</span><span style="color:#657b83">)</span></span>
<span class="line"><span style="color:#657b83">      </span><span style="color:#268bd2">igraph</span><span style="color:#657b83"> </span><span style="color:#859900">&lt;-</span><span style="color:#657b83"> transmission(</span><span style="color:#268bd2">igraph</span><span style="color:#657b83">,</span><span style="color:#268bd2">p_epidemic</span><span style="color:#657b83">,</span><span style="color:#268bd2">n_d</span><span style="color:#657b83">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#657b83">      </span><span style="color:#859900">if</span><span style="color:#657b83">(</span><span style="color:#268bd2">restrictions</span><span style="color:#657b83"> </span><span style="color:#859900">==</span><span style="color:#657b83"> </span><span style="color:#b58900">FALSE</span><span style="color:#657b83"> </span><span style="color:#859900">&amp;&amp;</span><span style="color:#657b83"> confine_required(</span><span style="color:#268bd2">igraph</span><span style="color:#657b83">,</span><span style="color:#268bd2">confinement_high</span><span style="color:#657b83">,</span><span style="color:#268bd2">confinement_low</span><span style="color:#657b83">,</span><span style="color:#268bd2">restrictions</span><span style="color:#657b83">) </span><span style="color:#859900">==</span><span style="color:#657b83"> </span><span style="color:#b58900">TRUE</span><span style="color:#657b83">  )</span></span>
<span class="line"><span style="color:#657b83">      {</span></span>
<span class="line"><span style="color:#657b83">        </span><span style="color:#268bd2">cat</span><span style="color:#657b83">(</span><span style="color:#2aa198">"Day of limitations implemention</span><span style="color:#cb4b16">\n</span><span style="color:#2aa198">"</span><span style="color:#657b83">)</span></span>
<span class="line"><span style="color:#657b83">        </span><span style="color:#268bd2">igraph</span><span style="color:#657b83"> </span><span style="color:#859900">&lt;-</span><span style="color:#657b83"> graph_with_restrictions(</span><span style="color:#268bd2">igraph</span><span style="color:#657b83">,</span><span style="color:#268bd2">restriction_percentages</span><span style="color:#657b83">)</span></span>
<span class="line"><span style="color:#657b83">        </span><span style="color:#268bd2">restrictions</span><span style="color:#657b83"> </span><span style="color:#859900">&lt;-</span><span style="color:#657b83"> </span><span style="color:#b58900">TRUE</span></span>
<span class="line"><span style="color:#657b83">      }</span></span>
<span class="line"><span style="color:#657b83">      </span><span style="color:#859900">if</span><span style="color:#657b83">(</span><span style="color:#268bd2">restrictions</span><span style="color:#657b83"> </span><span style="color:#859900">==</span><span style="color:#657b83"> </span><span style="color:#b58900">TRUE</span><span style="color:#657b83"> </span><span style="color:#859900">&amp;&amp;</span><span style="color:#657b83"> confine_required(</span><span style="color:#268bd2">igraph</span><span style="color:#657b83">,</span><span style="color:#268bd2">confinement_high</span><span style="color:#657b83">,</span><span style="color:#268bd2">confinement_low</span><span style="color:#657b83">,</span><span style="color:#268bd2">restrictions</span><span style="color:#657b83">) </span><span style="color:#859900">==</span><span style="color:#657b83"> </span><span style="color:#b58900">FALSE</span><span style="color:#657b83">  )</span></span>
<span class="line"><span style="color:#657b83">      {</span></span>
<span class="line"><span style="color:#657b83">        </span><span style="color:#268bd2">cat</span><span style="color:#657b83">(</span><span style="color:#2aa198">"Day of UNDO limitations implemention</span><span style="color:#cb4b16">\n</span><span style="color:#2aa198">"</span><span style="color:#657b83">)</span></span>
<span class="line"><span style="color:#657b83">        </span><span style="color:#268bd2">igraph</span><span style="color:#657b83"> </span><span style="color:#859900">&lt;-</span><span style="color:#657b83"> undo_graph_with_restrictions(</span><span style="color:#268bd2">igraph</span><span style="color:#657b83">,</span><span style="color:#268bd2">init_graph</span><span style="color:#657b83">)</span></span>
<span class="line"><span style="color:#657b83">        </span><span style="color:#268bd2">restrictions</span><span style="color:#657b83"> </span><span style="color:#859900">&lt;-</span><span style="color:#657b83"> </span><span style="color:#b58900">FALSE</span></span>
<span class="line"><span style="color:#657b83">      }</span></span>
<span class="line"><span style="color:#657b83">      </span><span style="color:#268bd2">restrans</span><span style="color:#657b83"> </span><span style="color:#859900">&lt;-</span><span style="color:#657b83"> stat_days(</span><span style="color:#268bd2">igraph</span><span style="color:#657b83">)</span></span>
<span class="line"><span style="color:#657b83">      </span><span style="color:#268bd2">mat_res</span><span style="color:#657b83">[, (</span><span style="color:#268bd2">i</span><span style="color:#859900">+</span><span style="color:#d33682">1</span><span style="color:#657b83">) ] </span><span style="color:#859900">&lt;-</span><span style="color:#657b83"> </span><span style="color:#268bd2">restrans</span></span>
<span class="line"><span style="color:#657b83">    }</span></span>
<span class="line"><span style="color:#657b83">  }</span><span style="color:#859900">else</span><span style="color:#657b83"> </span><span style="color:#859900">if</span><span style="color:#657b83">(</span><span style="color:#268bd2">travel_limitation</span><span style="color:#657b83"> </span><span style="color:#859900">==</span><span style="color:#657b83"> </span><span style="color:#b58900">FALSE</span><span style="color:#657b83"> ){</span></span>
<span class="line"><span style="color:#657b83">    </span><span style="color:#859900">for</span><span style="color:#657b83">(</span><span style="color:#268bd2">i</span><span style="color:#657b83"> </span><span style="color:#859900">in</span><span style="color:#657b83"> </span><span style="color:#d33682">1</span><span style="color:#859900">:</span><span style="color:#268bd2">time</span><span style="color:#657b83"> )</span></span>
<span class="line"><span style="color:#657b83">    {</span></span>
<span class="line"><span style="color:#657b83">      </span><span style="color:#268bd2">strday</span><span style="color:#657b83"> </span><span style="color:#859900">&lt;-</span><span style="color:#657b83"> </span><span style="color:#268bd2">c</span><span style="color:#657b83">(</span><span style="color:#2aa198">"Day N"</span><span style="color:#657b83">,</span><span style="color:#268bd2">toString</span><span style="color:#657b83">(</span><span style="color:#268bd2">i</span><span style="color:#657b83">))</span></span>
<span class="line"><span style="color:#657b83">      </span><span style="color:#268bd2">cat</span><span style="color:#657b83">(</span><span style="color:#268bd2">strday</span><span style="color:#657b83">,</span><span style="color:#2aa198">"</span><span style="color:#cb4b16">\n</span><span style="color:#2aa198">"</span><span style="color:#657b83">)</span></span>
<span class="line"><span style="color:#657b83">      </span><span style="color:#268bd2">igraph</span><span style="color:#657b83"> </span><span style="color:#859900">&lt;-</span><span style="color:#657b83"> transmission(</span><span style="color:#268bd2">igraph</span><span style="color:#657b83">,</span><span style="color:#268bd2">p_epidemic</span><span style="color:#657b83">,</span><span style="color:#268bd2">n_d</span><span style="color:#657b83">)</span></span>
<span class="line"><span style="color:#657b83">      </span><span style="color:#268bd2">restrans</span><span style="color:#657b83"> </span><span style="color:#859900">&lt;-</span><span style="color:#657b83"> stat_days(</span><span style="color:#268bd2">igraph</span><span style="color:#657b83">)</span></span>
<span class="line"><span style="color:#657b83">      </span><span style="color:#268bd2">mat_res</span><span style="color:#657b83">[, (</span><span style="color:#268bd2">i</span><span style="color:#859900">+</span><span style="color:#d33682">1</span><span style="color:#657b83">) ] </span><span style="color:#859900">&lt;-</span><span style="color:#657b83"> </span><span style="color:#268bd2">restrans</span></span>
<span class="line"><span style="color:#657b83">    }</span></span>
<span class="line"><span style="color:#657b83">  }</span></span>
<span class="line"><span style="color:#657b83">  </span><span style="color:#268bd2">mat_res</span></span>
<span class="line"><span style="color:#657b83">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#268bd2">undo_graph_with_restrictions</span><span style="color:#657b83"> </span><span style="color:#859900">&lt;-</span><span style="color:#657b83"> </span><span style="color:#859900">function</span><span style="color:#657b83">(</span><span style="color:#268bd2">graph_now</span><span style="color:#657b83">,</span><span style="color:#268bd2">graph_init</span><span style="color:#657b83">){</span></span>
<span class="line"><span style="color:#657b83">  </span><span style="color:#268bd2">nb_node</span><span style="color:#657b83"> </span><span style="color:#859900">&lt;-</span><span style="color:#657b83"> vcount(</span><span style="color:#268bd2">graph_now</span><span style="color:#657b83">)</span></span>
<span class="line"><span style="color:#657b83">  </span><span style="color:#859900">for</span><span style="color:#657b83">( </span><span style="color:#268bd2">i</span><span style="color:#657b83"> </span><span style="color:#859900">in</span><span style="color:#657b83"> </span><span style="color:#d33682">1</span><span style="color:#859900">:</span><span style="color:#657b83"> </span><span style="color:#268bd2">nb_node</span><span style="color:#657b83">)</span></span>
<span class="line"><span style="color:#657b83">  {</span></span>
<span class="line"><span style="color:#657b83">    </span><span style="color:#268bd2">epi</span><span style="color:#657b83"> </span><span style="color:#859900">&lt;-</span><span style="color:#657b83"> get.vertex.attribute(</span><span style="color:#268bd2">graph_now</span><span style="color:#657b83">,</span><span style="color:#2aa198">"epidemic"</span><span style="color:#657b83">, </span><span style="color:#268bd2">i</span><span style="color:#657b83"> )</span></span>
<span class="line"><span style="color:#657b83">    </span><span style="color:#268bd2">itime</span><span style="color:#657b83"> </span><span style="color:#859900">&lt;-</span><span style="color:#657b83"> get.vertex.attribute(</span><span style="color:#268bd2">graph_now</span><span style="color:#657b83">,</span><span style="color:#2aa198">"i_time"</span><span style="color:#657b83">, </span><span style="color:#268bd2">i</span><span style="color:#657b83"> )</span></span>
<span class="line"><span style="color:#657b83">    </span><span style="color:#268bd2">graph_init</span><span style="color:#657b83"> </span><span style="color:#859900">&lt;-</span><span style="color:#657b83"> set.vertex.attribute(</span><span style="color:#268bd2">graph_init</span><span style="color:#657b83">,</span><span style="color:#2aa198">"epidemic"</span><span style="color:#657b83">, </span><span style="color:#268bd2">i</span><span style="color:#657b83"> ,value</span><span style="color:#859900">=</span><span style="color:#268bd2">epi</span><span style="color:#657b83">)</span></span>
<span class="line"><span style="color:#657b83">    </span><span style="color:#268bd2">graph_init</span><span style="color:#657b83"> </span><span style="color:#859900">&lt;-</span><span style="color:#657b83"> set.vertex.attribute(</span><span style="color:#268bd2">graph_init</span><span style="color:#657b83">,</span><span style="color:#2aa198">"i_time"</span><span style="color:#657b83">, </span><span style="color:#268bd2">i</span><span style="color:#657b83"> ,value</span><span style="color:#859900">=</span><span style="color:#268bd2">itime</span><span style="color:#657b83">)</span></span>
<span class="line"><span style="color:#657b83">  }</span></span>
<span class="line"><span style="color:#657b83">  </span><span style="color:#268bd2">graph_init</span></span>
<span class="line"><span style="color:#657b83">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#268bd2">graph_with_restrictions</span><span style="color:#657b83"> </span><span style="color:#859900">&lt;-</span><span style="color:#657b83"> </span><span style="color:#859900">function</span><span style="color:#657b83">(</span><span style="color:#268bd2">igraph</span><span style="color:#657b83">,</span><span style="color:#268bd2">restriction_percentages</span><span style="color:#657b83">){</span></span>
<span class="line"><span style="color:#657b83">  </span><span style="color:#268bd2">edge_lst</span><span style="color:#657b83"> </span><span style="color:#859900">&lt;-</span><span style="color:#657b83"> as_edgelist(</span><span style="color:#268bd2">igraph</span><span style="color:#657b83">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#657b83">  </span><span style="color:#268bd2">delete_vect</span><span style="color:#657b83"> </span><span style="color:#859900">&lt;-</span><span style="color:#657b83"> </span><span style="color:#268bd2">runif</span><span style="color:#657b83">(</span><span style="color:#268bd2">nrow</span><span style="color:#657b83">(</span><span style="color:#268bd2">edge_lst</span><span style="color:#657b83">))</span></span>
<span class="line"><span style="color:#657b83">  </span><span style="color:#268bd2">vect_bind</span><span style="color:#657b83"> </span><span style="color:#859900">&lt;-</span><span style="color:#657b83"> </span><span style="color:#268bd2">vector</span><span style="color:#657b83">(mode </span><span style="color:#859900">=</span><span style="color:#657b83"> </span><span style="color:#2aa198">"numeric"</span><span style="color:#657b83">,</span><span style="color:#268bd2">nrow</span><span style="color:#657b83">(</span><span style="color:#268bd2">edge_lst</span><span style="color:#657b83">))</span></span>
<span class="line"><span style="color:#657b83">  </span><span style="color:#859900">for</span><span style="color:#657b83">(</span><span style="color:#268bd2">i</span><span style="color:#657b83"> </span><span style="color:#859900">in</span><span style="color:#657b83"> </span><span style="color:#268bd2">nrow</span><span style="color:#657b83">(</span><span style="color:#268bd2">edge_lst</span><span style="color:#657b83">)</span><span style="color:#859900">:</span><span style="color:#d33682">1</span><span style="color:#657b83"> )</span></span>
<span class="line"><span style="color:#657b83">  {</span></span>
<span class="line"><span style="color:#657b83">    </span><span style="color:#859900">if</span><span style="color:#657b83">( </span><span style="color:#268bd2">delete_vect</span><span style="color:#657b83">[</span><span style="color:#268bd2">i</span><span style="color:#657b83">] </span><span style="color:#859900">&gt;</span><span style="color:#657b83"> (</span><span style="color:#268bd2">restriction_percentages</span><span style="color:#859900">/</span><span style="color:#d33682">100</span><span style="color:#657b83">)  )</span></span>
<span class="line"><span style="color:#657b83">    {</span></span>
<span class="line"><span style="color:#657b83">       </span><span style="color:#93a1a1;font-style:italic">#edge_lst[i,3] &lt;- 0</span></span>
<span class="line"><span style="color:#657b83">      </span><span style="color:#268bd2">vect_bind</span><span style="color:#657b83">[</span><span style="color:#268bd2">i</span><span style="color:#657b83">] </span><span style="color:#859900">&lt;-</span><span style="color:#657b83"> </span><span style="color:#d33682">0</span></span>
<span class="line"><span style="color:#657b83">    }</span><span style="color:#859900">else</span><span style="color:#657b83">{</span></span>
<span class="line"><span style="color:#657b83">      </span><span style="color:#268bd2">vect_bind</span><span style="color:#657b83">[</span><span style="color:#268bd2">i</span><span style="color:#657b83">] </span><span style="color:#859900">&lt;-</span><span style="color:#657b83"> </span><span style="color:#d33682">1</span></span>
<span class="line"><span style="color:#657b83">      </span><span style="color:#93a1a1;font-style:italic">#edge_lst[i,3] &lt;- 1</span></span>
<span class="line"><span style="color:#657b83">    }</span></span>
<span class="line"><span style="color:#657b83">  }</span></span>
<span class="line"><span style="color:#657b83">  </span><span style="color:#268bd2">edge_lst</span><span style="color:#657b83"> </span><span style="color:#859900">&lt;-</span><span style="color:#657b83"> </span><span style="color:#268bd2">cbind</span><span style="color:#657b83">(</span><span style="color:#268bd2">edge_lst</span><span style="color:#657b83">,</span><span style="color:#268bd2">vect_bind</span><span style="color:#657b83">)</span></span>
<span class="line"><span style="color:#657b83">  </span><span style="color:#859900">for</span><span style="color:#657b83">(</span><span style="color:#268bd2">i</span><span style="color:#657b83"> </span><span style="color:#859900">in</span><span style="color:#657b83"> </span><span style="color:#268bd2">nrow</span><span style="color:#657b83">(</span><span style="color:#268bd2">edge_lst</span><span style="color:#657b83">)</span><span style="color:#859900">:</span><span style="color:#d33682">1</span><span style="color:#657b83"> )</span></span>
<span class="line"><span style="color:#657b83">  {</span></span>
<span class="line"><span style="color:#657b83">    </span><span style="color:#93a1a1;font-style:italic">#cat("del? \t",i,"\t",edge_lst[i,3])</span></span>
<span class="line"><span style="color:#657b83">    </span><span style="color:#859900">if</span><span style="color:#657b83">(</span><span style="color:#268bd2">edge_lst</span><span style="color:#657b83">[</span><span style="color:#268bd2">i</span><span style="color:#657b83">,</span><span style="color:#d33682">3</span><span style="color:#657b83">] </span><span style="color:#859900">==</span><span style="color:#657b83"> </span><span style="color:#d33682">1</span><span style="color:#657b83">)</span></span>
<span class="line"><span style="color:#657b83">    {</span></span>
<span class="line"><span style="color:#657b83">      </span><span style="color:#93a1a1;font-style:italic">#cat("We sup\n")</span></span>
<span class="line"><span style="color:#657b83">      </span><span style="color:#268bd2">edge_lst</span><span style="color:#657b83"> </span><span style="color:#859900">&lt;-</span><span style="color:#657b83"> </span><span style="color:#268bd2">edge_lst</span><span style="color:#657b83">[</span><span style="color:#859900">-</span><span style="color:#268bd2">i</span><span style="color:#657b83">,]</span></span>
<span class="line"><span style="color:#657b83">    }</span><span style="color:#859900">else</span><span style="color:#657b83">{</span></span>
<span class="line"><span style="color:#657b83">      </span><span style="color:#93a1a1;font-style:italic">#cat("\n")</span></span>
<span class="line"><span style="color:#657b83">    }</span></span>
<span class="line"><span style="color:#657b83">  }</span></span>
<span class="line"><span style="color:#657b83">  </span><span style="color:#268bd2">edge_lst</span><span style="color:#657b83"> </span><span style="color:#859900">&lt;-</span><span style="color:#657b83"> </span><span style="color:#268bd2">edge_lst</span><span style="color:#657b83">[,</span><span style="color:#859900">-</span><span style="color:#d33682">3</span><span style="color:#657b83">]</span></span>
<span class="line"><span style="color:#657b83">  </span><span style="color:#268bd2">limited_graph</span><span style="color:#657b83"> </span><span style="color:#859900">&lt;-</span><span style="color:#657b83"> graph_from_edgelist(</span><span style="color:#268bd2">edge_lst</span><span style="color:#657b83">, directed </span><span style="color:#859900">=</span><span style="color:#657b83"> </span><span style="color:#b58900">FALSE</span><span style="color:#657b83">)</span></span>
<span class="line"><span style="color:#657b83">  </span><span style="color:#268bd2">nb_node</span><span style="color:#657b83"> </span><span style="color:#859900">&lt;-</span><span style="color:#657b83"> vcount(</span><span style="color:#268bd2">igraph</span><span style="color:#657b83">)</span></span>
<span class="line"><span style="color:#657b83">  </span><span style="color:#859900">for</span><span style="color:#657b83">( </span><span style="color:#268bd2">i</span><span style="color:#657b83"> </span><span style="color:#859900">in</span><span style="color:#657b83"> </span><span style="color:#d33682">1</span><span style="color:#859900">:</span><span style="color:#657b83"> </span><span style="color:#268bd2">nb_node</span><span style="color:#657b83">)</span></span>
<span class="line"><span style="color:#657b83">  {</span></span>
<span class="line"><span style="color:#657b83">    </span><span style="color:#268bd2">epi</span><span style="color:#657b83"> </span><span style="color:#859900">&lt;-</span><span style="color:#657b83"> get.vertex.attribute(</span><span style="color:#268bd2">igraph</span><span style="color:#657b83">,</span><span style="color:#2aa198">"epidemic"</span><span style="color:#657b83">, </span><span style="color:#268bd2">i</span><span style="color:#657b83"> )</span></span>
<span class="line"><span style="color:#657b83">    </span><span style="color:#268bd2">itime</span><span style="color:#657b83"> </span><span style="color:#859900">&lt;-</span><span style="color:#657b83"> get.vertex.attribute(</span><span style="color:#268bd2">igraph</span><span style="color:#657b83">,</span><span style="color:#2aa198">"i_time"</span><span style="color:#657b83">, </span><span style="color:#268bd2">i</span><span style="color:#657b83"> )</span></span>
<span class="line"><span style="color:#657b83">    </span><span style="color:#268bd2">limited_graph</span><span style="color:#657b83"> </span><span style="color:#859900">&lt;-</span><span style="color:#657b83"> set.vertex.attribute(</span><span style="color:#268bd2">limited_graph</span><span style="color:#657b83">,</span><span style="color:#2aa198">"epidemic"</span><span style="color:#657b83">, </span><span style="color:#268bd2">i</span><span style="color:#657b83"> ,value</span><span style="color:#859900">=</span><span style="color:#268bd2">epi</span><span style="color:#657b83">)</span></span>
<span class="line"><span style="color:#657b83">    </span><span style="color:#268bd2">limited_graph</span><span style="color:#657b83"> </span><span style="color:#859900">&lt;-</span><span style="color:#657b83"> set.vertex.attribute(</span><span style="color:#268bd2">limited_graph</span><span style="color:#657b83">,</span><span style="color:#2aa198">"i_time"</span><span style="color:#657b83">, </span><span style="color:#268bd2">i</span><span style="color:#657b83"> ,value</span><span style="color:#859900">=</span><span style="color:#268bd2">itime</span><span style="color:#657b83">)</span></span>
<span class="line"><span style="color:#657b83">  }</span></span>
<span class="line"><span style="color:#657b83">  </span><span style="color:#268bd2">limited_graph</span></span>
<span class="line"><span style="color:#657b83">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#268bd2">confine_required</span><span style="color:#657b83"> </span><span style="color:#859900">&lt;-</span><span style="color:#657b83"> </span><span style="color:#859900">function</span><span style="color:#657b83">(</span><span style="color:#268bd2">igraph</span><span style="color:#657b83">,</span><span style="color:#268bd2">confinement_high</span><span style="color:#657b83">,</span><span style="color:#268bd2">confinement_low</span><span style="color:#657b83">,</span><span style="color:#268bd2">restrictions</span><span style="color:#657b83">)</span></span>
<span class="line"><span style="color:#657b83">{</span></span>
<span class="line"><span style="color:#657b83">  </span><span style="color:#268bd2">nb_node</span><span style="color:#657b83"> </span><span style="color:#859900">&lt;-</span><span style="color:#657b83"> vcount(</span><span style="color:#268bd2">igraph</span><span style="color:#657b83">)</span></span>
<span class="line"><span style="color:#657b83">  </span><span style="color:#268bd2">nb_i</span><span style="color:#657b83"> </span><span style="color:#859900">&lt;-</span><span style="color:#657b83"> </span><span style="color:#d33682">0</span></span>
<span class="line"><span style="color:#657b83">  </span><span style="color:#859900">for</span><span style="color:#657b83">(</span><span style="color:#268bd2">i</span><span style="color:#657b83"> </span><span style="color:#859900">in</span><span style="color:#657b83"> </span><span style="color:#d33682">1</span><span style="color:#859900">:</span><span style="color:#268bd2">nb_node</span><span style="color:#657b83">)</span></span>
<span class="line"><span style="color:#657b83">  {</span></span>
<span class="line"><span style="color:#657b83">    </span><span style="color:#268bd2">node_status</span><span style="color:#657b83"> </span><span style="color:#859900">&lt;-</span><span style="color:#657b83"> get.vertex.attribute(</span><span style="color:#268bd2">igraph</span><span style="color:#657b83">,</span><span style="color:#2aa198">"epidemic"</span><span style="color:#657b83">, </span><span style="color:#268bd2">i</span><span style="color:#657b83">)</span></span>
<span class="line"><span style="color:#657b83">    </span><span style="color:#859900">if</span><span style="color:#657b83">( </span><span style="color:#268bd2">node_status</span><span style="color:#657b83"> </span><span style="color:#859900">==</span><span style="color:#657b83"> </span><span style="color:#2aa198">"i"</span><span style="color:#657b83"> )</span></span>
<span class="line"><span style="color:#657b83">    {</span></span>
<span class="line"><span style="color:#657b83">      </span><span style="color:#268bd2">nb_i</span><span style="color:#657b83"> </span><span style="color:#859900">&lt;-</span><span style="color:#657b83"> </span><span style="color:#268bd2">nb_i</span><span style="color:#859900">+</span><span style="color:#d33682">1</span></span>
<span class="line"><span style="color:#657b83">    }</span></span>
<span class="line"><span style="color:#657b83">  }</span></span>
<span class="line"><span style="color:#657b83">  </span><span style="color:#859900">if</span><span style="color:#657b83">(</span><span style="color:#268bd2">restrictions</span><span style="color:#657b83"> </span><span style="color:#859900">==</span><span style="color:#657b83"> </span><span style="color:#b58900">FALSE</span><span style="color:#657b83">)</span></span>
<span class="line"><span style="color:#657b83">  {</span></span>
<span class="line"><span style="color:#657b83">    </span><span style="color:#859900">if</span><span style="color:#657b83">(</span><span style="color:#268bd2">nb_i</span><span style="color:#657b83"> </span><span style="color:#859900">&gt;</span><span style="color:#657b83"> </span><span style="color:#268bd2">confinement_high</span><span style="color:#657b83">)</span></span>
<span class="line"><span style="color:#657b83">    {</span></span>
<span class="line"><span style="color:#657b83">      </span><span style="color:#268bd2">restrictions</span><span style="color:#657b83"> </span><span style="color:#859900">&lt;-</span><span style="color:#657b83"> </span><span style="color:#b58900">TRUE</span></span>
<span class="line"><span style="color:#657b83">    }</span></span>
<span class="line"><span style="color:#657b83">  }</span><span style="color:#859900">else</span><span style="color:#657b83"> </span><span style="color:#859900">if</span><span style="color:#657b83">( </span><span style="color:#268bd2">restrictions</span><span style="color:#657b83"> </span><span style="color:#859900">==</span><span style="color:#657b83"> </span><span style="color:#b58900">TRUE</span><span style="color:#657b83"> )</span></span>
<span class="line"><span style="color:#657b83">  {</span></span>
<span class="line"><span style="color:#657b83">    </span><span style="color:#859900">if</span><span style="color:#657b83">( </span><span style="color:#268bd2">nb_i</span><span style="color:#657b83"> </span><span style="color:#859900">&lt;</span><span style="color:#657b83"> </span><span style="color:#268bd2">confinement_low</span><span style="color:#657b83"> )</span></span>
<span class="line"><span style="color:#657b83">    {</span></span>
<span class="line"><span style="color:#657b83">      </span><span style="color:#268bd2">restrictions</span><span style="color:#657b83"> </span><span style="color:#859900">&lt;-</span><span style="color:#657b83"> </span><span style="color:#b58900">FALSE</span></span>
<span class="line"><span style="color:#657b83">    }</span></span>
<span class="line"><span style="color:#657b83">  }</span></span>
<span class="line"><span style="color:#657b83">  </span><span style="color:#268bd2">restrictions</span></span>
<span class="line"><span style="color:#657b83">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#268bd2">R0_calc</span><span style="color:#657b83"> </span><span style="color:#859900">&lt;-</span><span style="color:#657b83"> </span><span style="color:#859900">function</span><span style="color:#657b83">(</span><span style="color:#268bd2">result_mat</span><span style="color:#657b83">,</span><span style="color:#268bd2">nb_node</span><span style="color:#657b83">, </span><span style="color:#268bd2">n_d</span><span style="color:#657b83">)</span></span>
<span class="line"><span style="color:#657b83">{</span></span>
<span class="line"><span style="color:#657b83">  </span><span style="color:#268bd2">nb_day</span><span style="color:#657b83"> </span><span style="color:#859900">&lt;-</span><span style="color:#657b83"> </span><span style="color:#268bd2">ncol</span><span style="color:#657b83">(</span><span style="color:#268bd2">result_mat</span><span style="color:#657b83">)</span></span>
<span class="line"><span style="color:#657b83">  </span><span style="color:#268bd2">gam</span><span style="color:#657b83"> </span><span style="color:#859900">&lt;-</span><span style="color:#657b83"> </span><span style="color:#d33682">1</span><span style="color:#859900">/</span><span style="color:#268bd2">n_d</span></span>
<span class="line"><span style="color:#657b83">  </span><span style="color:#268bd2">outmat</span><span style="color:#657b83"> </span><span style="color:#859900">&lt;-</span><span style="color:#657b83"> </span><span style="color:#268bd2">matrix</span><span style="color:#657b83">(nrow </span><span style="color:#859900">=</span><span style="color:#657b83"> </span><span style="color:#d33682">6</span><span style="color:#657b83">, ncol </span><span style="color:#859900">=</span><span style="color:#657b83"> </span><span style="color:#268bd2">nb_day</span><span style="color:#657b83">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#657b83">  </span><span style="color:#268bd2">x</span><span style="color:#657b83"> </span><span style="color:#859900">&lt;-</span><span style="color:#657b83"> </span><span style="color:#268bd2">result_mat</span><span style="color:#657b83">[</span><span style="color:#d33682">1</span><span style="color:#657b83">,]</span><span style="color:#859900">/</span><span style="color:#268bd2">nb_node</span></span>
<span class="line"><span style="color:#657b83">  </span><span style="color:#268bd2">s</span><span style="color:#657b83"> </span><span style="color:#859900">&lt;-</span><span style="color:#657b83"> </span><span style="color:#268bd2">result_mat</span><span style="color:#657b83">[</span><span style="color:#d33682">2</span><span style="color:#657b83">,]</span><span style="color:#859900">/</span><span style="color:#268bd2">nb_node</span></span>
<span class="line"><span style="color:#657b83">  </span><span style="color:#268bd2">r</span><span style="color:#657b83"> </span><span style="color:#859900">&lt;-</span><span style="color:#657b83"> </span><span style="color:#268bd2">result_mat</span><span style="color:#657b83">[</span><span style="color:#d33682">3</span><span style="color:#657b83">,]</span><span style="color:#859900">/</span><span style="color:#268bd2">nb_node</span></span>
<span class="line"></span>
<span class="line"><span style="color:#657b83">  </span><span style="color:#268bd2">d_x</span><span style="color:#657b83"> </span><span style="color:#859900">&lt;-</span><span style="color:#657b83"> </span><span style="color:#268bd2">vector</span><span style="color:#657b83">(mode </span><span style="color:#859900">=</span><span style="color:#657b83"> </span><span style="color:#2aa198">"numeric"</span><span style="color:#657b83">,</span><span style="color:#268bd2">nb_day</span><span style="color:#657b83">)</span></span>
<span class="line"><span style="color:#657b83">  </span><span style="color:#268bd2">d_s</span><span style="color:#657b83"> </span><span style="color:#859900">&lt;-</span><span style="color:#657b83"> </span><span style="color:#268bd2">vector</span><span style="color:#657b83">(mode </span><span style="color:#859900">=</span><span style="color:#657b83"> </span><span style="color:#2aa198">"numeric"</span><span style="color:#657b83">,</span><span style="color:#268bd2">nb_day</span><span style="color:#657b83">)</span></span>
<span class="line"><span style="color:#657b83">  </span><span style="color:#268bd2">d_r</span><span style="color:#657b83"> </span><span style="color:#859900">&lt;-</span><span style="color:#657b83"> </span><span style="color:#268bd2">vector</span><span style="color:#657b83">(mode </span><span style="color:#859900">=</span><span style="color:#657b83"> </span><span style="color:#2aa198">"numeric"</span><span style="color:#657b83">,</span><span style="color:#268bd2">nb_day</span><span style="color:#657b83">)</span></span>
<span class="line"><span style="color:#657b83">  </span><span style="color:#268bd2">beta</span><span style="color:#657b83"> </span><span style="color:#859900">&lt;-</span><span style="color:#657b83"> </span><span style="color:#268bd2">vector</span><span style="color:#657b83">(mode </span><span style="color:#859900">=</span><span style="color:#657b83"> </span><span style="color:#2aa198">"numeric"</span><span style="color:#657b83">,</span><span style="color:#268bd2">nb_day</span><span style="color:#657b83">)</span></span>
<span class="line"><span style="color:#657b83">  </span><span style="color:#268bd2">gamma</span><span style="color:#657b83"> </span><span style="color:#859900">&lt;-</span><span style="color:#657b83"> </span><span style="color:#268bd2">vector</span><span style="color:#657b83">(mode </span><span style="color:#859900">=</span><span style="color:#657b83"> </span><span style="color:#2aa198">"numeric"</span><span style="color:#657b83">,</span><span style="color:#268bd2">nb_day</span><span style="color:#657b83">)</span></span>
<span class="line"><span style="color:#657b83">  </span><span style="color:#859900">for</span><span style="color:#657b83">(</span><span style="color:#268bd2">i</span><span style="color:#657b83"> </span><span style="color:#859900">in</span><span style="color:#657b83"> </span><span style="color:#d33682">2</span><span style="color:#859900">:</span><span style="color:#268bd2">nb_day</span><span style="color:#657b83"> )</span></span>
<span class="line"><span style="color:#657b83">  {</span></span>
<span class="line"><span style="color:#657b83">    </span><span style="color:#268bd2">d_x</span><span style="color:#657b83">[</span><span style="color:#268bd2">i</span><span style="color:#657b83">] </span><span style="color:#859900">&lt;-</span><span style="color:#657b83"> </span><span style="color:#268bd2">x</span><span style="color:#657b83">[</span><span style="color:#268bd2">i</span><span style="color:#657b83">] </span><span style="color:#859900">-</span><span style="color:#657b83"> </span><span style="color:#268bd2">x</span><span style="color:#657b83">[</span><span style="color:#268bd2">i</span><span style="color:#859900">-</span><span style="color:#d33682">1</span><span style="color:#657b83">]</span></span>
<span class="line"><span style="color:#657b83">    </span><span style="color:#268bd2">d_s</span><span style="color:#657b83">[</span><span style="color:#268bd2">i</span><span style="color:#657b83">] </span><span style="color:#859900">&lt;-</span><span style="color:#657b83"> </span><span style="color:#268bd2">s</span><span style="color:#657b83">[</span><span style="color:#268bd2">i</span><span style="color:#657b83">] </span><span style="color:#859900">-</span><span style="color:#657b83"> </span><span style="color:#268bd2">s</span><span style="color:#657b83">[</span><span style="color:#268bd2">i</span><span style="color:#859900">-</span><span style="color:#d33682">1</span><span style="color:#657b83">]</span></span>
<span class="line"><span style="color:#657b83">    </span><span style="color:#268bd2">d_r</span><span style="color:#657b83">[</span><span style="color:#268bd2">i</span><span style="color:#657b83">] </span><span style="color:#859900">&lt;-</span><span style="color:#657b83"> </span><span style="color:#268bd2">r</span><span style="color:#657b83">[</span><span style="color:#268bd2">i</span><span style="color:#657b83">] </span><span style="color:#859900">-</span><span style="color:#657b83"> </span><span style="color:#268bd2">r</span><span style="color:#657b83">[</span><span style="color:#268bd2">i</span><span style="color:#859900">-</span><span style="color:#d33682">1</span><span style="color:#657b83">]</span></span>
<span class="line"><span style="color:#657b83">  }</span></span>
<span class="line"><span style="color:#657b83">  </span><span style="color:#859900">for</span><span style="color:#657b83">(</span><span style="color:#268bd2">i</span><span style="color:#657b83"> </span><span style="color:#859900">in</span><span style="color:#657b83"> </span><span style="color:#d33682">2</span><span style="color:#859900">:</span><span style="color:#268bd2">nb_day</span><span style="color:#657b83"> )</span></span>
<span class="line"><span style="color:#657b83">  {</span></span>
<span class="line"><span style="color:#657b83">    </span><span style="color:#268bd2">beta</span><span style="color:#657b83">[</span><span style="color:#268bd2">i</span><span style="color:#657b83">] </span><span style="color:#859900">&lt;-</span><span style="color:#657b83"> </span><span style="color:#268bd2">d_s</span><span style="color:#657b83">[</span><span style="color:#268bd2">i</span><span style="color:#657b83">]</span><span style="color:#859900">/</span><span style="color:#657b83">(</span><span style="color:#268bd2">s</span><span style="color:#657b83">[</span><span style="color:#268bd2">i</span><span style="color:#657b83">]</span><span style="color:#859900">*</span><span style="color:#268bd2">x</span><span style="color:#657b83">[</span><span style="color:#268bd2">i</span><span style="color:#657b83">])</span></span>
<span class="line"><span style="color:#657b83">  }</span></span>
<span class="line"><span style="color:#657b83">  </span><span style="color:#268bd2">print</span><span style="color:#657b83">(</span><span style="color:#268bd2">beta</span><span style="color:#859900">/</span><span style="color:#d33682">0.1</span><span style="color:#657b83">)</span></span>
<span class="line"><span style="color:#657b83">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#268bd2">n</span><span style="color:#657b83"> </span><span style="color:#859900">&lt;-</span><span style="color:#657b83"> </span><span style="color:#d33682">2000</span></span>
<span class="line"><span style="color:#268bd2">p</span><span style="color:#657b83"> </span><span style="color:#859900">&lt;-</span><span style="color:#657b83"> </span><span style="color:#d33682">0.01</span></span>
<span class="line"></span>
<span class="line"><span style="color:#268bd2">p_epidemic</span><span style="color:#657b83"> </span><span style="color:#859900">&lt;-</span><span style="color:#657b83"> </span><span style="color:#d33682">0.01</span></span>
<span class="line"><span style="color:#268bd2">time</span><span style="color:#657b83"> </span><span style="color:#859900">&lt;-</span><span style="color:#657b83"> </span><span style="color:#d33682">70</span></span>
<span class="line"></span>
<span class="line"><span style="color:#268bd2">n_0</span><span style="color:#657b83"> </span><span style="color:#859900">&lt;-</span><span style="color:#657b83"> </span><span style="color:#d33682">10</span></span>
<span class="line"><span style="color:#268bd2">n_d</span><span style="color:#657b83"> </span><span style="color:#859900">&lt;-</span><span style="color:#657b83"> </span><span style="color:#d33682">10</span></span>
<span class="line"></span>
<span class="line"><span style="color:#268bd2">travel_limitation</span><span style="color:#657b83"> </span><span style="color:#859900">&lt;-</span><span style="color:#657b83"> </span><span style="color:#b58900">FALSE</span></span>
<span class="line"><span style="color:#268bd2">confinement_high</span><span style="color:#657b83"> </span><span style="color:#859900">&lt;-</span><span style="color:#657b83"> </span><span style="color:#d33682">50</span></span>
<span class="line"><span style="color:#268bd2">confinement_low</span><span style="color:#657b83"> </span><span style="color:#859900">&lt;-</span><span style="color:#657b83"> </span><span style="color:#d33682">10</span></span>
<span class="line"><span style="color:#268bd2">restriction_percentages</span><span style="color:#657b83"> </span><span style="color:#859900">&lt;-</span><span style="color:#657b83"> </span><span style="color:#d33682">80</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#268bd2">ig</span><span style="color:#657b83"> </span><span style="color:#859900">&lt;-</span><span style="color:#657b83"> Erdos_Renyi_optimized(</span><span style="color:#268bd2">n</span><span style="color:#657b83">,</span><span style="color:#268bd2">p</span><span style="color:#657b83">)</span></span>
<span class="line"><span style="color:#268bd2">cat</span><span style="color:#657b83">(</span><span style="color:#2aa198">"Erdos Renyi created</span><span style="color:#cb4b16">\n</span><span style="color:#2aa198">"</span><span style="color:#657b83">)</span></span>
<span class="line"><span style="color:#268bd2">ig</span><span style="color:#657b83"> </span><span style="color:#859900">&lt;-</span><span style="color:#657b83"> init_epidemic(</span><span style="color:#268bd2">ig</span><span style="color:#657b83">,</span><span style="color:#268bd2">n_0</span><span style="color:#657b83">,</span><span style="color:#268bd2">n_d</span><span style="color:#657b83">)</span></span>
<span class="line"><span style="color:#93a1a1;font-style:italic">#epidemic_plot(ig,"Day One")</span></span>
<span class="line"><span style="color:#268bd2">cat</span><span style="color:#657b83">(</span><span style="color:#2aa198">"Infection initialized </span><span style="color:#cb4b16">\n</span><span style="color:#2aa198">"</span><span style="color:#657b83">)</span></span>
<span class="line"><span style="color:#268bd2">res</span><span style="color:#657b83"> </span><span style="color:#859900">&lt;-</span><span style="color:#657b83"> simulation(</span><span style="color:#268bd2">ig</span><span style="color:#657b83">,</span><span style="color:#268bd2">p_epidemic</span><span style="color:#657b83">,</span><span style="color:#268bd2">n_d</span><span style="color:#657b83">,</span><span style="color:#268bd2">time</span><span style="color:#657b83">,</span><span style="color:#268bd2">confinement_high</span><span style="color:#657b83">,</span><span style="color:#268bd2">confinement_low</span><span style="color:#657b83">,</span><span style="color:#268bd2">restriction_percentages</span><span style="color:#657b83">,</span><span style="color:#268bd2">travel_limitation</span><span style="color:#657b83">)</span></span>
<span class="line"><span style="color:#657b83">plot_epidemic_curves(</span><span style="color:#d33682">100</span><span style="color:#859900">*</span><span style="color:#268bd2">res</span><span style="color:#859900">/</span><span style="color:#268bd2">n</span><span style="color:#657b83">,</span><span style="color:#268bd2">time</span><span style="color:#657b83">)</span></span>
<span class="line"></span></code></pre></div></code></pre><p>Here is the output of this simulation :</p><p><img src="/assets/tpfourqto.012f76c3.png" alt=""></p><p>Notice that this output is similar to the model represented by the follwing equations:</p><section><eqn><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mo fence="true">{</mo><mtable rowspacing="0.16em" columnalign="left left left" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><msup><mi>S</mi><mo mathvariant="normal" lspace="0em" rspace="0em"></mo></msup><mo stretchy="false">(</mo><mi>t</mi><mo stretchy="false">)</mo><mo>=</mo><mo></mo><mi></mi><mi>S</mi><mo stretchy="false">(</mo><mi>t</mi><mo stretchy="false">)</mo><mi>I</mi><mo stretchy="false">(</mo><mi>t</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><msup><mi>I</mi><mo mathvariant="normal" lspace="0em" rspace="0em"></mo></msup><mo stretchy="false">(</mo><mi>t</mi><mo stretchy="false">)</mo><mo>=</mo><mi></mi><mi>S</mi><mo stretchy="false">(</mo><mi>t</mi><mo stretchy="false">)</mo><mi>I</mi><mo stretchy="false">(</mo><mi>t</mi><mo stretchy="false">)</mo><mo></mo><mi></mi><mi>I</mi><mo stretchy="false">(</mo><mi>t</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><msup><mi>R</mi><mo mathvariant="normal" lspace="0em" rspace="0em"></mo></msup><mo stretchy="false">(</mo><mi>t</mi><mo stretchy="false">)</mo><mo>=</mo><mi></mi><mi>I</mi><mo stretchy="false">(</mo><mi>t</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr></mtable></mrow><annotation encoding="application/x-tex">\left\{ \begin{array}{lll} S'(t) = -\beta S(t) I(t) \\ I'(t) = \beta S(t) I(t) - \gamma I(t) \\ R'(t) = \gamma I(t) \end{array} \right.</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:3.6em;vertical-align:-1.55em"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.05em"><span style="top:-2.5em"><span class="pstrut" style="height:3.15em"></span><span class="delimsizinginner delim-size4"><span></span></span></span><span style="top:-2.492em"><span class="pstrut" style="height:3.15em"></span><span style="height:.016em;width:.8889em"><svg xmlns="http://www.w3.org/2000/svg" width="0.8889em" height="0.016em" style="width:.8889em" viewBox="0 0 888.89 16" preserveAspectRatio="xMinYMin"><path d="M384 0 H504 V16 H384z M384 0 H504 V16 H384z"></path></svg></span></span><span style="top:-3.15em"><span class="pstrut" style="height:3.15em"></span><span class="delimsizinginner delim-size4"><span></span></span></span><span style="top:-4.292em"><span class="pstrut" style="height:3.15em"></span><span style="height:.016em;width:.8889em"><svg xmlns="http://www.w3.org/2000/svg" width="0.8889em" height="0.016em" style="width:.8889em" viewBox="0 0 888.89 16" preserveAspectRatio="xMinYMin"><path d="M384 0 H504 V16 H384z M384 0 H504 V16 H384z"></path></svg></span></span><span style="top:-4.3em"><span class="pstrut" style="height:3.15em"></span><span class="delimsizinginner delim-size4"><span></span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:1.55em"><span></span></span></span></span></span></span><span class="mord"><span class="mtable"><span class="arraycolsep" style="width:.5em"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.05em"><span style="top:-4.21em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:.05764em">S</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.7519em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"></span></span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">t</span><span class="mclose">)</span><span class="mspace" style="margin-right:.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2778em"></span><span class="mord"></span><span class="mord mathnormal" style="margin-right:.05764em">S</span><span class="mopen">(</span><span class="mord mathnormal">t</span><span class="mclose">)</span><span class="mord mathnormal" style="margin-right:.07847em">I</span><span class="mopen">(</span><span class="mord mathnormal">t</span><span class="mclose">)</span></span></span><span style="top:-3.01em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:.07847em">I</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.7519em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"></span></span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">t</span><span class="mclose">)</span><span class="mspace" style="margin-right:.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2778em"></span><span class="mord mathnormal" style="margin-right:.05764em">S</span><span class="mopen">(</span><span class="mord mathnormal">t</span><span class="mclose">)</span><span class="mord mathnormal" style="margin-right:.07847em">I</span><span class="mopen">(</span><span class="mord mathnormal">t</span><span class="mclose">)</span><span class="mspace" style="margin-right:.2222em"></span><span class="mbin"></span><span class="mspace" style="margin-right:.2222em"></span><span class="mord mathnormal" style="margin-right:.05556em"></span><span class="mord mathnormal" style="margin-right:.07847em">I</span><span class="mopen">(</span><span class="mord mathnormal">t</span><span class="mclose">)</span></span></span><span style="top:-1.81em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:.00773em">R</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.7519em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"></span></span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">t</span><span class="mclose">)</span><span class="mspace" style="margin-right:.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2778em"></span><span class="mord mathnormal" style="margin-right:.05556em"></span><span class="mord mathnormal" style="margin-right:.07847em">I</span><span class="mopen">(</span><span class="mord mathnormal">t</span><span class="mclose">)</span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:1.55em"><span></span></span></span></span></span><span class="arraycolsep" style="width:.5em"></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></eqn></section><p>To solve this model, we have used the following code inspired by : <a href="http://rstudio-pubs-static.s3.amazonaws.com/6852_c59c5a2e8ea3456abbeb017185de603e.html" target="_blank" rel="noopener">http://rstudio-pubs-static.s3.amazonaws.com/6852_c59c5a2e8ea3456abbeb017185de603e.html</a></p><pre><code class="language-r"><div class="shiki-container"><pre class="shiki shiki-dark" style="background-color:#002b36"><code v-pre=""><span class="line"><span style="color:#586e75;font-style:italic">## Load deSolve package</span></span>
<span class="line"><span style="color:#268bd2">library</span><span style="color:#839496">(</span><span style="color:#268bd2">deSolve</span><span style="color:#839496">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#586e75;font-style:italic">## Create an SIR function</span></span>
<span class="line"><span style="color:#268bd2">sir</span><span style="color:#839496"> </span><span style="color:#859900">&lt;-</span><span style="color:#839496"> </span><span style="color:#859900">function</span><span style="color:#839496">(</span><span style="color:#268bd2">time</span><span style="color:#839496">, </span><span style="color:#268bd2">state</span><span style="color:#839496">, </span><span style="color:#268bd2">parameters</span><span style="color:#839496">) {</span></span>
<span class="line"></span>
<span class="line"><span style="color:#839496">  </span><span style="color:#268bd2">with</span><span style="color:#839496">(</span><span style="color:#268bd2">as.list</span><span style="color:#839496">(</span><span style="color:#268bd2">c</span><span style="color:#839496">(</span><span style="color:#268bd2">state</span><span style="color:#839496">, </span><span style="color:#268bd2">parameters</span><span style="color:#839496">)), {</span></span>
<span class="line"></span>
<span class="line"><span style="color:#839496">    </span><span style="color:#268bd2">dS</span><span style="color:#839496"> </span><span style="color:#859900">&lt;-</span><span style="color:#839496"> </span><span style="color:#859900">-</span><span style="color:#268bd2">beta</span><span style="color:#839496"> </span><span style="color:#859900">*</span><span style="color:#839496"> </span><span style="color:#268bd2">S</span><span style="color:#839496"> </span><span style="color:#859900">*</span><span style="color:#839496"> </span><span style="color:#268bd2">I</span></span>
<span class="line"><span style="color:#839496">    </span><span style="color:#268bd2">dI</span><span style="color:#839496"> </span><span style="color:#859900">&lt;-</span><span style="color:#839496">  </span><span style="color:#268bd2">beta</span><span style="color:#839496"> </span><span style="color:#859900">*</span><span style="color:#839496"> </span><span style="color:#268bd2">S</span><span style="color:#839496"> </span><span style="color:#859900">*</span><span style="color:#839496"> </span><span style="color:#268bd2">I</span><span style="color:#839496"> </span><span style="color:#859900">-</span><span style="color:#839496"> </span><span style="color:#268bd2">gamma</span><span style="color:#839496"> </span><span style="color:#859900">*</span><span style="color:#839496"> </span><span style="color:#268bd2">I</span></span>
<span class="line"><span style="color:#839496">    </span><span style="color:#268bd2">dR</span><span style="color:#839496"> </span><span style="color:#859900">&lt;-</span><span style="color:#839496">                 </span><span style="color:#268bd2">gamma</span><span style="color:#839496"> </span><span style="color:#859900">*</span><span style="color:#839496"> </span><span style="color:#268bd2">I</span></span>
<span class="line"></span>
<span class="line"><span style="color:#839496">    </span><span style="color:#859900">return</span><span style="color:#839496">(</span><span style="color:#93a1a1;font-weight:700">list</span><span style="color:#839496">(</span><span style="color:#268bd2">c</span><span style="color:#839496">(</span><span style="color:#268bd2">dS</span><span style="color:#839496">, </span><span style="color:#268bd2">dI</span><span style="color:#839496">, </span><span style="color:#268bd2">dR</span><span style="color:#839496">)))</span></span>
<span class="line"><span style="color:#839496">  })</span></span>
<span class="line"><span style="color:#839496">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#268bd2">n</span><span style="color:#839496"> </span><span style="color:#859900">&lt;-</span><span style="color:#839496"> </span><span style="color:#d33682">2000</span></span>
<span class="line"><span style="color:#268bd2">n_0</span><span style="color:#839496"> </span><span style="color:#859900">&lt;-</span><span style="color:#839496"> </span><span style="color:#d33682">10</span></span>
<span class="line"></span>
<span class="line"><span style="color:#586e75;font-style:italic">### Set parameters</span></span>
<span class="line"><span style="color:#586e75;font-style:italic">## Proportion in each compartment:</span></span>
<span class="line"><span style="color:#268bd2">init</span><span style="color:#839496">       </span><span style="color:#859900">&lt;-</span><span style="color:#839496"> </span><span style="color:#268bd2">c</span><span style="color:#839496">(S </span><span style="color:#859900">=</span><span style="color:#839496"> (</span><span style="color:#268bd2">n</span><span style="color:#859900">-</span><span style="color:#268bd2">n_0</span><span style="color:#839496">)</span><span style="color:#859900">/</span><span style="color:#268bd2">n</span><span style="color:#839496">, I </span><span style="color:#859900">=</span><span style="color:#839496"> </span><span style="color:#268bd2">n_0</span><span style="color:#859900">/</span><span style="color:#268bd2">n</span><span style="color:#839496">, R </span><span style="color:#859900">=</span><span style="color:#839496"> </span><span style="color:#d33682">0.0</span><span style="color:#839496">)</span></span>
<span class="line"><span style="color:#586e75;font-style:italic">## beta: infection parameter; gamma: recovery parameter</span></span>
<span class="line"><span style="color:#268bd2">parameters</span><span style="color:#839496"> </span><span style="color:#859900">&lt;-</span><span style="color:#839496"> </span><span style="color:#268bd2">c</span><span style="color:#839496">(beta </span><span style="color:#859900">=</span><span style="color:#839496"> </span><span style="color:#d33682">0.5</span><span style="color:#839496">, gamma </span><span style="color:#859900">=</span><span style="color:#839496"> </span><span style="color:#d33682">0.11</span><span style="color:#839496">)</span></span>
<span class="line"><span style="color:#586e75;font-style:italic">## Time frame</span></span>
<span class="line"><span style="color:#268bd2">times</span><span style="color:#839496">      </span><span style="color:#859900">&lt;-</span><span style="color:#839496"> </span><span style="color:#268bd2">seq</span><span style="color:#839496">(</span><span style="color:#d33682">0</span><span style="color:#839496">, </span><span style="color:#d33682">70</span><span style="color:#839496">, by </span><span style="color:#859900">=</span><span style="color:#839496"> </span><span style="color:#d33682">1</span><span style="color:#839496">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#586e75;font-style:italic">## Solve using ode (General Solver for Ordinary Differential Equations)</span></span>
<span class="line"><span style="color:#268bd2">out</span><span style="color:#839496"> </span><span style="color:#859900">&lt;-</span><span style="color:#839496"> ode(y </span><span style="color:#859900">=</span><span style="color:#839496"> </span><span style="color:#268bd2">init</span><span style="color:#839496">, times </span><span style="color:#859900">=</span><span style="color:#839496"> </span><span style="color:#268bd2">times</span><span style="color:#839496">, func </span><span style="color:#859900">=</span><span style="color:#839496"> </span><span style="color:#268bd2">sir</span><span style="color:#839496">, parms </span><span style="color:#859900">=</span><span style="color:#839496"> </span><span style="color:#268bd2">parameters</span><span style="color:#839496">)</span></span>
<span class="line"><span style="color:#586e75;font-style:italic">## change to data frame</span></span>
<span class="line"><span style="color:#268bd2">out</span><span style="color:#839496"> </span><span style="color:#859900">&lt;-</span><span style="color:#839496"> </span><span style="color:#268bd2">as.data.frame</span><span style="color:#839496">(</span><span style="color:#268bd2">out</span><span style="color:#839496">)</span></span>
<span class="line"><span style="color:#586e75;font-style:italic">## Delete time variable</span></span>
<span class="line"><span style="color:#268bd2">out</span><span style="color:#859900">$</span><span style="color:#268bd2">time</span><span style="color:#839496"> </span><span style="color:#859900">&lt;-</span><span style="color:#839496"> </span><span style="color:#b58900">NULL</span></span>
<span class="line"><span style="color:#586e75;font-style:italic">## Show data</span></span>
<span class="line"><span style="color:#268bd2">head</span><span style="color:#839496">(</span><span style="color:#268bd2">out</span><span style="color:#839496">, </span><span style="color:#d33682">10</span><span style="color:#839496">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#586e75;font-style:italic">## Plot</span></span>
<span class="line"><span style="color:#268bd2">matplot</span><span style="color:#839496">(x </span><span style="color:#859900">=</span><span style="color:#839496"> </span><span style="color:#268bd2">times</span><span style="color:#839496">, y </span><span style="color:#859900">=</span><span style="color:#839496"> </span><span style="color:#268bd2">out</span><span style="color:#839496">, type </span><span style="color:#859900">=</span><span style="color:#839496"> </span><span style="color:#2aa198">"l"</span><span style="color:#839496">,</span></span>
<span class="line"><span style="color:#839496">        xlab </span><span style="color:#859900">=</span><span style="color:#839496"> </span><span style="color:#2aa198">"Time"</span><span style="color:#839496">, ylab </span><span style="color:#859900">=</span><span style="color:#839496"> </span><span style="color:#2aa198">"Susceptible and Recovered"</span><span style="color:#839496">, main </span><span style="color:#859900">=</span><span style="color:#839496"> </span><span style="color:#2aa198">"SIR Model"</span><span style="color:#839496">,</span></span>
<span class="line"><span style="color:#839496">        lwd </span><span style="color:#859900">=</span><span style="color:#839496"> </span><span style="color:#d33682">1</span><span style="color:#839496">, lty </span><span style="color:#859900">=</span><span style="color:#839496"> </span><span style="color:#d33682">1</span><span style="color:#839496">, bty </span><span style="color:#859900">=</span><span style="color:#839496"> </span><span style="color:#2aa198">"l"</span><span style="color:#839496">, col </span><span style="color:#859900">=</span><span style="color:#839496"> </span><span style="color:#d33682">2</span><span style="color:#859900">:</span><span style="color:#d33682">4</span><span style="color:#839496">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#586e75;font-style:italic">## Add legend</span></span>
<span class="line"><span style="color:#268bd2">legend</span><span style="color:#839496">(</span><span style="color:#d33682">40</span><span style="color:#839496">, </span><span style="color:#d33682">0.7</span><span style="color:#839496">, </span><span style="color:#268bd2">c</span><span style="color:#839496">(</span><span style="color:#2aa198">"Susceptible"</span><span style="color:#839496">, </span><span style="color:#2aa198">"Infected"</span><span style="color:#839496">, </span><span style="color:#2aa198">"Recovered"</span><span style="color:#839496">), pch </span><span style="color:#859900">=</span><span style="color:#839496"> </span><span style="color:#d33682">1</span><span style="color:#839496">, col </span><span style="color:#859900">=</span><span style="color:#839496"> </span><span style="color:#d33682">2</span><span style="color:#859900">:</span><span style="color:#d33682">4</span><span style="color:#839496">, bty </span><span style="color:#859900">=</span><span style="color:#839496"> </span><span style="color:#2aa198">"n"</span><span style="color:#839496">)</span></span>
<span class="line"></span></code></pre><pre class="shiki shiki-light" style="background-color:#fdf6e3"><code v-pre=""><span class="line"><span style="color:#93a1a1;font-style:italic">## Load deSolve package</span></span>
<span class="line"><span style="color:#268bd2">library</span><span style="color:#657b83">(</span><span style="color:#268bd2">deSolve</span><span style="color:#657b83">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#93a1a1;font-style:italic">## Create an SIR function</span></span>
<span class="line"><span style="color:#268bd2">sir</span><span style="color:#657b83"> </span><span style="color:#859900">&lt;-</span><span style="color:#657b83"> </span><span style="color:#859900">function</span><span style="color:#657b83">(</span><span style="color:#268bd2">time</span><span style="color:#657b83">, </span><span style="color:#268bd2">state</span><span style="color:#657b83">, </span><span style="color:#268bd2">parameters</span><span style="color:#657b83">) {</span></span>
<span class="line"></span>
<span class="line"><span style="color:#657b83">  </span><span style="color:#268bd2">with</span><span style="color:#657b83">(</span><span style="color:#268bd2">as.list</span><span style="color:#657b83">(</span><span style="color:#268bd2">c</span><span style="color:#657b83">(</span><span style="color:#268bd2">state</span><span style="color:#657b83">, </span><span style="color:#268bd2">parameters</span><span style="color:#657b83">)), {</span></span>
<span class="line"></span>
<span class="line"><span style="color:#657b83">    </span><span style="color:#268bd2">dS</span><span style="color:#657b83"> </span><span style="color:#859900">&lt;-</span><span style="color:#657b83"> </span><span style="color:#859900">-</span><span style="color:#268bd2">beta</span><span style="color:#657b83"> </span><span style="color:#859900">*</span><span style="color:#657b83"> </span><span style="color:#268bd2">S</span><span style="color:#657b83"> </span><span style="color:#859900">*</span><span style="color:#657b83"> </span><span style="color:#268bd2">I</span></span>
<span class="line"><span style="color:#657b83">    </span><span style="color:#268bd2">dI</span><span style="color:#657b83"> </span><span style="color:#859900">&lt;-</span><span style="color:#657b83">  </span><span style="color:#268bd2">beta</span><span style="color:#657b83"> </span><span style="color:#859900">*</span><span style="color:#657b83"> </span><span style="color:#268bd2">S</span><span style="color:#657b83"> </span><span style="color:#859900">*</span><span style="color:#657b83"> </span><span style="color:#268bd2">I</span><span style="color:#657b83"> </span><span style="color:#859900">-</span><span style="color:#657b83"> </span><span style="color:#268bd2">gamma</span><span style="color:#657b83"> </span><span style="color:#859900">*</span><span style="color:#657b83"> </span><span style="color:#268bd2">I</span></span>
<span class="line"><span style="color:#657b83">    </span><span style="color:#268bd2">dR</span><span style="color:#657b83"> </span><span style="color:#859900">&lt;-</span><span style="color:#657b83">                 </span><span style="color:#268bd2">gamma</span><span style="color:#657b83"> </span><span style="color:#859900">*</span><span style="color:#657b83"> </span><span style="color:#268bd2">I</span></span>
<span class="line"></span>
<span class="line"><span style="color:#657b83">    </span><span style="color:#859900">return</span><span style="color:#657b83">(</span><span style="color:#586e75;font-weight:700">list</span><span style="color:#657b83">(</span><span style="color:#268bd2">c</span><span style="color:#657b83">(</span><span style="color:#268bd2">dS</span><span style="color:#657b83">, </span><span style="color:#268bd2">dI</span><span style="color:#657b83">, </span><span style="color:#268bd2">dR</span><span style="color:#657b83">)))</span></span>
<span class="line"><span style="color:#657b83">  })</span></span>
<span class="line"><span style="color:#657b83">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#268bd2">n</span><span style="color:#657b83"> </span><span style="color:#859900">&lt;-</span><span style="color:#657b83"> </span><span style="color:#d33682">2000</span></span>
<span class="line"><span style="color:#268bd2">n_0</span><span style="color:#657b83"> </span><span style="color:#859900">&lt;-</span><span style="color:#657b83"> </span><span style="color:#d33682">10</span></span>
<span class="line"></span>
<span class="line"><span style="color:#93a1a1;font-style:italic">### Set parameters</span></span>
<span class="line"><span style="color:#93a1a1;font-style:italic">## Proportion in each compartment:</span></span>
<span class="line"><span style="color:#268bd2">init</span><span style="color:#657b83">       </span><span style="color:#859900">&lt;-</span><span style="color:#657b83"> </span><span style="color:#268bd2">c</span><span style="color:#657b83">(S </span><span style="color:#859900">=</span><span style="color:#657b83"> (</span><span style="color:#268bd2">n</span><span style="color:#859900">-</span><span style="color:#268bd2">n_0</span><span style="color:#657b83">)</span><span style="color:#859900">/</span><span style="color:#268bd2">n</span><span style="color:#657b83">, I </span><span style="color:#859900">=</span><span style="color:#657b83"> </span><span style="color:#268bd2">n_0</span><span style="color:#859900">/</span><span style="color:#268bd2">n</span><span style="color:#657b83">, R </span><span style="color:#859900">=</span><span style="color:#657b83"> </span><span style="color:#d33682">0.0</span><span style="color:#657b83">)</span></span>
<span class="line"><span style="color:#93a1a1;font-style:italic">## beta: infection parameter; gamma: recovery parameter</span></span>
<span class="line"><span style="color:#268bd2">parameters</span><span style="color:#657b83"> </span><span style="color:#859900">&lt;-</span><span style="color:#657b83"> </span><span style="color:#268bd2">c</span><span style="color:#657b83">(beta </span><span style="color:#859900">=</span><span style="color:#657b83"> </span><span style="color:#d33682">0.5</span><span style="color:#657b83">, gamma </span><span style="color:#859900">=</span><span style="color:#657b83"> </span><span style="color:#d33682">0.11</span><span style="color:#657b83">)</span></span>
<span class="line"><span style="color:#93a1a1;font-style:italic">## Time frame</span></span>
<span class="line"><span style="color:#268bd2">times</span><span style="color:#657b83">      </span><span style="color:#859900">&lt;-</span><span style="color:#657b83"> </span><span style="color:#268bd2">seq</span><span style="color:#657b83">(</span><span style="color:#d33682">0</span><span style="color:#657b83">, </span><span style="color:#d33682">70</span><span style="color:#657b83">, by </span><span style="color:#859900">=</span><span style="color:#657b83"> </span><span style="color:#d33682">1</span><span style="color:#657b83">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#93a1a1;font-style:italic">## Solve using ode (General Solver for Ordinary Differential Equations)</span></span>
<span class="line"><span style="color:#268bd2">out</span><span style="color:#657b83"> </span><span style="color:#859900">&lt;-</span><span style="color:#657b83"> ode(y </span><span style="color:#859900">=</span><span style="color:#657b83"> </span><span style="color:#268bd2">init</span><span style="color:#657b83">, times </span><span style="color:#859900">=</span><span style="color:#657b83"> </span><span style="color:#268bd2">times</span><span style="color:#657b83">, func </span><span style="color:#859900">=</span><span style="color:#657b83"> </span><span style="color:#268bd2">sir</span><span style="color:#657b83">, parms </span><span style="color:#859900">=</span><span style="color:#657b83"> </span><span style="color:#268bd2">parameters</span><span style="color:#657b83">)</span></span>
<span class="line"><span style="color:#93a1a1;font-style:italic">## change to data frame</span></span>
<span class="line"><span style="color:#268bd2">out</span><span style="color:#657b83"> </span><span style="color:#859900">&lt;-</span><span style="color:#657b83"> </span><span style="color:#268bd2">as.data.frame</span><span style="color:#657b83">(</span><span style="color:#268bd2">out</span><span style="color:#657b83">)</span></span>
<span class="line"><span style="color:#93a1a1;font-style:italic">## Delete time variable</span></span>
<span class="line"><span style="color:#268bd2">out</span><span style="color:#859900">$</span><span style="color:#268bd2">time</span><span style="color:#657b83"> </span><span style="color:#859900">&lt;-</span><span style="color:#657b83"> </span><span style="color:#b58900">NULL</span></span>
<span class="line"><span style="color:#93a1a1;font-style:italic">## Show data</span></span>
<span class="line"><span style="color:#268bd2">head</span><span style="color:#657b83">(</span><span style="color:#268bd2">out</span><span style="color:#657b83">, </span><span style="color:#d33682">10</span><span style="color:#657b83">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#93a1a1;font-style:italic">## Plot</span></span>
<span class="line"><span style="color:#268bd2">matplot</span><span style="color:#657b83">(x </span><span style="color:#859900">=</span><span style="color:#657b83"> </span><span style="color:#268bd2">times</span><span style="color:#657b83">, y </span><span style="color:#859900">=</span><span style="color:#657b83"> </span><span style="color:#268bd2">out</span><span style="color:#657b83">, type </span><span style="color:#859900">=</span><span style="color:#657b83"> </span><span style="color:#2aa198">"l"</span><span style="color:#657b83">,</span></span>
<span class="line"><span style="color:#657b83">        xlab </span><span style="color:#859900">=</span><span style="color:#657b83"> </span><span style="color:#2aa198">"Time"</span><span style="color:#657b83">, ylab </span><span style="color:#859900">=</span><span style="color:#657b83"> </span><span style="color:#2aa198">"Susceptible and Recovered"</span><span style="color:#657b83">, main </span><span style="color:#859900">=</span><span style="color:#657b83"> </span><span style="color:#2aa198">"SIR Model"</span><span style="color:#657b83">,</span></span>
<span class="line"><span style="color:#657b83">        lwd </span><span style="color:#859900">=</span><span style="color:#657b83"> </span><span style="color:#d33682">1</span><span style="color:#657b83">, lty </span><span style="color:#859900">=</span><span style="color:#657b83"> </span><span style="color:#d33682">1</span><span style="color:#657b83">, bty </span><span style="color:#859900">=</span><span style="color:#657b83"> </span><span style="color:#2aa198">"l"</span><span style="color:#657b83">, col </span><span style="color:#859900">=</span><span style="color:#657b83"> </span><span style="color:#d33682">2</span><span style="color:#859900">:</span><span style="color:#d33682">4</span><span style="color:#657b83">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#93a1a1;font-style:italic">## Add legend</span></span>
<span class="line"><span style="color:#268bd2">legend</span><span style="color:#657b83">(</span><span style="color:#d33682">40</span><span style="color:#657b83">, </span><span style="color:#d33682">0.7</span><span style="color:#657b83">, </span><span style="color:#268bd2">c</span><span style="color:#657b83">(</span><span style="color:#2aa198">"Susceptible"</span><span style="color:#657b83">, </span><span style="color:#2aa198">"Infected"</span><span style="color:#657b83">, </span><span style="color:#2aa198">"Recovered"</span><span style="color:#657b83">), pch </span><span style="color:#859900">=</span><span style="color:#657b83"> </span><span style="color:#d33682">1</span><span style="color:#657b83">, col </span><span style="color:#859900">=</span><span style="color:#657b83"> </span><span style="color:#d33682">2</span><span style="color:#859900">:</span><span style="color:#d33682">4</span><span style="color:#657b83">, bty </span><span style="color:#859900">=</span><span style="color:#657b83"> </span><span style="color:#2aa198">"n"</span><span style="color:#657b83">)</span></span>
<span class="line"></span></code></pre></div></code></pre><p><img src="/assets/solver.777bfa71.png" alt=""></p><p>Notice the general behaving is similar.</p><p>Then we can adjust beta and gamma to be closer of our simulation.</p><p>When your are satisfied with your<eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi></mi></mrow><annotation encoding="application/x-tex">\beta</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.8889em;vertical-align:-.1944em"></span><span class="mord mathnormal" style="margin-right:.05278em"></span></span></span></span></eq>and<eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi></mi></mrow><annotation encoding="application/x-tex">\gamma</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.625em;vertical-align:-.1944em"></span><span class="mord mathnormal" style="margin-right:.05556em"></span></span></span></span></eq>estimation you can estimated<eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>R</mi><mn>0</mn></msub></mrow><annotation encoding="application/x-tex">R_{0}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.8333em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.00773em">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3011em"><span style="top:-2.55em;margin-left:-.0077em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">0</span></span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span></eq>with:</p><section><eqn><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>R</mi><mn>0</mn></msub><mo>=</mo><mfrac><mi></mi><mi></mi></mfrac></mrow><annotation encoding="application/x-tex">R_{0}={\frac {\beta }{\gamma }}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.8333em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.00773em">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3011em"><span style="top:-2.55em;margin-left:-.0077em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">0</span></span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2778em"></span></span><span class="base"><span class="strut" style="height:2.2519em;vertical-align:-.8804em"></span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3714em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.05556em"></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.05278em"></span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:.8804em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></span></eqn></section></div></div></main></div><script>window.__INITIAL_STATE__='{"pinia":{}}'</script><link rel="stylesheet" href="/katex.min.css"><link rel="stylesheet" href="/assets/index.436e7bc5.css"></body></html>