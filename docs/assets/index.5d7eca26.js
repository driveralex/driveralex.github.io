import{i as S,d as w,r as q,o as c,c as u,e as n,b as h,t as v,f as l,p as E,m as T,_ as m,j as $,q as A,C as N,s as p,l as _,y as O,g as I,T as M,A as b}from"./app.3a7252fd.js";async function j(t="",r){fetch(t,{method:"GET",headers:{"Content-Type":"application/x-www-form-urlencoded",Authorization:`Bearer ${r}`}}).then(o=>o.json()).then(o=>(o.ok||(o.status,console.log("wut",o)),o)).catch(o=>{console.error("There has been a problem with your fetch operation:",o)})}const x=S("test",{state:()=>({email:{value:"",required:!0,inError:!1,ErrorText:"Please enter a valid e-mail"},password:{value:"",required:!0,inError:!1,ErrorText:"Password should not be empty"},pseudo:{value:"",required:!1},firstName:{value:"",required:!1},lastName:{value:"",required:!1},phone:{value:"",required:!1},lang:{options:["English","Fran\xE7ais","Portuguese"],selected:""},triedToPost:!1,alert:{showAlert:!1,alertMsg:""}}),actions:{async registerUser(){this.triedToPost===!1&&(this.triedToPost=!0),this.getEmail.length>0&&this.getPassword.length?await t("http://localhost:3000/auth/signup",{email:this.getEmail,password:this.getPassword},this.email,this.alert):(this.getEmail.length<1&&(this.email.inError=!0),this.getPassword.length<1&&(this.password.inError=!0));async function t(r="",o={},i,s){fetch(r,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:new URLSearchParams(o)}).then(e=>e.json()).then(e=>{e.hasOwnProperty("access_token")&&sessionStorage.setItem("access_token",e.access_token),e.hasOwnProperty("statusCode")&&(console.log(`debug   ${JSON.stringify(e)}`),e.statusCode===400?e.message==="email must be an email"&&(i.inError=!0,i.ErrorText="Email must be an email",s.showAlert=!0,s.alertMsg="Email must be an email"):e.statusCode===403?e.message==="Credentials taken"&&(i.inError=!0,i.ErrorText=e.message,s.showAlert=!0,s.alertMsg=e.message):e.statusCode>=400&&e.statusCode<=499&&(s("There has been a problem fetching api"),console.warn(`There has been a problem fetching api: ${e}`),s.showAlert=!0,s.alertMsg=e.message))}).catch(e=>{s.showAlert=!0,s.alertMsg="Network error please try again later",console.error("There has been a problem with your fetch operation:",e)})}},async getMe(){const t=sessionStorage.getItem("access_token");t&&await j("http://localhost:3000/users/me",t)},async signin(){this.getEmail.length>0&&this.getPassword.length?(console.log("Start signin"),await t("http://localhost:3000/auth/signin",{email:this.getEmail,password:this.getPassword},this.email,this.password,this.alert)):(this.getEmail.length<1&&(this.email.inError=!0),this.getPassword.length<1&&(this.password.inError=!0));async function t(r="",o={},i,s,e){console.log("lets go"),fetch(r,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:new URLSearchParams(o)}).then(a=>a.json()).then(a=>{a.hasOwnProperty("access_token")&&(console.log(`all good with ac = ${a.access_token}`),sessionStorage.setItem("access_token",a.access_token)),a.hasOwnProperty("statusCode")&&(console.log(`debug   ${JSON.stringify(a)}`),a.statusCode===400?(console.log(a.message),a.message==="email must be an email"&&(i.inError=!0,i.ErrorText="Email must be an email",e.showAlert=!0,e.alertMsg="Email must be an email")):a.statusCode===403?a.message==="Credentials incorrect"&&(i.inError=!0,i.ErrorText=a.message,s.inError=!0,s.ErrorText=a.message,e.showAlert=!0,e.alertMsg=a.message):a.statusCode>=400&&a.statusCode<=499&&(e("There has been a problem fetching api"),console.warn(`There has been a problem fetching api: ${a}`),e.showAlert=!0,e.alertMsg=a.message))}).catch(a=>{e.showAlert=!0,e.alertMsg="Network error please try again later",console.error("There has been a problem with your fetch operation:",a)})}}},getters:{getEmail:t=>t.email.value,getPassword:t=>t.password.value,getPseudo:t=>t.pseudo.value,getFirstName:t=>t.firstName.value,getLastName:t=>t.lastName.value,getPhone:t=>t.phone.value,getLang:t=>t.lang.selected}}),B=t=>(E("data-v-f15aaef1"),t=t(),T(),t),R={class:"wrapper"},D={class:"header"},L=B(()=>n("h1",null,"Error",-1)),U={class:"wrapperboard"},V=w({__name:"Alert",setup(t){const r=x();return(o,i)=>{const s=q("ic:baseline-close");return c(),u("div",R,[n("div",D,[L,h(s,{class:"cl",onClick:i[0]||(i[0]=e=>o.$emit("close"))})]),n("div",U,[n("p",null,v(l(r).alert.alertMsg),1)])])}}});const W=m(V,[["__scopeId","data-v-f15aaef1"]]),z=t=>(E("data-v-ea758a91"),t=t(),T(),t),J={class:"selectorWrapper"},F={class:"form"},G=["id","type","name"],K=["for"],H=z(()=>n("div",{class:"i-carbon:warning-filled"},null,-1)),Q=[H],X={key:0,class:"i-codicon:eye"},Y={key:1,class:"i-codicon:eye-closed"},Z=w({__name:"SelectText",props:{store:{required:!0},storeObjectName:{type:String,required:!0},selectType:{type:String,required:!0},labelText:{type:String,required:!0},isRequired:{type:Boolean,required:!0},errorText:{type:String,required:!1},isInError:{type:Boolean,required:!1},styleClass:{type:String,required:!0}},setup(t){var y;const r=t,o=$(r.selectType),i=()=>r.isRequired?r.labelText.concat(" *"):r.labelText,s=(y=Object.getOwnPropertyDescriptor(r.store,r.storeObjectName))==null?void 0:y.value,e=()=>{if(s.value.inError!==void 0){if(s.value.inError===!0)return"error";if(s.value.inError===!1)return"ok"}else return"ok"},a=()=>{typeof s.value.inError=="boolean"&&s.value.inError===!0&&s.value.value.length>0&&(s.value.inError=!1)},g=()=>{if(s.value.hasOwnProperty("inError"))return s.value.inError?s.value.ErrorText:s.value.required?"Required":"bug"},C=()=>{r.selectType==="password"&&(o.value==="password"?o.value="text":o.value==="text"&&(o.value="password"))},P=()=>{r.selectType==="password"&&(o.value="password")};return(ne,d)=>(c(),u("div",J,[n("div",{class:p(r.styleClass)},[n("div",F,[A(n("input",{id:r.storeObjectName,"onUpdate:modelValue":d[0]||(d[0]=f=>l(s).value=f),class:p(["form__input",[e()]]),type:o.value,name:r.storeObjectName,autocomplete:"off",placeholder:" ",onKeyup:a,onBlur:d[1]||(d[1]=f=>P())},null,42,G),[[N,l(s).value]]),n("label",{class:p(["form__label",[e()]]),for:r.storeObjectName},v(i()),11,K),n("div",{class:p(["form__iconAlert",[e()]])},Q,2),r.selectType==="password"&&e()!=="error"?(c(),u("div",{key:0,class:"eye",onClick:d[2]||(d[2]=f=>C())},[o.value==="password"?(c(),u("div",X)):_("",!0),o.value==="text"?(c(),u("div",Y)):_("",!0)])):_("",!0),r.isRequired?(c(),u("p",{key:1,class:p(["form__helperRequired",[e()]])},v(g()),3)):_("",!0)])],2)]))}});const ee=m(Z,[["__scopeId","data-v-ea758a91"]]),te={class:"signinWrapper"},se={key:0},re=w({__name:"SignIn",setup(t){const r=x(),o=O(()=>r.email.value.length>0&&r.password.value.length?"ok":"disabled");return(i,s)=>{const e=ee,a=W;return c(),u("div",te,[h(e,{store:l(r),"store-object-name":"email","select-type":"email","label-text":"Email","is-required":!0,"style-class":"outlined"},null,8,["store","select-type","style-class"]),h(e,{store:l(r),"store-object-name":"password","select-type":"password","label-text":"Password","is-required":!0,"style-class":"filled"},null,8,["store","select-type","style-class"]),n("button",{class:p(["btn",[l(o)]]),onClick:s[0]||(s[0]=(...g)=>l(r).signin&&l(r).signin(...g))}," Signin ",2),(c(),I(M,{to:"body"},[l(r).alert.showAlert?(c(),u("div",se,[h(a,{msg:"Je suis le message d'erreur",onClose:s[1]||(s[1]=g=>l(r).alert.showAlert=!1)})])):_("",!0)]))])}}});const oe=m(re,[["__scopeId","data-v-870598cc"]]);const k={},ae={class:"globalWrapper"};function ie(t,r){const o=oe;return c(),u("div",ae,[h(o)])}typeof b=="function"&&b(k);const ce=m(k,[["render",ie],["__scopeId","data-v-3fb13206"]]);export{ce as default};
